(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[537],{3013:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("driveItemResponse")},3250:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("graphThumbnailSet")},3404:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("hasThumbnailAuthTokenFacet")},3533:function(e,t,n){"use strict";function a(e){var t=e.serverRelativeItemUrl,n=e.dataRequestor,a=e.webApiUrl,i=e.duration,r=void 0===i?1:i,o=e.authToken,s=a;return s=(s=s.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t})).method("GetPreAuthorizedAccessUrl",r),n.getData({url:s.toString(),method:"GET",authToken:o,qosName:"ItemDataSource.getDownloadUrl"}).then(function(e){return e.d.GetPreAuthorizedAccessUrl})}n.d(t,"e",function(){return a})},3543:function(e,t,n){"use strict";var a=n(116),i=function(){function e(e,t){this._dataRequestor=t.dataRequestor}return e.prototype.hasValidUniversalPrintLicense=function(e){var t=e.endpoint,n=e.accessToken;return this._dataRequestor.send({path:"".concat(t,"/print/services"),requestType:"GET",apiName:"UPLicenseCheck",useAuthorizationHeaders:!0,hasContentType:!0,accessToken:n,expectedErrorCodes:{403:!0,AuthenticationError:!0}}).then(function(e){return!(!e||!e.value||0==e.value.length)}).catch(function(e){return!1})},e.prototype.getPrinterSharesList=function(e){var t,n=e.endpoint,a=e.accessToken,i=e.printSearchStr,r=e.fileType,o=e.topQueryOption,s=e.nextLink;if(s)t=s;else{t="".concat(n,"/print/shares");var c=[],d=[];if(r&&c.push("capabilities/contentTypes/any(c:c eq '".concat(r,"')")),i){var l=i.toLowerCase();c.push("contains(tolower(displayName), '".concat(l,"')"))}0!==c.length&&d.push("$filter=".concat(c.reduce(function(e,t){return e+" and "+t}))),o&&d.push("$top=".concat(o)),0!==d.length&&(t=t+"?"+d.reduce(function(e,t){return e+"&"+t}))}return this._dataRequestor.send({path:t,requestType:"GET",apiName:i?"searchprintshares":"printshares",useAuthorizationHeaders:!0,hasContentType:!0,accessToken:a}).then(function(e){return{printersList:e.value,nextLink:e["@odata.nextLink"]}})},e.prototype.getPrinterShare=function(e){var t=e.endpoint,n=e.accessToken,a=e.printerId;return this._dataRequestor.send({path:"".concat(t,"/print/shares/").concat(a,"?$select=id,displayName,defaults,capabilities,isAcceptingJobs"),requestType:"GET",apiName:"printshare",useAuthorizationHeaders:!0,hasContentType:!0,accessToken:n})},e.prototype.submitPrintJob=function(e){var t=this,n=e.endpoint,a=e.printerId,i=e.file,r=e.config,o=e.contentType,s=e.accessToken,c={endpoint:n,printerId:a,config:r,accessToken:s};return this.createPrintJob(c).then(function(e){var r={endpoint:n,printerId:a,jobId:e.id,documentId:e.documents[0].id,fileName:i.name,fileSize:i.size,contentType:o,accessToken:s};return t.createUploadSession(r).then(function(r){return t.uploadPrintJob({uploadSession:r,file:i}).then(function(){return t.startPrintJob({endpoint:n,printerId:a,jobId:e.id,accessToken:s})})})})},e.prototype.createPrintJob=function(e){var t=e.endpoint,n=e.printerId,a=e.config,i=e.accessToken,r={configuration:a};return this._dataRequestor.send({path:"".concat(t,"/print/shares/").concat(n,"/jobs"),requestType:"POST",apiName:"createprintjob",useAuthorizationHeaders:!0,hasContentType:!0,postData:JSON.stringify(r),accessToken:i,expectedErrorCodes:{415:!0}})},e.prototype.createUploadSession=function(e){var t=e.endpoint,n=e.printerId,a=e.jobId,i=e.documentId,r=e.fileName,o=e.fileSize,s=e.contentType,c=e.accessToken,d={properties:{contentType:s,documentName:r,size:o}};return this._dataRequestor.send({path:"".concat(t,"/print/shares/").concat(n,"/jobs/").concat(a,"/documents/").concat(i,"/createUploadSession"),requestType:"POST",apiName:"createprintuploadsession",useAuthorizationHeaders:!0,hasContentType:!0,postData:JSON.stringify(d),accessToken:c,expectedErrorCodes:{415:!0}})},e.prototype.uploadPrintJob=function(e){for(var t=e.uploadSession,n=e.file,i=0,r=[],o=t.uploadUrl;n.size>i;){var s=Math.min(n.size,i+1e6),c={"Content-Range":"bytes ".concat(i,"-").concat(s-1,"/").concat(n.size)},d=this.uploadFragment(o,c,n.slice(i,s,n.type));r.push(d),i=s}return a.n.serial(r)},e.prototype.uploadFragment=function(e,t,n){var a=this;return function(){return a._dataRequestor.send({path:e,requestType:"PUT",apiName:"uploadprintfilefragment",needsAuthorization:!1,hasContentType:!1,headers:t,postData:n})}},e.prototype.startPrintJob=function(e){var t=e.endpoint,n=e.printerId,a=e.jobId,i=e.accessToken;return this._dataRequestor.send({path:"".concat(t,"/print/shares/").concat(n,"/jobs/").concat(a,"/start"),requestType:"POST",apiName:"startprintjob",useAuthorizationHeaders:!0,hasContentType:!0,accessToken:i})},e}();t.e=i},3565:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(18),r=new a.e("thumbnailToken",{endpoint:i.e,driveId:i.t})},3660:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("hasPdfFacet")},3661:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("thumbnailAccessToken")},3781:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"e",function(){return o});var a=n(2),i=new a.e("fileDownloadError"),r=new a.e("getFileDownloadUrlError"),o=new a.e("disabledDocumentConversionError")},3794:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(23),i=n(407),r=n(81),o=new a.e("driveItemUnauthenticatedThumbnail",{driveItemKey:r.e.subKeyPart,width:i.e,height:i.e})},4041:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(8),i=function(){return a.e.isActivated("8B2678E4-71A6-4034-A604-01CE2E306BA6","07/28/2022","Use getItemThumbnailOperation to get thumbnail blob for each item")}},4209:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("universalPrintSharedPrinterListItem")},4229:function(e,t,n){"use strict";n.d(t,"e",function(){return I}),n.d(t,"t",function(){return x});var a=n(0),i=n(4),r=n(133),o=n(81),s=n(3250),c=n(3565),d=n(3661),l=n(3404),u=n(3013),f=n(671),p=n(179),m=n(396),_=n(269),h=n(8),b=n(1103),g=n(3794),v=n(172),y=n(4041),S=h.e.isActivated("AB808229-F141-4F5A-B7E9-C1DEF8EC6F64","10/21/2021","Enable crop mode for folder cover thumbnail"),D=h.e.isActivated("75843FC5-8F0A-4925-BB0B-AA5FCE46444C","02/07/2022","Enable various thumbnail fixes in ItemResultProcessor and addon-graph ItemThumbnailControl");function I(e,t){var n=t.itemKey,h=t.desiredSize,S=t.fitMode,I=t.requestOptions,C=e.demandItemFacet(o.e,n);if(!C)return{};var O=e.demandItemFacet(l.e,n)?function(e,t){var n=t.itemKey,a=t.desiredSize,i=t.fitMode,r=x(e.demandItemFacet(s.e,n));if(r&&r.large){var o=e.demandItemFacet(u.e,n),c=o&&(o["@microsoft.graph.downloadUrl"]||o["@content.downloadUrl"]),d=Object(b.e)(e,{itemKey:n});return{url:E(d&&c||r.large.url,a,i,d),width:0,height:0}}}(e,{itemKey:n,driveItem:C,desiredSize:h,fitMode:S}):function(e,t){var n,o,s=t.itemKey,l=t.driveItem,u=t.desiredSize;if(!D){var h=!!e.demandItemFacet(i._,s),b=!!e.demandItemFacet(r.i,s);if(h||b)return}if(!Object(y.e)()&&!(null===(n=t.requestOptions)||void 0===n?void 0:n.allowsHeaders))return function(e,t){var n=t.driveItem,a=t.desiredSize,i=Math.ceil(a.width),r=Math.ceil(a.height),o=g.e.serialize({driveItemKey:{driveId:n.driveId,itemId:n.itemId,endpoint:n.endpoint},width:i,height:r}),s=e.demandItemFacet(v.h,o);return s?{url:s.url,height:i,width:r}:void 0}(e,{driveItem:l,desiredSize:u});var S,I,x=e.demandItemFacet(i.f,s,{suppressGetItems:!0})||"",C=new p.e(l.endpoint).authority;if(D)I=l.endpoint.indexOf("/_api/v2.")>-1,S="".concat(C,I?"/_api/v2.1":"/v1.0");else{I=l.endpoint.indexOf("/v2.")>-1;var O=Object(f.a)(e,l.endpoint);S="".concat(C,I&&!O?"/_api/v2.1":"/v1.0")}var w=c.e.serialize({endpoint:S,driveId:l.driveId}),E=e.demandItemFacet(d.e,w);if(E){var A=Object(m.t)({endpoint:S,driveId:l.driveId,itemId:l.itemId}),L=Math.ceil(u.width),k=Math.ceil(u.height),M="".concat(A,"/thumbnails/0/c").concat(L,"x").concat(k,"/content"),P={prefer:"noredirect,closestavailablesize",cb:x};if(I||!D){var T=Object(a.__assign)(Object(a.__assign)({},P),{access_token:{uriValue:E}});return{url:"".concat(M,"?").concat(Object(_.e)(T)),width:L,height:k}}if(null===(o=t.requestOptions)||void 0===o?void 0:o.allowsHeaders){var U={Authorization:"bearer ".concat(E)};return{url:"".concat(M,"?").concat(Object(_.e)(P)),width:L,height:k,headers:U}}}}(e,{itemKey:n,driveItem:C,desiredSize:h,requestOptions:I});return O?{thumbnail:O}:{}}function x(e){return e&&(t=e)&&"number"==typeof t.length?e[0]:e;var t}var C=/width=[0-9]*/,O=/height=[0-9]*/,w=/cropmode=[a-z]*/;function E(e,t,n,a){if(a)return e;if(!S){var i="cover"===n?"center":"none";w.test(e)?e=e.replace(w,"cropmode=".concat(i)):e+="".concat(e.indexOf("?")>-1?"&":"?","cropmode=").concat(i)}var r="number"==typeof t.width?Math.ceil(t.width):t.width,o="number"==typeof t.height?Math.ceil(t.height):t.height,s="".concat(r||"");C.test(e)?e=e.replace(C,"width=".concat(s)):e+="".concat(e.indexOf("?")>-1?"&":"?","width=").concat(s);var c="".concat(o||"");return O.test(e)?e=e.replace(O,"height=".concat(c)):e+="".concat(e.indexOf("?")>-1?"&":"?","height=").concat(c),e}},4457:function(e,t,n){"use strict";n.r(t),n.d(t,"CACHE_EXPIREATION_TIME",function(){return _}),n.d(t,"LICENSE_CACHE_KEY",function(){return h}),n.d(t,"universalPrintLicenseCheckOperationHandler",function(){return b});var a=n(0),i=n(312),r=n(169),o=n(6),s=n(1109),c=n(1598),d=n(802),l=n(57),u=n(671),f=n(3543),p=n(902),m=n(112),_=6048e5,h="licenseinfo",b=Object(o.i)()(function e(t){var n=this;return function(o){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,b,g,v,y,S,D,I,x,C,O,w,E;return Object(a.__generator)(this,function(A){switch(A.label){case 0:return n=t.itemKey,b=o(Object(r.e)({universalPrintLicenseCache:c.e})).universalPrintLicenseCache,void 0!==(g=null==b?void 0:b.getValue(h))&&((O=new i.e({publisher:e})).resolveItems({items:(w={},w[n]=Object(a.__assign)({},s.e.pack(g.hasValidLicense)),w)}),o(O.execute())),void 0===g||!g.lastModified||!g.hasValidLicense&&Date.now()-g.lastModified>=_?(v=o(Object(r.e)({graphEndpoint:l.y})).graphEndpoint,y=o(u.e).dataRequestor,S=new f.e({},{dataRequestor:y}),D=d.e.deserialize(n),I=v||D.graphEndpoint,[4,o(Object(p.getSessionToken)({endpoint:I}))]):[3,3];case 1:return x=A.sent(),[4,S.hasValidUniversalPrintLicense({endpoint:I,accessToken:x})];case 2:C=A.sent(),m.e.logData({name:"UniversalPrint.LicenseInfo",extraData:{hasValidLicense:C}}),b&&b.setValue(h,{hasValidLicense:C,lastModified:Date.now()}),(null==g?void 0:g.hasValidLicense)!==C&&((O=new i.e({publisher:e})).resolveItems({items:(E={},E[n]=Object(a.__assign)({},s.e.pack(C)),E)}),o(O.execute())),A.label=3;case 3:return[2]}})})}})},4466:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d});var a=n(0),i=n(200),r=n(389),o=n(669),s=n(3781),c=function(e,t,n){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var i,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,fetch(e,{mode:"cors"})];case 1:return(i=a.sent()).ok?[4,i.blob()]:[3,3];case 2:return o=a.sent(),[2,new File([o],t,{type:n})];case 3:throw new r.e({facets:s.t.pack(i.status)})}})})},d=function(e){var t=Object(o.t)(e,function(e,t){switch(e){case"unauthenticated":case"401":case 401:return i.a.pack({});case"itemNotFound":case"404":case 404:return i.p.pack({});case"accessDenied":case"403":case 403:return i.e.pack({});case"415":case 415:return s.e.pack({});case"offline":return i.v.pack({})}});throw new r.e({innerError:e,facets:t})}},5195:function(e,t,n){"use strict";n.r(t),n.d(t,"universalPrintPrinterShareListOperationHandler",function(){return u});var a=n(0),i=n(312),r=n(6),o=n(4209),s=n(671),c=n(3543),d=n(1668),l=n(902),u=Object(r.i)()(function e(t){var n=this;return function(r){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,u,f,p,m,_,h,b,g,v,y;return Object(a.__generator)(this,function(S){switch(S.label){case 0:return n=t.itemKey,u=r(s.e).dataRequestor,f=new c.e({},{dataRequestor:u}),p=d.e.deserialize(n),m=p.endpoint,_=p.printSearchStr,h=p.fileType,[4,r(Object(l.getSessionToken)({endpoint:m}))];case 1:return b=S.sent(),[4,f.getPrinterSharesList({endpoint:m,accessToken:b,printSearchStr:_,fileType:h,topQueryOption:100})];case 2:return g=S.sent(),(v=new i.e({publisher:e})).resolveItems({items:(y={},y[n]=Object(a.__assign)({},o.e.pack(g)),y)}),r(v.execute()),[2]}})})}})},5196:function(e,t,n){"use strict";n.r(t),n.d(t,"itemGetPrintFileUrlOperationHandler",function(){return _});var a=n(0),i=n(6),r=n(81),o=n(687),s=n(150),c=n(312),d=n(779),l=n(396),u=n(671),f=n(3660),p=n(4229),m=n(3250),_=Object(i.i)()(function e(t){var n=this;return function(i){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,_,h,b,g,v,y,S,D,I,x,C,O,w,E,A;return Object(a.__generator)(this,function(L){switch(L.label){case 0:return n=t.itemKey,_=i(Object(s.e)(function(e){return{hasPdf:e.demandItemFacet(f.e,n),thumbnailSet:e.demandItemFacet(m.e,n)}})),h=_.hasPdf,b=_.thumbnailSet,g=Object(p.t)(b),h&&g?(y=Object(d.n)(g.large.url),v={fileUrl:y},[3,3]):[3,1];case 1:return(S=i(Object(s.e)(function(e){return e.demandItem({driveItemKey:r.e},n)})).driveItemKey)?(D=Object(l.t)(S),I=Object(l.n)(S),x=S.endpoint,C=S.driveId,[4,i(Object(u.t)({url:D,driveUrl:I,driveId:C,method:"GET",qosName:"getItemPrintFileDataUrl",endpoint:x}))]):[2];case 2:if(O=L.sent(),w=function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}(D)?O["@microsoft.graph.downloadUrl"]:O["@content.downloadUrl"],!w)throw new Error("Unable to obtain Print file URL.");v={fileUrl:w},L.label=3;case 3:return(E=new c.e({publisher:e})).resolveItems({items:(A={},A[n]=Object(a.__assign)({},o.n.pack(v)),A)}),i(E.execute()),[2]}})})}})},5197:function(e,t,n){"use strict";n.r(t),n.d(t,"printToUniversalPrinterOperationHandler",function(){return g});var a=n(0),i=n(6),r=n(4),o=n(169),s=n(150),c=n(389),d=n(669),l=n(3543),u=n(779),f=n(57),p=n(3781),m=n(687),_=n(902),h=n(671),b=n(4466),g=Object(i.i)()(function(e){var t=e.itemKey,n=e.options,i=n.printerId,g=n.config;return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n,v,y,S,D,I,x,C,O,w,E,A,L;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(!(n=e(Object(o.e)({graphEndpoint:f.y})).graphEndpoint))throw new c.e({code:"missingendpointinfoforprinttoup"});return[4,e(Object(_.getSessionToken)({endpoint:n}))];case 1:v=a.sent(),y=e(h.e).dataRequestor,S=new l.e({},{dataRequestor:y}),a.label=2;case 2:a.trys.push([2,11,,12]),a.label=3;case 3:return a.trys.push([3,5,,6]),[4,e(Object(m.e)({items:(L={},L[t]={},L)}))];case 4:return a.sent(),[3,6];case 5:throw D=a.sent(),new c.e({facets:p.n.pack({}),innerError:D});case 6:if(I=e(Object(s.e)(function(e){return{fileName:e.demandItemFacet(r.p,t),printFileData:e.demandItemFacet(m.n,t)}})),x=I.fileName,!(C=I.printFileData)||!x||!C.file&&!C.fileUrl)throw new c.e({code:"missingfileinforprinttoup"});return O=void 0,C.fileUrl?(w=Object(u.i)(x.extension)?u.e:u.t,[4,Object(b.e)(C.fileUrl,x.name,w)]):[3,8];case 7:return O=a.sent(),[3,9];case 8:if(!C.file)throw new c.e({code:"missingfileinforprinttoup"});O=C.file,a.label=9;case 9:return E={endpoint:n,printerId:i,file:O,contentType:O.type,config:g,accessToken:v},[4,S.submitPrintJob(E)];case 10:return a.sent(),[3,12];case 11:if(!((A=a.sent())instanceof d.e))throw A;return Object(b.t)(A),[3,12];case 12:return[2]}})})}})},5198:function(e,t,n){"use strict";n.r(t),n.d(t,"printToUniversalPrinterOperationHandler",function(){return g});var a=n(0),i=n(6),r=n(4),o=n(150),s=n(389),c=n(669),d=n(3543),l=n(687),u=n(902),f=n(671),p=n(4466),m=n(169),_=n(57),h=n(3781),b=n(779),g=Object(i.i)()(function(e){var t=e.itemKey,n=e.options,i=n.printerId,g=n.config;return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n,v,y,S,D,I,x,C,O,w,E,A,L;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(!(n=e(Object(m.e)({graphEndpoint:_.y})).graphEndpoint))throw new s.e({code:"missinggraphendpointinfoforprinttoup"});return[4,e(Object(u.getSessionToken)({endpoint:n}))];case 1:v=a.sent(),y=e(f.e).dataRequestor,S=new d.e({},{dataRequestor:y}),a.label=2;case 2:a.trys.push([2,11,,12]),a.label=3;case 3:return a.trys.push([3,5,,6]),[4,e(Object(l.e)({items:(L={},L[t]={},L)}))];case 4:return a.sent(),[3,6];case 5:throw D=a.sent(),new s.e({facets:h.n.pack({}),innerError:D});case 6:if(I=e(Object(o.e)(function(e){return{fileName:e.demandItemFacet(r.p,t),printFileData:e.demandItemFacet(l.n,t)}})),x=I.fileName,C=I.printFileData,!x||!C||!C.file&&!C.fileUrl)throw new s.e({code:"missingfileinforprinttoup"});return O=void 0,C.fileUrl?(w=Object(b.i)(x.extension)?b.e:b.t,[4,Object(p.e)(C.fileUrl,x.name,w)]):[3,8];case 7:return O=a.sent(),[3,9];case 8:if(!C.file)throw new s.e({code:"missingfileinforprinttoup"});O=C.file,a.label=9;case 9:return E={endpoint:n,printerId:i,file:O,contentType:O.type,config:g,accessToken:v},[4,S.submitPrintJob(E)];case 10:return a.sent(),[3,12];case 11:if(!((A=a.sent())instanceof c.e))throw A;return Object(p.t)(A),[3,12];case 12:return[2]}})})}})},5311:function(e,t,n){"use strict";n.r(t),n.d(t,"driveItemDeleteItemsBatchedOperationHandler",function(){return g});var a,i=n(0),r=n(389),o=n(6),s=n(610),c=n(148),d=n(66),l=n(259),u=n(825),f=n(4),p=n(81),m=n(396),_=n(671),h=n(200);!function(e){e.Completed="completed",e.Failed="failed",e.InProgress="inProgress"}(a||(a={}));var b=3e5,g=Object(o.n)({maxParallelOperationCount:4,timeout:b,areSameBatch:function(e,t){var n=p.e.deserialize(e.itemKey).driveId,a=p.e.deserialize(t.itemKey).driveId;return!!n&&!!a&&n===a}})(function(e){var t=this,n=e.items,g=Object.keys(n),v=g.map(function(e){return p.e.deserialize(e)});return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,p,y,S,D,I,x,C;return Object(i.__generator)(this,function(O){switch(O.label){case 0:return e(Object(l.e)({items:Object(c.t)(n,function(e){return e.progressItemKey,Object(i.__assign)(Object(i.__assign)({},d.v.pack({total:1,current:0})),d.p.pack(!0))},function(e,t){return t.progressItemKey})})),t={value:v.map(function(e){return{id:e.itemId,deleted:{}}})},p="",y=Object(m.n)(v[0]),S=v[0].driveId,[4,e(Object(_.t)({url:"".concat(y,"/items"),method:"PATCH",body:t,qosName:"deleteItems",endpoint:v[0].endpoint,driveId:S,parseResponse:function(e){p=e.getResponseHeader("Location")||""}}))];case 1:O.sent(),D=0,I=!1,x=!1,Object(s.t)(b).then(function(){return x=!0}),C=function(){var t;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(_.t)({url:p,qosName:"getOperationStatus",endpoint:v[0].endpoint,driveId:S}))];case 1:return t=i.sent(),g.forEach(function(){e(Object(l.e)({items:Object(c.t)(n,function(e){return e.progressItemKey,d.v.pack({total:1,current:t.percentageComplete/g.length})},function(e,t){return t.progressItemKey})}))}),t.status!==a.Completed&&t.status!==a.Failed?[3,2]:(I=!0,D=t.summary.failed,[3,4]);case 2:return[4,Object(s.t)(500)];case 3:i.sent(),i.label=4;case 4:return[2]}})},O.label=2;case 2:return[5,C()];case 3:O.sent(),O.label=4;case 4:if(!I&&!x)return[3,2];O.label=5;case 5:if(x)throw new r.e({facets:Object(i.__assign)({},h.u.pack(408))});if(e(Object(u.e)({items:Object(c.e)(g,function(){return[f.d]})})),D>0)throw new o.e({items:Object(c.e)(g.slice(0,D),function(){return new r.e({facets:Object(i.__assign)({},h.u.pack(500))})})});return[2]}})})}})},5593:function(e,t,n){"use strict";n.r(t),n.d(t,"spItemPdfGetItemsOperationHandler",function(){return m});var a=n(0),i=n(694),r=n(312),o=n(266),s=n(6),c=n(40),d=n(166),l=n(1036);function u(e){var t=e.listMediaTransformSchema,n=e.itemMediaTransformSchema;if(t&&n){var i=t[".transformUrl"],r=n[".hasPdf"],o=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},t),n),{".method":"pdf"});if("True"===r&&i)return function(){return"".concat(Object(l.t)(i,o))}}}var f=n(264),p=n(1669),m=Object(s.i)({maxParallelOperationCount:16})(function(e){var t=this,n=p.e.deserialize(e.itemKey).itemKey;return function(s){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,l,p,m;return Object(a.__generator)(this,function(_){switch(_.label){case 0:return[4,s(Object(i.e)(function(e){var t=e.demandItemFacet(c.e,n),a=t&&d.e.serialize(t);return{generator:u({listMediaTransformSchema:e.demandItemFacet(o.n,a),itemMediaTransformSchema:e.demandItemFacet(o.e,n)})}}))];case 1:return t=_.sent().generator,(l=new r.e).resolveItems(((p={items:(m={},m[e.itemKey]=Object(a.__assign)({},o.a.pack(t)),m)})[n]=Object(a.__assign)({},Object(f.e)().forFacet(o.e).thenInvalidate(e.itemKey,o.a).pack()),p)),s(l.execute()),[2]}})})}})},5594:function(e,t,n){"use strict";n.r(t),n.d(t,"spItemGetPrintFileUrlOperationHandler",function(){return y});var a=n(0),i=n(6),r=n(40),o=n(745),s=n(1),c=n(150),d=n(474),l=n(3533),u=n(96),f=n(687),p=n(312),m=n(4),_=n(111),h=n(266),b=n(1669),g=new _.e("pdfUrlGenerator",function(e,t){var n=t.itemKey;return n&&e.demandItemFacet(h.a,b.e.serialize({itemKey:n}))||void 0}),v=n(694),y=Object(i.i)()(function e(t){var n=this;return function(i){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,d,l,u,_,h,b,y,D,I,x,C,O,w,E;return Object(a.__generator)(this,function(A){switch(A.label){case 0:return n=t.itemKey,d=i(Object(c.e)(function(e){return e.demandItem({spItemKey:r.e,folderPath:s.be,fileName:m.p},n)})),l=d.spItemKey,u=d.folderPath,_=d.fileName,[4,i(Object(v.e)(function(e){return e.demandItem({pdfUrlGenerator:g},n)}))];case 1:return h=A.sent().pdfUrlGenerator,b=l&&o.e.serialize(l),(y=i(Object(c.e)(function(e){return{pageContext:e.demandItemFacet(s.In,b)}})).pageContext)&&l&&_&&u?(D=l.webAbsoluteUrl,I=l.listFullUrl,x=y.layoutsUrl,C=_.extension,[4,i(S({webAbsoluteUrl:D,listFullUrl:I,folderPath:u,layoutsUrl:x,extension:C,pdfGenerator:h}))]):[2];case 2:return O=A.sent(),(w=new p.e({publisher:e})).resolveItems({items:(E={},E[n]=Object(a.__assign)({},f.n.pack(O)),E)}),i(w.execute()),[2]}})})}});function S(e){var t=this,n=e.webAbsoluteUrl,i=e.listFullUrl,r=e.folderPath,o=e.extension,s=e.pdfGenerator;return".oxps"===o||".xps"===o||".pdf"===o?function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,o,s,c,f,p;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=e(Object(u.n)({webAbsoluteUrl:n,listFullUrl:i})),o=t.dataRequestor,s=t.hasDigest,t.hasTokenProvider?(f=void 0,[3,3]):[3,1];case 1:return[4,e(Object(u.e)({url:n||i,disallowCookies:!s}))];case 2:f=a.sent(),a.label=3;case 3:return c=f,p=Object(d.a)({webAbsoluteUrl:n,listOrItemFullUrl:i}),[4,Object(l.e)({dataRequestor:o,authToken:c,serverRelativeItemUrl:r,webApiUrl:p})];case 4:return[2,{fileUrl:a.sent()}]}})})}:function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,{fileUrl:s&&s()}]})})}}}}]);