(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[788],{2285:function(e,t,n){"use strict";var a,i,r;n.d(t,"n",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r}),function(e){e[e.tiny=0]="tiny",e[e.extraExtraSmall=1]="extraExtraSmall",e[e.extraSmall=2]="extraSmall",e[e.small=3]="small",e[e.regular=4]="regular",e[e.large=5]="large",e[e.extraLarge=6]="extraLarge",e[e.size8=17]="size8",e[e.size10=9]="size10",e[e.size16=8]="size16",e[e.size24=10]="size24",e[e.size28=7]="size28",e[e.size32=11]="size32",e[e.size40=12]="size40",e[e.size48=13]="size48",e[e.size56=16]="size56",e[e.size72=14]="size72",e[e.size100=15]="size100",e[e.size120=18]="size120"}(a||(a={})),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy"}(i||(i={})),function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed",e[e.transparent=15]="transparent",e[e.violet=16]="violet",e[e.lightRed=17]="lightRed",e[e.gold=18]="gold",e[e.burgundy=19]="burgundy",e[e.warmGray=20]="warmGray",e[e.coolGray=21]="coolGray",e[e.gray=22]="gray",e[e.cyan=23]="cyan",e[e.rust=24]="rust"}(r||(r={}))},2384:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(2285),i=[a.e.lightBlue,a.e.blue,a.e.darkBlue,a.e.teal,a.e.green,a.e.darkGreen,a.e.lightPink,a.e.pink,a.e.magenta,a.e.purple,a.e.orange,a.e.lightRed,a.e.darkRed,a.e.violet,a.e.gold,a.e.burgundy,a.e.warmGray,a.e.cyan,a.e.rust,a.e.coolGray],r=i.length;function o(e){var t=e.primaryText,n=e.text,o=e.initialsColor;return"string"==typeof o?o:function(e){switch(e){case a.e.lightBlue:return"#4F6BED";case a.e.blue:return"#0078D4";case a.e.darkBlue:return"#004E8C";case a.e.teal:return"#038387";case a.e.lightGreen:case a.e.green:return"#498205";case a.e.darkGreen:return"#0B6A0B";case a.e.lightPink:return"#C239B3";case a.e.pink:return"#E3008C";case a.e.magenta:return"#881798";case a.e.purple:return"#5C2E91";case a.e.orange:return"#CA5010";case a.e.red:return"#EE1111";case a.e.lightRed:return"#D13438";case a.e.darkRed:return"#A4262C";case a.e.transparent:return"transparent";case a.e.violet:return"#8764B8";case a.e.gold:return"#986F0B";case a.e.burgundy:return"#750B1C";case a.e.warmGray:return"#7A7574";case a.e.cyan:return"#005B70";case a.e.rust:return"#8E562E";case a.e.coolGray:return"#69797E";case a.e.black:return"#1D1D1D";case a.e.gray:return"#393939"}}(o=void 0!==o?o:function(e){var t=a.e.blue;if(!e)return t;for(var n=0,o=e.length-1;o>=0;o--){var s=e.charCodeAt(o),c=o%8;n^=(s<<c)+(s>>8-c)}return i[n%r]}(n||t))}},2416:function(e,t,n){"use strict";var a,i=n(0),r=function(){function e(){}return e.tokenCacheSessionStorageId="tokenCache",e.aboutToExpireIntervalSeconds=600,e.apiUrl="/_api/SP.OAuth.Token/Acquire",e.retries=3,e.retriableErrorCodes=[10006,10008],e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>",e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format",e.npmPackageVersion="0.1.5",e}();!function(e){e[e.unknownError=0]="unknownError",e[e.malformedResponseBody=1]="malformedResponseBody",e[e.serverError=2]="serverError"}(a||(a={}));var o=function(e){function t(n,a){var i=e.call(this,a.message)||this;return i.__proto__=t.prototype,i._type=n,i._httpResponseStatus=a.httpResponseStatus,i._cultureName=a.cultureName,i._message=a.message,i._serverErrorCode=a.serverErrorCode,i._correlationId=a.correlationId,i._redirectUrl=a.redirectUrl,i}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==a.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!1,configurable:!0}),t}(Error),s=function(){function e(e){var t=this;this._context=e,this._dispose=this._dispose.bind(this),window.addEventListener("unload",this._dispose),window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()},window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}return e._getCorrelationId=function(e){return e.headers.get("sprequestguid")},e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e},e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})},e.prototype.getInstrumentedOAuthToken=function(e,t){var n=this;this._receiveMediaServiceFlushedToken();var a=this._getCachedTokenData(e);if(a&&!this._isExpiring(a)){var i={token:a.accessToken,isGuest:!1,expirationTimeMs:a.expiresOn};return Promise.resolve({tokenInfo:i,spRequestId:a.correlationId,spRequestTimestamp:a.requestTimestamp})}return this._retriableFetchWithDigest(e,r.retries,t).then(function(t){return n._storeTokenData(e,t),{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})},e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var n=this._resourceKeys.indexOf(t);!isNaN(n)&&n>-1&&this._resourceKeys.splice(n)},Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){return this._keysToDispose||(this._keysToDispose=new Array),this._keysToDispose},enumerable:!1,configurable:!0}),e.prototype._retriableFetchWithDigest=function(t,n,i){var r=this,s=this._context.qosMonitor(),c=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,i)).then(function(d){if(200!==d.status){r._context.logger.logError("fetchWithDigest failed. Server responded with "+d.statusText);var l=new o(a.unknownError,{httpResponseStatus:d.status,message:d.statusText,correlationId:e._getCorrelationId(d)});return 400!==d.status?(s.writeUnexpectedFailure("UnknownError",l),Promise.reject(l)):d.json().then(function(a){var o=e._extractRealError(a),c=r._getErrorCodeFromResponseCode(o);if(!r._isRetriableError(c)||0===n){var d=r._buildErrorFromResponse(o);return s.writeUnexpectedFailure("SharepointServerError",d),Promise.reject(d)}return r._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n),r._retriableFetchWithDigest(t,n-1,i)})}return r._instrumentedParseResponseData(d,s,c)})},e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))},e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))},e.prototype._getCacheKey=function(e){var t=["sp-client-shared",r.npmPackageVersion,"OAuthUtility",e].join(";");return-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t),t},e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<r.aboutToExpireIntervalSeconds},e.prototype._isRetriableError=function(e){return-1!==r.retriableErrorCodes.indexOf(e)},e.prototype._buildTokenRequest=function(e,t){var n=new Headers;n.append("Content-Type","application/json; charset=utf-8"),n.append("Odata-Version","4.0"),n.append("Accept","application/json;odata.metadata=minimal");var a={method:"POST",headers:n,body:JSON.stringify(this._buildRequestBody(e))},i=t;return i&&i.lastIndexOf("/")===i.length-1&&(i=i.substr(0,i.length-1)),new Request(i+r.apiUrl,a)},e.prototype._buildRequestBody=function(e){return{resource:e}},e.prototype._buildErrorFromResponse=function(e){var t,n,i=this._getErrorCodeFromResponseCode(e);if(void 0===i)return new o(a.malformedResponseBody,{httpResponseStatus:400,message:r.unexpectedErrorCodeFormat,correlationId:e.correlationId});e.message&&("string"==typeof e.message?t=e.message:(t=e.message.value,n=e.message.lang));var s="error.redirectUrl";return new o(a.serverError,{httpResponseStatus:400,message:t,cultureName:n,serverErrorCode:i,correlationId:e.correlationId,redirectUrl:e[s]||e["@".concat(s)]})},e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,n=Number(t);if(isNaN(n)&&"string"==typeof e.message){var a=t.indexOf(",");-1!==a&&(n=Number(t.substr(0,a)))}return n},e.prototype._instrumentedParseResponseData=function(t,n,i){try{return t.json().then(function(a){return n.writeSuccess(),{accessToken:a.access_token,expiresOn:Number(a.expires_on),notBefore:Number(a.not_before),resource:a.resource,tokenType:a.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:i}})}catch(i){return n.writeUnexpectedFailure("ResponseParseError",i),Promise.reject(new o(a.malformedResponseBody,{httpResponseStatus:200,message:r.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}},e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,n=this._resourceKeys;t<n.length;t++){var a=n[t];window.sessionStorage.removeItem(a)}},e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e),window._spMSBT=void 0}},e}(),c=n(1429),d=n(116),l=n(229),u=n(41),f=function(){function e(){this._qos=new u.e({name:"OAuthTokenDataSource"})}return e.prototype.writeSuccess=function(){this._qos.end({resultType:u.t.Success})},e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:u.t.Failure,error:JSON.stringify(t)})},e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:u.t.ExpectedFailure,error:JSON.stringify(t)})},e}(),p=function(){function e(){}return e.prototype.logWarning=function(e){},e.prototype.logError=function(e){},e}(),m=function(e){function t(t,n){var a=e.call(this,{},{pageContext:t})||this;return a.logger=new p,n&&(n.logger&&(a.logger=n.logger),n.useAbsoluteUrlForOAuth&&(a._useAbsoluteUrlForOAuth=n.useAbsoluteUrlForOAuth)),a._oAuthUtility=new s(a),a}return Object(i.__extends)(t,e),t.prototype.qosMonitor=function(){return new f},Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:Object(l.o)(this._pageContext)},enumerable:!1,configurable:!0}),t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(n){var a=e.headers.get("Content-Type");return e.headers.delete("Content-Type"),t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return n},"POST",t._getRequestHeadersDictionary(e),a,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})},t.prototype.getToken=function(e,t){return t&&this._oAuthUtility.clearCachedToken(e),this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))},t.prototype.getInstrumentedToken=function(e,t){return t&&this._oAuthUtility.clearCachedToken(e),this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))},t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,n={};return t.forEach(function(e,t){n[t]=e}),n},t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})},t.prototype._es6PromiseToOdspPromise=function(e){return new d.n(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})},t}(c.t);t.e=m},2494:function(e,t,n){"use strict";var a,i=n(116),r=n(41);!function(e){e[e.InteractionRequired=10013]="InteractionRequired"}(a||(a={}));var o=function(){function e(e,t){void 0===e&&(e={}),this._dataSource=t.oAuthTokenDataSource}return e.prototype.getToken=function(e,t){var n=new r.e({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){return n.end({resultType:r.t.Success}),e},function(e){return n.end({resultType:r.t.Failure}),i.n.reject(e)})},e.prototype.getInstrumentedToken=function(e,t){var n=new r.e({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){return n.end({resultType:r.t.Success}),e},function(e){return n.end({resultType:r.t.Failure}),i.n.reject(e)})},e}();t.e=o},3816:function(e,t,n){self,e.exports=function(){"use strict";var e,t,n,a={682:function(e,t,n){n.d(t,{Jh:function(){return r},XA:function(){return o},mG:function(){return i},pi:function(){return a}});var a=function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};function i(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})}function r(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}function o(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],a=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}Object.create,Object.create},932:function(e,t,n){function a(e){return e}n.d(t,{k:function(){return a}})},928:function(e,t,n){function a(e){return!function(e){return!e||"00000000-0000-0000-0000-000000000000"===e}(e)&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e||"")}function i(){for(var e=function(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}();var e}(),t=0,n="",a=0;a<36;a++)switch(a){case 8:case 13:case 18:case 23:t+=1,n+="-";break;case 14:t+=1,n+="4";break;case 19:n+=(e[a-t]%4+8).toString(16);break;default:n+=(e[a-t]%16).toString(16)}return n}n.d(t,{pW:function(){return i},SD:function(){return a}})},462:function(e,t,n){n.d(t,{e:function(){return a}});var a="Unknown"},859:function(e,t){t.Z={CLIENT_TIMESTAMP:"ClientTimeStamp",TRANSACTION_ID:"QoSTransactionId",SOURCE_CORRELATION_ID:"SourceCorrelationId"}},471:function(e,t){t.Z={START:"Start",SUCCESS:"Success",EXPECTED_FAILURE:"ExpectedFailure",UNEXPECTED_FAILURE:"UnexpectedFailure",MONITOR_IN_INVALID_STATE:"MonitorInInvalidState"}},977:function(e,t,n){n.d(t,{$:function(){return r},N:function(){return o}});var a=["Network","RESTAuthToken","TTLCacheUtils","BundleDownload","OfficeFeedIsReadyStatus","OfficeFeedVerbose"],i=["Stikkontakt","DataLoadStartAction","NoLogging","None"];function r(e){return a.indexOf(e)>-1}function o(e){return-1===i.indexOf(e)}},895:function(e,t,n){var a=n(682),i=n(928),r=n(451),o=n(462),s=n(859),c=n(471),d=n(977),l=function(){function e(e,t,n,a,r,o,s){this.eventHubPromise=e,this.monitoringData=t,this.scenarioName=n,this.featureName=a,this.staticProperties=r,this.lookupError=o,this.isVerboseLoggingEnabled=s,this.isFinished=!1,this.isInvalid=!1,this.lastScenarioState=c.Z.MONITOR_IN_INVALID_STATE,this.transactionId=(0,i.pW)(),this.start()}return e.prototype.flush=function(){return this.eventHubPromise.then(function(e){return e.broadcastFlush()})},e.prototype.success=function(e,t){this.endEvent(e,c.Z.SUCCESS,t)},e.prototype.expectedFailure=function(e,t){this.endEvent(e,c.Z.EXPECTED_FAILURE,t)},e.prototype.unexpectedFailure=function(e,t){this.endEvent(e,c.Z.UNEXPECTED_FAILURE,t)},e.prototype.dispose=function(){this.isInvalid||!this.isFinished?this.broadcastEvent(void 0,c.Z.MONITOR_IN_INVALID_STATE):this.broadcastEvent(this.lastTag,this.lastScenarioState,this.lastProperties)},e.prototype.start=function(){this.startTime=(new Date).getTime()},e.prototype.endEvent=function(e,t,n){this.isFinished&&(this.isInvalid=!0),this.startTime?(this.duration=(new Date).getTime()-this.startTime,this.lastScenarioState=t):this.lastScenarioState=c.Z.MONITOR_IN_INVALID_STATE,this.lastTag=e,this.lastProperties=n,this.isFinished=!0,this.dispose()},e.prototype.broadcastEvent=function(e,t,n){return(0,a.mG)(this,void 0,void 0,function(){var i,s,c,l,u,f;return(0,a.Jh)(this,function(a){switch(a.label){case 0:return!(0,d.N)(this.featureName)||(0,d.$)(this.featureName)&&!this.isVerboseLoggingEnabled?[2]:this.scenarioName&&this.monitoringData.source&&this.monitoringData.clientCorrelationId?(i=e?"".concat(this.scenarioName,"_").concat(t,"_").concat(e):"".concat(this.scenarioName,"_").concat(t),[4,this.eventHubPromise]):[3,5];case 1:return s=a.sent(),l=(c=s).broadcastEvent,f={eventId:i,version:this.monitoringData.version?this.monitoringData.version:o.e,type:"QoS"},n&&(0,r.x)(n.midgardError)?[4,this.lookupError(n.midgardError)]:[3,3];case 2:return u=a.sent(),[3,4];case 3:u=void 0,a.label=4;case 4:l.apply(c,[(f.midgardError=u,f.source=this.monitoringData.source,f.featureName=this.featureName,f.clientCorrelationid=this.monitoringData.clientCorrelationId,f.qosScenarioName=this.scenarioName,f.qosEventType=t,f.qosTagId=null===e?void 0:e,f.duration=this.duration,f.properties=this.getProperties(n),f)]),a.label=5;case 5:return[2]}})})},e.prototype.getProperties=function(e){var t;return(0,a.pi)((0,a.pi)((0,a.pi)((0,a.pi)({},e),((t={})[s.Z.CLIENT_TIMESTAMP]=(new Date).getTime().toString(),t[s.Z.TRANSACTION_ID]=this.transactionId,t)),this.monitoringData.properties),this.staticProperties())},e}();t.Z=l},451:function(e,t,n){function a(e,t){return e.hasOwnProperty(t)}function i(e){return"object"==typeof e&&!!e&&a(e,"family")&&a(e,"code")&&"string"==typeof e.family&&"number"==typeof e.code}n.d(t,{x:function(){return i}})}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return a[e](n,n.exports,r),n.exports}r.m=a,r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce(function(t,n){return r.f[n](e,t),t},[]))},r.u=function(e){return{14:"vendors_loggingdependencies",239:"loggingdependencies"}[e]+"_"+{14:"6a5f2f5299e33b172cec",239:"93278b946fd4334766a5"}[e]+".js"},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e={},t="MidgardBootstrapper:",r.l=function(n,a,i,o){if(e[n])e[n].push(a);else{var s,c;if(void 0!==i)for(var d=document.getElementsByTagName("script"),l=0;l<d.length;l++){var u=d[l];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+i){s=u;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.setAttribute("data-webpack",t+i),s.src=r.tu(n),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous")),e[n]=[a];var f=function(t,a){s.onerror=s.onload=null,clearTimeout(p);var i=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach(function(e){return e(a)}),t)return t(a)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),c&&document.head.appendChild(s)}},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.tt=function(){return void 0===n&&(n={createScriptURL:function(e){return e}},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(n=trustedTypes.createPolicy("@1js/midgard-bootstrapper#webpack",n))),n},r.tu=function(e){return r.tt().createScriptURL(e)},r.p="https://res-1.cdn.office.net/midgard/versionless/",function(){var e={179:0};r.f.j=function(t,n){var a=r.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise(function(n,i){a=e[t]=[n,i]});n.push(a[2]=i);var o=r.p+r.u(t),s=new Error;r.l(o,function(n){if(r.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,a[1](s)}},"chunk-"+t,t)}};var t=function(t,n){var a,i,o=n[0],s=n[1],c=n[2],d=0;if(o.some(function(t){return 0!==e[t]})){for(a in s)r.o(s,a)&&(r.m[a]=s[a]);c&&c(r)}for(t&&t(n);d<o.length;d++)i=o[d],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunkMidgardBootstrapper=self.webpackChunkMidgardBootstrapper||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var o={};return function(){r.r(o),r.d(o,{fetchLokiConfigAsync:function(){return Te},freeBootstrapperMemory:function(){return Pe},initializeLivePersonaCardAsync:function(){return Me},initializeLivePersonaEditorAsync:function(){return Oe}});var e=3e5,t=function(e,t,n,a,i,r){this.name=e,this.message=t,this.rootCorrelationId=n,this.isExpected=a,this.statusCode=i,this.numberOfRetries=r};function n(e,t,n){try{n.sessionStorage&&n.sessionStorage.setItem&&n.sessionStorage.setItem(e,t)}catch(e){}}var a="LokiAuthToken";function i(e,i,r){return new Promise(function(o,s){e?(n(a,e,r),o(e)):i(function(e,i){e?(n(a,e,r),o(e)):s(new t("GetAuthTokenError","Auth token is undefined",i))},function(e,n,a){var i=function(e,t){var n=/^AADSTS\d+?:/.test(e),a=function(e,t){if(t&&e){if(e.indexOf("3399942148"))return!0;if(e.indexOf("3399942154"))return!0;if(e.indexOf("nativeWam:3"))return!0}return!1}(e,t);return n||a}(e,a)?e:"";s(new t("GetAuthTokenError",i,n,a))})})}var s,c=r(932);function d(e,t){var n=function(e){return"df"===e?s.Dogfood:"msit"===e?s.MSIT:void 0}(e);return n||(n=function(e){switch(e){case"Df":return s.Dogfood;case"Msit":return s.MSIT;case"Blackforest":return s.Blackforest;case"GccModerate":return s.GccModerate;case"GccHigh":return s.GccHigh;case"DoD":return s.DOD;case"Gallatin":return s.Gallatin;case"Prod":return s.TopLevel;case"AG08":return s.AG08;case"AG09":return s.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return(0,c.k)(e)}}(t)),n}!function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"}(s||(s={}));var l="{0}/api/v1/livepersonacard/configuration?cultureName={1}",u=r(928);function f(e,t){void 0===t&&(t=window);var n="";if(t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search);n=a&&t.decodeURIComponent(a[1].replace(/\+/g," "))||""}return n}var p="LivePersonaEditorBranchOverride",m="LivePersonaCardVersionOverride",_="MidgardVersion",h="MidgardBranch",b="HostAppConfiguration",g="LivePersonaEditorVersionOverride",v=function(e,t,n,a,i,r){this.name=e,this.message=t,this.rootCorrelationId=n,this.isExpected=a,this.statusCode=i,this.numberOfRetries=r},y=function(e,t,n,a,i,r,o){return void 0===i&&(i={}),void 0===r&&(r=6e4),new Promise(function(s,c){var d,l=new XMLHttpRequest,y=function(e,t){var n=f("ClientTypeOverride",t)||e.clientType,a=f("MidgardOnlyOverrideCatalog",t),i=f(b,t),r=f(_,t);return{clientTypeOverride:n,hostAppConfigurationQSP:i,versionOverride:(a?"":r)||f(m,t)||e.versionOverride||"",lpeVersionOverride:(a?"":r)||f(g,t),lpeBranchOverride:f(p,t),midgardBranchOverride:a?"":f(h,t)}}(n,a),S=y.clientTypeOverride,D=y.hostAppConfigurationQSP,I=y.versionOverride,x=y.lpeVersionOverride,C=y.lpeBranchOverride,O=y.midgardBranchOverride;l.open("GET",e,!0),l.setRequestHeader("Authorization","Bearer "+t),l.setRequestHeader("Accept","application/json");var w=null!==(d=i.requestId)&&void 0!==d?d:(0,u.pW)();if(l.setRequestHeader("X-RootCorrelationId",w),l.setRequestHeader("X-CorrelationId",w),l.setRequestHeader("X-ClientCorrelationId",n.clientCorrelationId),l.setRequestHeader("X-ClientFeature",n.clientFeature),l.setRequestHeader("X-ClientArchitectureVersion","v2"),l.setRequestHeader("X-ClientScenario","GetConfiguration"),o&&l.setRequestHeader("X-LPCVersion",o),S&&l.setRequestHeader("X-ClientType",S),n.app&&l.setRequestHeader("X-HostAppApp",n.app),n.platform&&l.setRequestHeader("X-HostAppPlatform",n.platform),n.hostAppRing&&l.setRequestHeader("X-HostAppRing",n.hostAppRing),n.hostAppVersion&&l.setRequestHeader("X-HostAppVersion",n.hostAppVersion),n.hostAppConfiguration&&l.setRequestHeader("X-HostAppConfiguration",JSON.stringify(n.hostAppConfiguration)),D){var E={};D.split(";").forEach(function(e){var t=e.split(":"),n=t[0],a=t[1];E[n]=a}),l.setRequestHeader(b,JSON.stringify(E))}a&&a.React&&a.React.version&&a.ReactDOM&&l.setRequestHeader("X-HostAppReactVersion",a.React.version),I&&(l.setRequestHeader(m,I),l.setRequestHeader(_,I)),x&&l.setRequestHeader("X-".concat(g),x),C&&l.setRequestHeader("X-".concat(p),C),O&&(l.setRequestHeader(h,O),l.setRequestHeader("X-".concat(h),O)),l.addEventListener("load",function(){if(200===l.status)try{var e=JSON.parse(l.response);e.RootCorrelationId=w,e.LokiVersion=l.getResponseHeader("x-serverversion")||"",s(e)}catch(e){c(new v("GetLokiConfigError","Failed to parse initialization config.",w))}else c(new v("GetLokiConfigError","Couldn't retrieve initialization config. Status code is ".concat(l.status),w,!1,l.status))}),l.addEventListener("error",function(){c(new v("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",w))}),l.addEventListener("timeout",function(){c(new v("GetLokiConfigError","Loki config request timed out after ".concat(r," ms."),w))}),l.timeout=r,l.send()})};function S(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search),a=t.decodeURIComponent||window.decodeURIComponent;return null===n?"":a&&a(n[1].replace(/\+/g," "))||""}var D=function(){return D=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},D.apply(this,arguments)};function I(e,t,n){var a,i,r,o,s,c,u=S("LivePersonaCardCultureOverride",n),f=(i=t.region,r=t.complianceEnvironment,o=u||t.culture,s=null===(a=t.options)||void 0===a?void 0:a.lokiUrlOverride,c=d(i,r),s?l.replace("{0}",s).replace("{1}",o):l.replace("{0}",c).replace("{1}",o));return y(f,e,D(D({},t),{clientFeature:"LivePersonaCard"}),n)}function x(e,t,n){var a=function(e,t){var n=t||e.culture,a=d(e.region,e.complianceEnvironment);return"{0}/api/v1/livepersonaeditor/configuration?cultureName={1}".replace("{0}",a).replace("{1}",n)}(t,S("LivePersonaEditorCultureOverride",n));return y(a,e,D(D({},t),{clientFeature:"LivePersonaEditor"}),n)}var C=r(682),O=(r(895),function(){return Promise.all([r.e(14),r.e(239)]).then(r.bind(r,809))}),w=function(){return O().then(function(e){return e.AWTLogManager})},E="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,A="object"==typeof self&&self&&self.Object===Object&&self,L=(E||A||Function("return this")()).Symbol,k=Object.prototype,M=k.hasOwnProperty,P=k.toString,T=L?L.toStringTag:void 0,U=Object.prototype.toString,F=L?L.toStringTag:void 0,H=function(e){var t;return(t={})[e]="SCRUBBED",t};function R(e,t,n){var a,i,r;void 0===n&&(n=H);var o=Object.keys(e).filter(function(e){return!t.includes(e)}),s=(0,C.pi)({},e);try{for(var c=(0,C.XA)(o),d=c.next();!d.done;d=c.next()){var l=d.value,u=s[l];if("object"!=typeof u||Array.isArray(u))s=Object.assign(s,n(l,s[l]));else{var f=R(s[l],t,n);s=Object.assign(s,((r={})[l]=f,r))}}}catch(e){a={error:e}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(a)throw a.error}}return s}function N(e,t,n,a){return(function(e){if(!function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}(e))return!1;var t=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":F&&F in Object(e)?function(e){var t=M.call(e,T),n=e[T];try{e[T]=void 0;var a=!0}catch(e){}var i=P.call(e);return a&&(t?e[T]=n:delete e[T]),i}(e):function(e){return U.call(e)}(e)}(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}(a)?a(e):a)?R(e,t,n):e}var B,j=["Perf_GetAuthTokenDuration","Perf_GetAuthTokenFromStartDuration","Perf_GetLokiConfigDuration","Perf_GetLokiConfigFromStartDuration","Perf_GetLpcBundlesDuration","Perf_GetLpcBundlesFromStartDuration","Perf_StartLpcDuration","Perf_StartLpcFromStartDuration","Perf_GetLpeBundlesDuration","Perf_GetLpeBundlesFromStartDuration","Perf_AuthRequestDuration","Perf_LpcBundleRequestDuration","Perf_LpcStringsRequestDuration","Perf_InitConfigRequestDuration","isConsumer","ErrorType","ErrorMessage","IsExpected","IsClientOnline","name"],V=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},z=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},G=function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map,e.telemetryCollectorUrlAria&&this.setCollectorUri(e.telemetryCollectorUrlAria)}return e.prototype.logEventAsync=function(e,t){return V(this,void 0,void 0,function(){var n,a,i=this;return z(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n=r.sent(),a=N(e,j,function(e){var t;return(t={})[e]="SCRUBBED",t},function(){return!i.collectorUri}),n.logEvent(a),[4,w()];case 2:return r.sent().flush(this.noOp),[3,4];case 3:return r.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}})})},e.prototype.logVerboseEventAsync=function(e,t){return V(this,void 0,void 0,function(){return z(this,function(n){switch(n.label){case 0:return this.bootstrapperConfig.enableVerboseLogging?[4,this.logEventAsync(e,t)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){var n;return V(this,void 0,void 0,function(){var a,i;return z(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getLoggerAsync(t,e)];case 1:return a=r.sent(),(i=this.getCollectorUri(e))&&(this.setCollectorUri(i),e.TenantAadObjectId&&a.setContext("tenantAadObjectId",e.TenantAadObjectId),e.UserAadObjectId&&a.setContext("userAadObjectId",e.UserAadObjectId),e.UserPuid&&a.setContext("userPuid",e.UserPuid)),e.LokiUrl&&a.setContext("LokiUrl",e.LokiUrl),e.Flights&&a.setContext("flights",null===(n=null==e?void 0:e.Flights)||void 0===n?void 0:n.join(",")),a.setContext("settings",JSON.stringify(e.Settings)),[3,3];case 2:throw r.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e,t){return V(this,void 0,void 0,function(){var n,a,i;return z(this,function(r){switch(r.label){case 0:return(n=this.loggers.get(e))?[3,2]:[4,w()];case 1:a=r.sent(),(i=this.getCollectorUri(t))&&this.setCollectorUri(i),(n=a.initialize(e,{collectorUri:this.collectorUri,disableCookiesUsage:!0}))||(n=a.getLogger(e)),this.loggers.set(e,n),n.setContext("culture",this.bootstrapperConfig.culture),n.setContext("region",this.bootstrapperConfig.region),n.setContext("clientType",this.bootstrapperConfig.clientType),this.bootstrapperConfig.app&&n.setContext("app",this.bootstrapperConfig.app),this.bootstrapperConfig.platform&&n.setContext("platform",this.bootstrapperConfig.platform),n.setContext("clientContextType",this.bootstrapperConfig.clientContextType),i&&n.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),n.setContext("bootstrapperVersion","1.20221130.9.0"),n.setContext("complianceEnvironment",this.bootstrapperConfig.complianceEnvironment),n.setContext("isConsumer",this.bootstrapperConfig.isConsumer),n.setContext("versionOverride",this.bootstrapperConfig.versionOverride||""),n.setContext("hostAppRing",this.bootstrapperConfig.hostAppRing||""),n.setContext("hostAppVersion",this.bootstrapperConfig.hostAppVersion||""),r.label=2;case 2:return[2,n]}})})},e.prototype.setCollectorUri=function(e){this.collectorUri=e},e.prototype.getCollectorUri=function(e){var t,n=(null===(t=null==e?void 0:e.ClientTelemetryCollectorUrls)||void 0===t?void 0:t.Aria)||this.bootstrapperConfig.telemetryCollectorUrlAria;if(n)return n;switch(this.bootstrapperConfig.complianceEnvironment){case"Blackforest":return"https://de.pipe.aria.microsoft.com/Collector/3.0/";case"GccHigh":return"https://tb.pipe.aria.microsoft.com/Collector/3.0";case"DoD":return"https://pf.pipe.aria.microsoft.com/Collector/3.0";case"AG08":case"AG09":return"";default:return}},e.prototype.noOp=function(){},e}(),K=new RegExp("https?://localhost(:|/|$)"),W=r.p,q=["https://res.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-1.cdn.partner.office365.cn","https://outlook-1-cdn.azureedge.eaglex.ic.gov","https://outlook-1-cdn.azureedge.microsoft.scloud"];function Q(e,t){var n=new URL("https://midgardbranches.blob.core.windows.net/lpc/refs/heads/"),a=t&&"/_next/"!==t?new URL(t):void 0,i=new URL(e,document.baseURI).origin;if(i===n.origin||a&&i===a.origin||function(e){return q.includes(e)}(i)||K.test(i))return e;throw new Error("TrustedType policy does not allow loading scripts from ".concat(i,", only from ").concat(n.origin,", ").concat(null==a?void 0:a.origin," and localhost."))}var Y="data-is-midgard-bootstrapper-script";function J(e,t,n,a,i){var r=this;void 0===a&&(a=!1),void 0===i&&(i=!1);var o=0,s=function(e,t){return c=r,l=function(){var r;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,6]),[4,X(e,t,a,i,n)];case 1:return c.sent(),[3,6];case 2:return r=c.sent(),o<2?(o++,[4,s(e,t)]):[3,4];case 3:return c.sent(),[3,5];case 4:throw r.numberOfRetries=o,r;case 5:return[3,6];case 6:return[2]}})},new((d=void 0)||(d=Promise))(function(e,t){function n(e){try{i(l.next(e))}catch(e){t(e)}}function a(e){try{i(l.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof d?i:new d(function(e){e(i)})).then(n,a)}i((l=l.apply(c,[])).next())});var c,d,l};return s(e,t)}function X(e,n,a,i,o){return new Promise(function(s,c){n||c(new t("StartLivePersonaCardError","targetWindow is undefined in appendScriptToDocumentAsync"));var d=n.document.querySelectorAll("script[".concat(Y,"]"));if(i&&2===d.length)s();else{var l=function(e,t,n){void 0===t&&(t=W),void 0===n&&(n=!0);var a,i=null,r=function(){if(void 0===B&&(B=null,"undefined"!=typeof self&&self.trustedTypes))try{B=self.trustedTypes.createPolicy("@1js/midgard-trusted-types",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e,t){return void 0===t&&(t=W),Q(e,t)}})}catch(e){}return B}();try{i=n&&r?r.createScriptURL(e,t):Q(e,t)}catch(e){a=e.message}return{error:a,url:i,trustedTypeAvailable:!!r}}(e,r.p,a);if(l.error)return c(new t("LoadScriptError",l.error));var u=n.document.createElement("script");u.type="text/javascript",u.charset="utf-8",u.setAttribute(Y,""),u.crossOrigin="anonymous",u.src=l.url,u.addEventListener("load",function(){o&&o({name:"LoadScriptSuccess",properties:{isLPCDefined:!!n.LPC,lpcWindowId:n.lpcWindowId}}),s()}),u.addEventListener("error",function(){o&&o({name:"LoadScriptFailure",properties:{isLPCDefined:!!n.LPC,lpcWindowId:n.lpcWindowId}}),c(new t("LoadScriptError","Unexpected error while loading script on page, lpcWindowId:"+n.lpcWindowId))}),n.document.body.appendChild(u)}})}var Z=function(){return Z=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Z.apply(this,arguments)},$=new WeakMap;function ee(e){var t=e.targetWindow||window,n=$.get(t);return n?n.bootstrapperConfig=Z(Z({},n.bootstrapperConfig),e):(n={bootstrapperConfig:Z(Z({},e),{targetWindow:t}),ariaLogger:new G(e),initializationPromise:void 0,lpeInitializationPromise:void 0,forceRefreshInitializationPromise:!1,forceRefreshLpeInitializationPromise:!1,forceRefreshInitializationTimeout:void 0}).bootstrapperConfig.targetWindow.lpcWindowId=(0,u.pW)(),$.set(t,n),n}var te=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},ne=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},ae=0;function ie(e,t,n){return te(this,void 0,void 0,function(){var a,i;return ne(this,function(r){switch(r.label){case 0:return(i=ee(t)).lpcConfig?(a=i.lpcConfig,[3,3]):[3,1];case 1:return[4,re(e,t,n)];case 2:a=r.sent(),i.lpcConfig=a,r.label=3;case 3:return[2,a]}})})}function re(e,t,n){return te(this,void 0,void 0,function(){var a,r;return ne(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,8]),[4,I(e,t,n)];case 1:return a=o.sent(),[3,8];case 2:return(r=o.sent()).statusCode&&401===r.statusCode?[4,i(void 0,t.getAuthToken,n)]:[3,4];case 3:e=o.sent(),o.label=4;case 4:return ae<2?(ae++,[4,re(e,t,n)]):[3,6];case 5:return a=o.sent(),[3,7];case 6:throw r.numberOfRetries=ae,r;case 7:return[3,8];case 8:return[2,a]}})})}function oe(e,t,n,a,i){var r=e.ResourceUrls||[];if(0===r.length){var o=e.Resources?e.Resources.livepersonacardstrings:"",s=e.Resources?null==e?void 0:e.Resources["livepersonacard_with-react"]:"";"OwaPeopleHub"===e.Workload&&(s=e.Resources?e.Resources["livepersonacard_without-react"]:""),r=[o,s].filter(function(e){return""!==e})}return Promise.all(r.map(function(e){return J(e,t,n,a,i)})).then(function(){return r})}var se=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))};function ce(e,n){var a=this,i=n.targetWindow;return new Promise(function(r,o){setTimeout(function(){return s=a,d=function(){var a,s;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),i||o(new t("StartLivePersonaCardError","targetWindow is undefined in startLivePersonaCardAsync")),i.LPC||o(new t("StartLivePersonaCardError","targetWindow.LPC is undefined., lpcWindowId:"+i.lpcWindowId)),i.LivePersonaCardStrings&&i.LivePersonaCardStrings.strings||i.LivePersonaCardStringsLpcMini&&i.LivePersonaCardStringsLpcMini.strings||o(new t("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined, lpcWindowId:"+i.lpcWindowId)),a=function(e,t){var n,a,i,r,o=t.targetWindow;return{accountId:t.accountId,refreshAuthToken:(r=t.getAuthToken,function(e){r(function(t,n){e(t,"",n,void 0)},function(t,n){e("",t,n,void 0)})}),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:o.LivePersonaCardStringsLpcMini&&o.LivePersonaCardStringsLpcMini.strings||o.LivePersonaCardStrings&&o.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId&&(0,u.SD)(t.clientCorrelationId)?t.clientCorrelationId:"00000000-0000-0000-0000-000000000000",activeFlights:e.Flights?se([],e.Flights,!0):[],isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,telemetryCallbacks:t.telemetryCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{hideDocumentFilter:!1},theme:t.theme,setConfigurationManagerForTesting:t.setConfigurationManagerForTesting,lokiUrl:(null===(n=t.options)||void 0===n?void 0:n.lokiUrlOverride)||e.LokiUrl||"",lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId||"",userAadObjectId:e.UserAadObjectId||"",userPuid:e.UserPuid||"",ecsConfigIds:e.EcsConfigIds?se([],e.EcsConfigIds,!0):[],ecsETag:e.EcsEtag||"",loggedInUserUpn:e.Upn||"",loggedInUserTeamsMri:t.loggedInUserTeamsMri,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName||"",app:t.app,platform:t.platform,telemetryCollectorUrlAria:(null===(a=e.ClientTelemetryCollectorUrls)||void 0===a?void 0:a.Aria)||t.telemetryCollectorUrlAria,telemetryCollectorUrlOneDs:(null===(i=e.ClientTelemetryCollectorUrls)||void 0===i?void 0:i.OneDs)||t.telemetryCollectorUrlOneDs,versionOverride:t.versionOverride}}(e,n),[4,i.LPC.start(a)];case 1:return c.sent(),r(),[3,3];case 2:return s=c.sent(),o(new t("StartLivePersonaCardError",s.name)),[3,3];case 3:return[2]}})},new((c=void 0)||(c=Promise))(function(e,t){function n(e){try{i(d.next(e))}catch(e){t(e)}}function a(e){try{i(d.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof c?i:new c(function(e){e(i)})).then(n,a)}i((d=d.apply(s,[])).next())});var s,c,d},0)})}function de(e){switch(e.complianceEnvironment){case"Blackforest":return"e5ad760145754ffc9704e67c800087f2-accc9196-f40d-49fd-8968-2e6240e5d84c-7381";case"GccHigh":return"e5ad760145754ffc9704e67c800087f2-3831d322-8b62-464b-8147-272e41908150-7184";case"DoD":return"e5ad760145754ffc9704e67c800087f2-27405810-62d9-4796-a308-28b057a92523-6970";case"Gallatin":return"e5ad760145754ffc9704e67c800087f2-97d9a12c-35b6-4ec7-9bb9-d00d7b5d28d2-7079";case"AG08":case"AG09":return"";default:return"e5ad760145754ffc9704e67c800087f2-994e0432-dd0e-4a24-9a3d-bb9d8a6b83f3-7303"}}function le(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsExpected:e.isExpected||!1,IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}var ue=function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark("".concat(e,"-start"))}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark("".concat(e,"-end")),this.targetWindow.performance.measure(e,"".concat(e,"-start"),"".concat(e,"-end"));var t=this.targetWindow.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=this.targetWindow.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),a=Math.round(t.duration);-1!==n.indexOf("authtoken/loki")||-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?e.timings.Perf_AuthRequestDuration=a:-1!==n.indexOf("/lpc/versionless/livepersonacard_")?e.timings.Perf_LpcBundleRequestDuration=a:-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?e.timings.Perf_LpcStringsRequestDuration=a:-1!==n.indexOf("/api/v1/configuration/")&&(e.timings.Perf_InitConfigRequestDuration=a)}})}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():Date.now()},e}(),fe=["Df","Msit","Prod","Blackforest","GccModerate","GccHigh","DoD","Gallatin","AG08","AG09","Unknown"],pe=["msit","df"];function me(e){return void 0===e||"string"!=typeof e||""===e||null===e}function _e(e){return void 0===e||"function"!=typeof e}function he(e){var n="";if(e){var a=[];me(e.culture)&&a.push("culture"),me(e.clientType)&&a.push("clientType"),me(e.clientContextType)&&a.push("clientContextType"),me(e.clientCorrelationId)&&a.push("clientCorrelationId"),_e(e.logMessage)&&a.push("logMessage"),_e(e.getAuthToken)&&a.push("getAuthToken"),a.length>0&&(n="Invalid required parameter(s): ".concat(a.join(", "),". Check the values and types you're passing. ")),e.region&&-1===pe.indexOf(e.region.toLowerCase().trim())&&(n+="Invalid region value. Allowed values are: empty string for production environments, "+"and ".concat(pe.join(", ")," for pre-production environments. ")),-1===fe.indexOf(e.complianceEnvironment)&&(n+="Environment is missing or wrong. Allowed values are: ".concat(fe.join(", "),". We currently don't support other Sovereign Clouds."))}else n="Config must be defined.";if(n)throw new t("ValidateBootstrapperConfigError",n)}var be=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},ge=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},ve=0;function ye(e,t,n){return be(this,void 0,void 0,function(){var a,i;return ge(this,function(r){switch(r.label){case 0:return(i=ee(t)).lpeConfig?(a=i.lpeConfig,[3,3]):[3,1];case 1:return[4,Se(e,t,n)];case 2:a=r.sent(),i.lpeConfig=a,r.label=3;case 3:return[2,a]}})})}function Se(e,t,n){return be(this,void 0,void 0,function(){var a,r;return ge(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,8]),[4,x(e,t,n)];case 1:return a=o.sent(),[3,8];case 2:return(r=o.sent()).statusCode&&401===r.statusCode?[4,i(void 0,t.getAuthToken,n)]:[3,4];case 3:e=o.sent(),o.label=4;case 4:return ve<2?(ve++,[4,ye(e,t,n)]):[3,6];case 5:return a=o.sent(),[3,7];case 6:throw r.numberOfRetries=ve,r;case 7:return[3,8];case 8:return[2,a]}})})}function De(e,t){var n,a,i,r=e.Flights?function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}([],e.Flights,!0):[],o=(null===(n=e.Resources)||void 0===n?void 0:n.livepersonaeditorstrings)||"",s=(null===(a=e.Resources)||void 0===a?void 0:a["livepersonaeditor_with-react"])||"",c=(null===(i=e.Resources)||void 0===i?void 0:i["livepersonaeditor_without-react"])||"",d=[o,r.indexOf("withreact")>-1?s:c].filter(function(e){return""!==e});return Promise.all(d.map(function(e){return J(e,t)})).then(function(){return d})}var Ie=function(){return Ie=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ie.apply(this,arguments)},xe=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},Ce=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};function Oe(t){return xe(this,void 0,void 0,function(){var n,a,r,o=this;return Ce(this,function(s){return n=new ue(window),a=ee(t),r=function(){return ee(t).ariaLogger},!a.forceRefreshLpeInitializationPromise&&a.lpeInitializationPromise||(a.lpeInitializationPromise=new Promise(function(e,a){return xe(o,void 0,void 0,function(){var o,s,c,d,l;return Ce(this,function(u){switch(u.label){case 0:o=de(t),u.label=1;case 1:return u.trys.push([1,6,,7]),he(t),n.startCustomTiming("Perf_GetAuthTokenDuration"),[4,i(t.authToken,t.getAuthToken,window)];case 2:return s=u.sent(),n.endCustomTiming("Perf_GetAuthTokenDuration"),n.measureFromStart("Perf_GetAuthTokenFromStartDuration"),n.startCustomTiming("Perf_GetLokiConfigDuration"),[4,ye(s,t,window)];case 3:return c=u.sent(),n.endCustomTiming("Perf_GetLokiConfigDuration"),n.measureFromStart("Perf_GetLokiConfigFromStartDuration"),n.startCustomTiming("Perf_GetLpeBundlesDuration"),[4,De(c,window)];case 4:return u.sent(),n.endCustomTiming("Perf_GetLpeBundlesDuration"),n.measureFromStart("Perf_GetLpeBundlesFromStartDuration"),[4,r().updateContextWithLokiDataAsync(c,o).catch(function(){console.log("Live Persona Editor ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 5:return u.sent(),r().logEventAsync({name:"initializeLivePersonaEditor_success",properties:Ie(Ie({},n.getAllTimings()),{RootCorrelationId:c.RootCorrelationId,isConsumer:"".concat(t.isConsumer)})},o),e(c),[3,7];case 6:return d=u.sent(),l=n.getAllTimings(),r().logEventAsync({name:"initializeLivePersonaEditor_failure",properties:Ie(Ie(Ie({},le(d)),l),{isConsumer:"".concat(t.isConsumer)})},o),a("Failed to initialize Live Persona Editor: ".concat(d.name," ").concat(d.message)),[3,7];case 7:return[2]}})})}),a.lpeInitializationPromise.catch(function(){setTimeout(function(){a.forceRefreshLpeInitializationPromise=!0},e)})),[2,a.lpeInitializationPromise]})})}var we=function(){return we=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},we.apply(this,arguments)},Ee=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},Ae=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};try{var Le=window.document.createElement("link"),ke=Boolean("onmscontentzoom"in window.document);Le.rel=ke?"dns-prefetch":"preconnect",Le.href="https://res-1.cdn.office.net/",window.document.head.appendChild(Le)}catch(e){console.log("Live Persona Card ERROR: Bootstrapper failed to warm up the connection to Midgard CDN.",e)}function Me(t){return Ee(this,void 0,void 0,function(){var n,a,r,o,s=this;return Ae(this,function(c){return!(n=ee(t)).forceRefreshInitializationPromise&&n.initializationPromise||(a=function(){return n.ariaLogger},r=n.bootstrapperConfig.targetWindow,o=new ue(r),n.forceRefreshInitializationPromise=!1,n.initializationPromise=new Promise(function(e,c){return Ee(s,void 0,void 0,function(){var s,d,l,u,f,p,m;return Ae(this,function(_){switch(_.label){case 0:s=de(t),_.label=1;case 1:return _.trys.push([1,7,,8]),he(t),o.startCustomTiming("Perf_GetAuthTokenDuration"),[4,i(t.authToken,t.getAuthToken,r)];case 2:return d=_.sent(),o.endCustomTiming("Perf_GetAuthTokenDuration"),o.measureFromStart("Perf_GetAuthTokenFromStartDuration"),o.startCustomTiming("Perf_GetLokiConfigDuration"),[4,ie(d,t,r)];case 3:return l=_.sent(),o.endCustomTiming("Perf_GetLokiConfigDuration"),o.measureFromStart("Perf_GetLokiConfigFromStartDuration"),o.startCustomTiming("Perf_GetLpcBundlesDuration"),[4,a().updateContextWithLokiDataAsync(l,s).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 4:return _.sent(),[4,oe(l,r,function(e){a().logVerboseEventAsync(e,s)},null===(p=t.options)||void 0===p?void 0:p.isTrustedTypesEnabled,null===(m=t.options)||void 0===m?void 0:m.isReuseScriptsEnabled)];case 5:return _.sent(),o.endCustomTiming("Perf_GetLpcBundlesDuration"),o.measureFromStart("Perf_GetLpcBundlesFromStartDuration"),o.startCustomTiming("Perf_StartLpcDuration"),[4,ce(l,n.bootstrapperConfig)];case 6:return _.sent(),o.endCustomTiming("Perf_StartLpcDuration"),o.measureFromStart("Perf_StartLpcFromStartDuration"),a().logEventAsync({name:"initializeLivePersonaCard_success",properties:we(we({},o.getAllTimings()),{RootCorrelationId:l.RootCorrelationId,isConsumer:"".concat(t.isConsumer),lpcWindowId:r.lpcWindowId})},s),e(),[3,8];case 7:return u=_.sent(),f=o.getAllTimings(),a().logEventAsync({name:"initializeLivePersonaCard_failure",properties:we(we(we({},le(u)),f),{isConsumer:"".concat(t.isConsumer),lpcWindowId:r.lpcWindowId})},s),c("Failed to initialize Live Persona Card: ".concat(u.name," ").concat(u.message)),[3,8];case 8:return[2]}})})}),n.initializationPromise.catch(function(){n.forceRefreshInitializationTimeout=window.setTimeout(function(){n&&(n.forceRefreshInitializationPromise=!0)},e)})),[2,n.initializationPromise]})})}function Pe(e){!function(e){var t,n=$.get(e);if(n){var a=n.bootstrapperConfig.targetWindow,i=null===(t=n.bootstrapperConfig.options)||void 0===t?void 0:t.isReuseScriptsEnabled;if(a&&(a.LPC&&a.LPC.cleanUp&&a.LPC.cleanUp(),!i)){delete a.LPC,delete a.LivePersonaCardHoverTarget,delete a.LivePersonaCardHoverTargetV2,delete a.LivePersonaCardStrings,delete a.LivePersonaCardStringsLpcMini,delete a.MeetingInsightsV2,delete a.MidgardBootstrapper,delete a.PersonaInsightRing,delete a.LPE,delete a.lpcWindowId;try{a.document.querySelectorAll("script[".concat(Y,"]")).forEach(function(e){return e.remove()})}catch(e){console.warn("midgard-bootstrapper:deleteBootstrapperInstance(): Failed removing one or more script tags")}}delete n.bootstrapperConfig.targetWindow,delete n.ariaLogger,delete n.bootstrapperConfig,n.initializationPromise=void 0,clearTimeout(n.forceRefreshInitializationTimeout)}$.delete(e)}(e)}function Te(e){return Ee(this,void 0,void 0,function(){var t;return Ae(this,function(n){switch(n.label){case 0:return t=ee(e),[4,i(e.authToken,e.getAuthToken,t.bootstrapperConfig.targetWindow)];case 1:return[2,ie(n.sent(),e,t.bootstrapperConfig.targetWindow)]}})})}}(),o}()},4392:function(e,t,n){"use strict";n.d(t,"e",function(){return l}),n.d(t,"t",function(){return f});var a=n(0),i=n(41),r=["us_2_","us_86_","us_96_","us_105_","us_265_","us_266_","us_267_","us_268_","us_269_","us_270_"],o=n(2494),s=n(1429),c=n(2416),d=n(8),l=function(e){function t(t){var n=e.call(this,{dataSourceName:"LokiDataSource"},{pageContext:t})||this;return n._oAuthTokenProvider=new o.e(null,{oAuthTokenDataSource:new c.e(t)}),n}return Object(a.__extends)(t,e),t.prototype.getRegion=function(){var e=new i.e({name:"LivePersonaCard.GetLokiRegion"});try{var n=this._pageContext.farmLabel;if(!n)return e.end({resultType:i.t.Failure,resultCode:"LokiNoFarmLabel",error:"Farm label property not found in _spPageContextinfo object. Aborting connection!"}),"";var a=n.split("_")[0].toLowerCase();return t.FARMLABEL_TO_REGION_MAPPING[a]}catch(t){return e.end({resultType:i.t.Failure,resultCode:"LokiGetRegionError",error:t}),""}},t.prototype.getAuthTokenGetter=function(e){return void 0===e&&(e=""),this.getAadAuthTokenGetter()},t.prototype.getAadAuthTokenGetter=function(){var e,t,n,a=this,i=this._pageContext.CorrelationId,r=(e=(t=this._pageContext.farmSettings)&&("ag08"===(n=t.ExternalService_searchcloudenvironment)||"ag09"===n)&&t.ExternalService_searchcloudurl?JSON.parse(t.ExternalService_searchcloudurl):void 0)&&e.Loki||"https://loki.delve.office.com";return function(e,t){a._oAuthTokenProvider.getInstrumentedToken(r).then(function(t){return e(t.tokenInfo.token,t.spRequestId)}).catch(function(e){var n={httpStatusCode:e.httpResponseStatus,serverErrorCode:e.serverErrorCode,requestCorrelationId:e.correlationId,type:e.type};t(JSON.stringify(n),i)})}},t.prototype.getBootstrapperConfig=function(){return{culture:this._pageContext.currentUICultureName,region:this.getRegion(),clientType:"ODSP",clientCorrelationId:this._pageContext.CorrelationId,complianceEnvironment:d.t.isActivated("f513174d-96fc-46d5-ae79-ba202d3ebf91")?(e=this._pageContext,u(e)?"Blackforest":p(e)?"GccModerate":"Prod"):f(this._pageContext),getAuthToken:this.getAuthTokenGetter()};var e},t.FARMLABEL_TO_REGION_MAPPING={edog:"ppe",msit:"msit",spdf:"df"},t}(s.t);function u(e){return e.env&&"blackforest"===e.env.toLowerCase()||e.farmLabel&&0===e.farmLabel.toLowerCase().indexOf("deu_1")}function f(e){switch(function(e){var t=e.webAbsoluteUrl,n=e.farmLabel,a=e.env2,i=e.farmSettings;if("o365test"===a||"onebox"===a||"edog"===a)return a;if("string"==typeof t&&t.toLowerCase().indexOf("microsoft.sharepoint-df.com")>-1)return"spdf";if(null==i?void 0:i.ExternalService_searchcloudenvironment){var o=i.ExternalService_searchcloudenvironment;return"spdf"===o?"prodbubble":o}return function(e){return Boolean(e)&&r.some(function(t){return 0===e.toLowerCase().indexOf(t)})}(n)?"gcc":a}(e)||"prod"){case"o365test":case"onebox":case"edog":case"spdf":return"Df";case"prodbubble":return"Msit";default:return"Prod";case"blackforest":return"Blackforest";case"gallatin":return"Gallatin";case"pathfinder":return"DoD";case"trailblazer":return"GccHigh";case"gcc":return"GccModerate";case"ag08":return"AG08";case"ag09":return"AG09"}}function p(e){var t=e.farmLabel&&e.farmLabel.toLowerCase()||"";return 0===t.indexOf("us_2_")||0===t.indexOf("us_86_")||0===t.indexOf("us_96_")||0===t.indexOf("us_105_")||0===t.indexOf("us_265_")||0===t.indexOf("us_266_")||0===t.indexOf("us_267_")||0===t.indexOf("us_268_")||0===t.indexOf("us_269_")||0===t.indexOf("us_270_")}},4716:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(0),i=n("react-lib"),r=n(117);Object(r.n)([{rawString:".livePersonaCardAdapterRoot_1e006338{display:inline-block}"}]);var o=n(3816),s=n(4392),c=n(2384),d=n(2032),l=n(112),u=n(8),f=function(e){function t(n,a){var i=e.call(this,n,a)||this;return i.makeAdapterConfig=function(){var e=i.props.lpcCallbacks||{};return i.props.addGroupMembersCallback&&(e.addGroupMembers=i.props.addGroupMembersCallback),{pageContext:i.props.pageContext,actionCallBacks:e,dataCallBacks:i.props.lpcCallbacks,clientType:i.props.lpcClientType}},i.state={isReady:!1},i.hasCalledOnReady=!1,t.ensureInitializeLPC(i.makeAdapterConfig()).then(function(){i.setState({isReady:!0})}),i}return Object(a.__extends)(t,e),t.ensureInitializeLPC=function(e){if(!e.pageContext.isSPO)return Promise.reject("LPC is not supported on-prem.");if((e.pageContext.isExternalGuestUser||e.pageContext.isAnonymousGuestUser)&&(t.disableLPCForNativeIdentity||!e.pageContext.isNativeFederatedUser))return Promise.reject("LPC is not enabled for guest users.");if(window.LPC&&window.LPC.getRenderer)return t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget,t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2,e.callback&&e.callback(),Promise.resolve();var n=new s.e(e.pageContext),a=n.getAadAuthTokenGetter(),i=Object(s.t)(e.pageContext),r={culture:e.pageContext.currentUICultureName,region:n.getRegion(),clientType:e.clientType||"ODSP",clientContextType:"Generic",clientCorrelationId:e.pageContext.CorrelationId,logMessage:t._logResult,getAuthToken:a,actionCallbacks:e.actionCallBacks,dataCallbacks:e.dataCallBacks,complianceEnvironment:"Msit"===i||"Df"===i?"Prod":i};return Object(o.initializeLivePersonaCardAsync)(r).then(function(){t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget,t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2,e.callback&&e.callback(),e.onSuccess&&e.onSuccess()}).catch(function(t){e.onFailure&&e.onFailure(t)})},t._buildHostAppPersonaId=function(e,n){if(!t.disableLPCForNativeIdentity&&e&&n)return e=e.replace(/[{}]/g,""),n=n.replace(/[{}]/g,""),"".concat(e,"@").concat(n)},t.prototype.render=function(){var e=this,n=!!this.props.displayName;if(t.LivePersonaCardHoverTargetV2&&!this.props.lpcHoverTargetProps){var r=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),{cardParameters:Object(a.__assign)({personaInfo:{identifiers:{HostAppPersonaId:t._buildHostAppPersonaId(this.props.organizationId,this.props.tenantId),DisplayName:this.props.displayName,Smtp:this.props.legacyEmail||this.props.email,Upn:this.props.upn||("User"===this.props.personaType?this.props.legacyEmail:void 0),PersonaType:this.props.personaType,TopicId:this.props.topicId,LocationId:this.props.locationId},displayName:n?this.props.displayName:void 0,personaCoinColor:n?Object(c.e)({text:this.props.displayName}):void 0},behavior:Object(a.__assign)(Object(a.__assign)({},this.props.lpcCardBehavior),{onCardOpen:function(){e.props.loggingData&&l.e.logData(e.props.loggingData),e.props.lpcCardBehavior&&e.props.lpcCardBehavior.onCardOpen&&e.props.lpcCardBehavior.onCardOpen()},onCardClose:function(){e.props.loggingData&&l.e.logData(e.props.loggingData),e.props.lpcCardBehavior&&e.props.lpcCardBehavior.onCardClose&&e.props.lpcCardBehavior.onCardClose()}}),externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel})}),this.props.lpcHoverTargetV2Props);return i.createElement(t.LivePersonaCardHoverTargetV2,Object(a.__assign)({},r),this.props.children)}return t.LivePersonaCardHoverTarget?(r=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({upn:this.props.legacyEmail,hostAppPersonaInfo:{PersonaType:this.props.personaType,LocationId:this.props.locationId},externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel}),this.props.lpcHoverTargetProps),{onCardOpen:function(){e.props.loggingData&&l.e.logData(e.props.loggingData),e.props.lpcHoverTargetProps&&e.props.lpcHoverTargetProps.onCardOpen&&e.props.lpcHoverTargetProps.onCardOpen()}}),i.createElement(t.LivePersonaCardHoverTarget,Object(a.__assign)({},r),this.props.children)):i.createElement("div",{className:"livePersonaCardAdapterRoot"},this.props.children)},t.prototype.componentDidUpdate=function(){this.state.isReady&&!this.hasCalledOnReady&&this.props.onPersonaCardReady&&(this.hasCalledOnReady=!0,this.props.onPersonaCardReady())},t.LivePersonaCardHoverTarget=void 0,t.LivePersonaCardHoverTargetV2=void 0,t.disableLPCForNativeIdentity=u.t.isActivated("4447C532-D4A2-4162-9C89-56324A4F7E52","08/03/2021","enable LPC for native identity users"),t._logResult=function(e,t,n){},t}(d.e)},5234:function(e,t,n){"use strict";n.r(t),n.d(t,"SpLivePersonaCard",function(){return c});var a=n(0),i=n("react-lib"),r=n(2032),o=n(1432),s=n(4716),c=function(e){function t(n,a){var i=e.call(this,n,a)||this;return i.state={lpcCallbacks:t.makeSpLpcCallbacks(void 0,i.props.pageContext,i.props.lpcCallbacks)},i}return Object(a.__extends)(t,e),t.makeSpLpcCallbacks=function(e,t,n){return Object(a.__assign)(Object(a.__assign)({},n||{}),{getAndPrefetchPersonaImageUri:function(e,t){"User"===e.PersonaType&&e.Smtp&&t?t(Object(o.getUserPhotoUrl)(e.Smtp,o.UserPhotoSize.Large)):t()},addGroupMembers:e})},t.prototype.render=function(){return i.createElement(s.e,{personaType:this.props.personaType,displayName:this.props.displayName,legacyEmail:this.props.identifier,locationId:this.props.locationId,pageContext:this.props.pageContext,dataAutomationId:this.props.dataAutomationId,lpcCallbacks:this.state.lpcCallbacks,lpcHoverTargetProps:this.props.lpcHoverTargetProps,loggingData:this.props.loggingData,lpcCardBehavior:this.props.lpcCardBehavior,lpcHoverTargetV2Props:this.props.lpcHoverTargetV2Props,ariaLabel:this.props.ariaLabel,tabIndex:this.props.tabIndex,lpcClientType:this.props.lpcClientType,topicId:this.props.topicId,organizationId:this.props.organizationId,tenantId:this.props.tenantId,onPersonaCardReady:this.props.onPersonaCardReady},this.props.children)},t}(r.e)}}]);