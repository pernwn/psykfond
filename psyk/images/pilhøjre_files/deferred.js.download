/*! For license information please see deferred.js.LICENSE.txt */
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred"],{2054:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return M}),n.d(t,"clearCache",function(){return P}),n.d(t,"isProvisioning",function(){return T});var a=n(330),i=n(171),r=n(95),o=n(125),s=n(2595),c=n(2475),d=n(0),l=n(1300),u=n(97),f=function(){function e(){}return e.prototype.OnFlexPaneVisibilityChanged=function(e){try{return O365Shell.FlexPane.OnFlexPaneVisibilityChanged(e)}catch(e){u.e.log(e,"FlexPaneWrapper","OnFlexPaneVisibilityChanged")}},e.prototype.OpenFlexPaneForProvider=function(e){try{O365Shell.FlexPane.OpenFlexPaneForProvider(e)}catch(e){u.e.log(e,"FlexPaneWrapper","OpenFlexPaneForProvider")}},e.prototype.CloseFlexPaneForProvider=function(e){try{O365Shell.FlexPane.CloseFlexPaneForProvider(e)}catch(e){u.e.log(e,"FlexPaneWrapper","CloseFlexPaneForProvider")}},e.prototype.RemoveOnFlexPaneVisibilityChanged=function(e){try{O365Shell.FlexPane.RemoveOnFlexPaneVisibilityChanged(e)}catch(e){u.e.log(e,"FlexPaneWrapper","RemoveOnFlexPaneVisibilityChanged")}},e.prototype.OnFlexPaneZoomChanged=function(e){try{O365Shell.FlexPane.OnFlexPaneZoomChanged(e)}catch(e){u.e.log(e,"FlexPaneWrapper","RemoveOnFlexPaneVisibilityChanged")}},e.prototype.RemoveOnFlexPaneZoomChanged=function(e){try{O365Shell.FlexPane.RemoveOnFlexPaneZoomChanged(e)}catch(e){u.e.log(e,"FlexPaneWrapper","RemoveOnFlexPaneVisibilityChanged")}},e}(),p=function(){function e(){}return e.prototype.OnLinkClick=function(e){try{O365Shell.Navigation.OnLinkClick(e)}catch(e){u.e.log(e,"NavigationWrapper","OnLinkClick")}},e.prototype.OnHamburgerButtonClick=function(e){try{O365Shell.Navigation.OnHamburgerButtonClick(e)}catch(e){u.e.log(e,"NavigationWrapper","OnHamburgerButtonClick")}},e.prototype.RemoveOnLinkClick=function(e){try{O365Shell.Navigation.OnLinkClick(e)}catch(e){u.e.log(e,"NavigationWrapper","RemoveOnLinkClick")}},e.prototype.EnterAccessibilityLoopInShell=function(){try{O365Shell.Navigation.EnterAccessibilityLoopInShell()}catch(e){u.e.log(e,"NavigationWrapper","EnterAccessibilityLoopInShell")}},e.prototype.ReverseEnterAccessibilityLoopInShell=function(){try{O365Shell.Navigation.ReverseEnterAccessibilityLoopInShell()}catch(e){u.e.log(e,"NavigationWrapper","ReverseEnterAccessibilityLoopInShell")}},e.prototype.SetForwardAccessibilityLoopOutsideHeaderElementId=function(e){try{O365Shell.Navigation.SetForwardAccessibilityLoopOutsideHeaderElementId(e)}catch(e){u.e.log(e,"NavigationWrapper","SetForwardAccessibilityLoopOutsideHeaderElementId")}},e.prototype.SetReverseAccessibilityLoopOutsideHeaderElementId=function(e){try{O365Shell.Navigation.SetReverseAccessibilityLoopOutsideHeaderElementId(e)}catch(e){u.e.log(e,"NavigationWrapper","SetReverseAccessibilityLoopOutsideHeaderElementId")}},e}(),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._flexPane=new f,t._navigation=new p,t}return Object(d.__extends)(t,e),Object.defineProperty(t.prototype,"FlexPane",{get:function(){return this._flexPane},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Navigation",{get:function(){return this._navigation},enumerable:!1,configurable:!0}),t}(l.e),_=m,h=n(1442),b=n(124),g=n(1452),v=n(35),y=n(2477),S=n(116),D=n(1425),I=n(112),x=n(41),C=n(2468),O="Data",w="CacheDate",E="CacheVersion",A="CachedThisSession",L=new i.e("odSuiteNav",r.e.local),k=function(){function e(e,t){this._dataSource=t.dataSource,this._capabilities=this._dataSource.getCapabilities(),this._cssLoaded=!1}return Object.defineProperty(e.prototype,"suiteNavPlaceholder",{get:function(){return this._suiteNavPlaceholder},set:function(e){this._suiteNavPlaceholder||(this._suiteNavPlaceholder=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"accountSwitchCallback",{get:function(){return this._dataSource.accountSwitchCallback},enumerable:!1,configurable:!0}),e.prototype.getCapabilities=function(){return this._capabilities},e.prototype.clearCachedPromise=function(){this._modelPromise=void 0,this._shellSignal=void 0},e.prototype.getRenderSetting=function(e){return this._dataSource.getRenderSetting?this._dataSource.getRenderSetting(e):null},e.prototype.loadData=function(e){return this._loadModel(e).then(function(e){return e.data})},e.prototype.getO365Shell=function(){if(!this._capabilities.supportsRealSuiteNav)throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");var e=this._shellSignal;if(!e){e=new a.e;var t=new x.e({name:"SuiteNavProvider.GetO365Shell"});this._getSuiteNavShell(e),e.getPromise().then(function(){t.end({resultType:x.t.Success})},function(e){t.end(H({error:e}))}),this._shellSignal=e}return e.getPromise()},e.prototype.getMailUrl=function(){return this._loadModel().then(function(e){var t=e&&e.data&&e.data.WorkloadLinks;if(t)for(var n=0,a=t;n<a.length;n++){var i=a[n];if(i&&i.Id===h.e.MAIL)return i.Url}})},e.prototype._getSuiteNavShell=function(e,t){var n=this;this._loadModel().then(function(a){!n._cssLoaded&&a.cssUrl&&(D.e.loadStylesheet(a.cssUrl),n._dataSource.onCssLoad&&n._dataSource.onCssLoad(a),n._cssLoaded=!0);var i=a.requireConfig,r=i&&i.paths;t&&r&&(r.shellcore+=".js?odb_cb="+(new Date).toISOString()),C.e.addConfig(a.requireConfig),n._requestShellCore().then(function(t){e.complete(t)},function(t){(t=H({error:t}))&&"RequireError"===t.resultCode&&n._isDataFromCache?(I.e.logData({name:"SuiteNavProvider.O365ShellCacheFailed"}),n._getSuiteNavShell(e)):n._hasRetriedShell?e.error(t):(n._hasRetriedShell=!0,n._cssLoaded=!1,I.e.logData({name:"SuiteNavProvider.O365ShellRetry"}),n._getSuiteNavShell(e,!0))})})},e.prototype._requestShellCore=function(){var e=this,t=new a.e,n=requirejs.toUrl("shellcore");return window.require(["shellcore"],function(){!function(){var e=window._o365su;if(e&&e.b)for(var t=0,n=["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"];t<n.length;t++){var a=n[t];F(e.b,a)}}();var e=new _;e.Exists()?t.complete(e):t.error(H({error:{message:"O365Shell not defined after require() succeeded"},resultCode:"O365ShellNotDefined",extraData:{shellUrl:n}}))},function(a){e._capabilities.supportsCaching&&P(),requirejs.undef("shellcore"),e._modelPromise=void 0,t.error(H({error:a,resultCode:"RequireError",extraData:{shellUrl:n}}))}),t.getPromise()},e.prototype._loadModel=function(e){var t=this;if(!e&&this._modelPromise)return this._modelPromise;var n,a,o=this._capabilities.supportsCaching,s=this._dataSource,c=x.t.Failure,d=x.e.instrumentPromise({name:"SuiteNavProvider.LoadData"},function(){return new S.n(function(a,d){var l,u,f;!e&&o&&t._isCacheValid()&&(l=L.getValue(O)),l&&l.data?(I.e.logData({name:"SuiteNavProvider.DataFromCache"}),s.updateDataForCurrentPage&&s.updateDataForCurrentPage(l.data),o&&(u=L.getValue(A,r.e.session),f=Date.parse(L.getValue(w)),i.e.hasStorageType(r.e.session)&&!u||Date.now()-f>=432e5)&&(I.e.logData({name:"SuiteNavProvider.RefreshCache"}),s.loadData().done(U)),t._isDataFromCache=!0,a(l)):(t._isDataFromCache=!1,e&&I.e.logData({name:"SuiteNavProvider.ForceUpdateData"}),I.e.logData({name:"SuiteNavProvider.DataFromServer"}),s.loadData(e).done(function(e){e?e.data?(o&&!T(e)&&U(e),a(e)):(n="NoModelData",d("Model with no data returned")):(n="NoModel",d("No model returned"))},function(e){S.n.isCanceled(d)?(n="Canceled",c=x.t.ExpectedFailure):n="ServerLoadFailure",d(e)}))})},null,function(e){return S.n.isCanceled(e)&&(c=x.t.ExpectedFailure,n="Canceled"),{resultType:c,resultCode:n||"Other",error:e}});return(a=Object(y.e)())?this._modelPromise=S.n.all({suiteNavModel:d,theme:a.loadThemeSlotsMap()}).then(function(e){var t=e.suiteNavModel,n=e.theme,a=t&&t.data,i=t&&t.hasCobranding,r=a&&a.UseSPOBehaviors,o=Object(v.isFeatureEnabled)(v.SuiteNavPrefersTenantTheme),s=n&&n.suiteBarBackground;return!(s&&a&&r)||i&&o||(a.ThemeColors=[s,n.primaryText,s,n.suiteBarText,n.suiteBarDisabledText,n.topBarBackground,n.topBarText,n.topBarHoverText,n.primaryBackground,n.themeLighterAlt,n.dialogBorder]),t}):this._modelPromise=d,this._modelPromise},e.prototype._isCacheValid=function(){var e=L.getValue(O),t=L.getValue(E),n=Date.parse(L.getValue(w)),a=this._capabilities.supportsRealSuiteNav,i=this._dataSource,r=e&&e.data&&(!a||e.requireConfig)&&5===t&&e.userIdentifier===i.getUserIdentifier()&&e.cacheToken===i.getCacheToken()&&!isNaN(n)&&Date.now()-n<864e5;if(!r){var o={model:!!e,"model.data":e&&!!e.data,"model.requireConfig":e&&!!e.requireConfig,supportsRealSuiteNav:a,oldVersion:t,CACHE_VERSION:5,userIsIdentical:e&&e.userIdentifier===i.getUserIdentifier(),cacheToken:e&&e.cacheToken,dataSourceCacheToken:i.getCacheToken(),cacheDate:!isNaN(n),expired:Date.now()-n>=864e5};I.e.logData({name:"SuiteNavCacheDataInvalid",extraData:o})}return r},e}(),M=(t.default=k,Object(v.isFeatureEnabled)(v.UnifiedSuiteNavComponent)?Object(o.r)("SuiteNavProvider",s.e,{dataSource:g.e}):Object(o.r)("SuiteNavProvider",k,{dataSource:b.ue}));function P(){L.remove(O),L.remove(w),L.remove(E),L.remove(A,r.e.session)}function T(e){var t=e&&e.data&&e.data.WorkloadLinks;return!!t&&t.some(function(e){return e&&!e.Url})}function U(e){L.setValue(O,e),L.setValue(w,new Date),L.setValue(E,5),L.setValue(A,!0,r.e.session)}function F(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];try{return n.apply(this,e)}catch(e){c.e.logData({message:e&&e.message||"",stack:e&&e.stack||"",type:t})}})}function H(e){var t=e.error;if(t&&t.resultCode)return t;var n=x.t.Failure;return S.n.isCanceled(t)&&(n=x.t.ExpectedFailure,e.resultCode="Canceled"),{resultType:n,resultCode:e.resultCode||"Other",error:t,extraData:e.extraData}}},2150:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return H});var a,i=n(0),r=n(15),o=n(8),s=n(41),c=n(9),d=n(125),l=n(509),u=n(2300),f=function(){var e,t,n;return a||(a=null===(n=null===(t=null===(e=window.mssearchux)||void 0===e?void 0:e.header)||void 0===t?void 0:t.getInstrumenter)||void 0===n?void 0:n.call(t)),a},p=function(e,t){var n,a,i=t||_(),r=e||h().activeScopeId;try{for(var o=Object(u.s)(i||[]),s=o.next();!s.done;s=o.next()){var c=s.value;if(c.id===r)return c}}catch(e){n={error:e}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}},m=function(e,t){var n;t&&(a=t);var i=f();i&&i.setProps({hostAppInfo:Object(u.e)(Object(u.e)({},i.props.hostAppInfo),{scopeId:null===(n=p(e.activeScopeId,e.scopes))||void 0===n?void 0:n.searchBoxScopeId}),scopingControl:Object(u.e)({},e)})},_=function(){var e;return null===(e=h())||void 0===e?void 0:e.scopes},h=function(){var e;return null===(e=f())||void 0===e?void 0:e.props.scopingControl},b=n(39),g=n(1474),v=n(4141),y=n(4140),S=n(446),D=(n(229),n(1467)),I={id:"spListFolder",name:D.t},x={id:"spList",name:D.r},C={id:"spDocLibFolder",name:D.t},O={id:"spDocLib",name:D.i};D.o,D.a,D.e,D.n,D.D;var w,E=n(660),A=n(3),L=n(213),k=n(211),M=n(13),P=n(805),T=n(4280),U="AdvancedSearchButton",F=function(){function e(e,t){this._isConfigured=!1,this._resources=t.resources,this._engagement=t.engagement,this._searchBoxDataSource=t.searchBoxDataSource,this._config=t.searchBoxConfig,this._scope=new l.e,this._getViewParams=function(){throw new Error("Search box not configured")},this._isLastPageSearch=!1,this._searchInstrumenter=this._config.getInstrumenter(),this._scopingControlDataSource=t.scopingControlDataSource,this._metadataSearchDataSource=t.metadataSearchDataSource,this._bootOptions=t.bootOptions,this._teachingBubbleProvider=t.teachingBubbleProvider}return e.prototype.configureSearchBox=function(e){var t=this;if(this._config.isEnabled()){var n=new s.e({name:"SuiteNavSearchBox.Configure"});this._getViewParams=e,this._isLastPageSearch=this._searchBoxDataSource.isSearchResultsPage(),this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){e.getO365Shell().then(function(e){e.OnHasMember("Search",function(){var a,r,c,d,l=e.Search;Object(A.Ho)(A.Da)&&!(null===(a=t._metadataSearchDataSource)||void 0===a?void 0:a.isMetadataSearchResultPage(t._getViewParams()))||l.SetSearchText(t._config.getSearchText()),l.SetPlaceholderText(t._config.getPlaceholderText()),l.SetTokenProviders(t._searchBoxDataSource.getTokenProviders());var u=l.OnSubmitSearch(t._onSubmitSearchCallback.bind(t)),f=l.OnSearchBoxActivated(t._onSearchBoxActivatedCallback.bind(t)),p=l.OnSearchBoxDeactivated(t._onSearchBoxDeactivatedCallback.bind(t));t._trackHandler(u,l.RemoveOnSubmitSearch),t._trackHandler(f,l.RemoveOnSearchBoxActivated),t._trackHandler(p,l.RemoveOnSearchBoxDeactivated);var m,_=l.OnExitSearch(t._onExitSearchCallback.bind(t));t._trackHandler(_,l.RemoveOnExitSearch),t._searchBoxDataSource.getProviderConfigUpdaters&&l.SetProviderConfigUpdaters(t._searchBoxDataSource.getProviderConfigUpdaters(null===(r=t._scopingControlDataSource)||void 0===r?void 0:r.getActiveScope.bind(t._scopingControlDataSource),t._getViewParams)),(Object(A.Ho)(A.Da)||Object(A.Ho)(A.Ua))&&(t._shouldDisableSetSearchBoxSettingsInChromeless()&&(null===(c=t._bootOptions)||void 0===c?void 0:c.chromeless)&&!(null===(d=t._bootOptions)||void 0===d?void 0:d.isListHome)&&!t.shouldSetSearchBoxSettings(l)||l.SetSearchBoxSettings(Object(i.__assign)({cache:void 0,instrumenter:t._config.getInstrumenter(),tokenProviders:t._config.getTokenProviders()},o.t.isActivated("8852ae00-f7e0-4a74-bf2e-f5f33e61fde7","09/30/2020","[stvikenv] Specify search box loading pattern in SetSearchBoxSettings in odsp-next.")?{}:{loadingPattern:(w||(w=L.n.isFeatureEnabled({ODB:1804})||(m=window._spPageContextInfo)&&!M.e.isActivated("1166a987-eb1e-4f42-baf6-46d50b7fc0c4","09/30/2020","[stvikenv] Activate this kill switch to pause experiment 90065 - using the PFP loading pattern in the search box.")&&1===Object(k.n)(90065,m)?"pfp":"eager"),w)}))),t._updateSearchInstrumenter(),n.end({resultType:s.t.Success})})}).catch(function(e){n.end({resultType:s.t.Failure,error:e.message,resultCode:"getO365ShellError"})})}).catch(function(e){n.end({resultType:s.t.Failure,error:e.message,resultCode:"getSuiteNavProviderError"})}),this._updateSearchInstrumenter(),this._isConfigured=!0}},e.prototype.updateSearchBoxConfiguration=function(e,t){var n,a,i,c,d;null===(a=(n=this._searchBoxDataSource).setIsPrimedLibrary)||void 0===a||a.call(n,t),!o.t.isActivated("aa2a6471-d9a3-4277-8151-55fd6b5b4b27","11/18/2022","set isGenericList")&&e&&(null===(c=(i=this._searchBoxDataSource).setIsGenericList)||void 0===c||c.call(i,Object(r.o)(e))),this._listTemplate=e,this._isMetadataSearchSupported=this._isMetadataSearchSupportedTemplate(this._listTemplate);var l=new s.e({name:"SuiteNavSearchBox.UpdateSearchBoxConfiguration"});if(this._isConfigured)try{this._resetSearchBoxText(),this._updateSearchInstrumenter(),l.end({resultType:s.t.Success})}catch(e){l.end({resultType:s.t.Failure,error:e,resultCode:"RuntimeError"})}else l.end({resultType:s.t.Failure,resultCode:"SearchBoxNotInitialized"});null===(d=this._removeTeachingBubble)||void 0===d||d.call(this)},e.prototype.dispose=function(){this._scope.dispose()},e.prototype._shouldDisableSetSearchBoxSettingsInChromeless=function(){return!o.t.isActivated("4385e4cc-3ff4-4707-a6b7-ca36740100a0","2020/11/12","Disable SetSearchBoxSettings when chromeless")},e.prototype._isMetadataSearchSupportedTemplate=function(e){var t;if(!this._metadataSearchDataSource)return!1;var n=!!e&&!Object(r.o)(e);return Object(A.Ho)(A.I)?(n=!0,this._metadataSearchDataSource.isList=!!e&&Object(r.o)(e)):n=n||(null===(t=this._metadataSearchDataSource)||void 0===t?void 0:t.isMetadataSearchResultPage(this._getViewParams())),n},e.prototype.shouldSetSearchBoxSettings=function(e){var t=e.GetSearchBoxSettings();return!(null==t?void 0:t.instrumenter)},e.prototype._runInShellSearch=function(e){return this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){return e.getO365Shell()}).then(function(t){t.OnHasMember("Search",function(){return e(t.Search)})})},e.prototype._resetSearchBoxText=function(e){var t=this,n=this._searchBoxDataSource.isSearchResultsPage(),a=Object(A.Ho)(A.Da);this._config.isEnabled()&&this._runInShellSearch(function(e){(!a||n||t._isLastPageSearch)&&e.SetSearchText(t._config.getSearchText()),e.SetPlaceholderText(t._config.getPlaceholderText()),t._isLastPageSearch=n})},e.prototype._trackHandler=function(e,t){this._scope.attach({dispose:function(){return t(e)}})},e.prototype._onSubmitSearchCallback=function(e,t,n){var a,i,r,o=this._getViewParams();this._searchBoxDataSource.isSearchResultsPage()||(this._viewParamsBeforeSearch=o,this._urlBeforeSearch=window.location.href),this._isScopeControlSupported()&&(r=this._scopingControlDataSource.getScopeControlScenario(this._scopingControlDataSource.getInitialScope(),this._searchBoxDataSource.isSearchResultsPage()),i=this._scopingControlDataSource.getActiveScope()),this._engagement.logData({name:"SuiteNavSearchBox.Click",isIntentional:!0,extraData:{trigger:n?"ScopingControl":"SubmitSearch",targetScope:null==i?void 0:i.id},scenario:r,privacyClassification:b.t.optionalDiagnostic}),this._searchBoxDataSource.onSubmitSearchCallback(e,this._getViewParams,null===(a=this._scopingControlDataSource)||void 0===a?void 0:a.getActiveScope(),this._urlBeforeSearch,n),this._endQos("Click")},e.prototype._onExitMetadataSearchCallback=function(){var e,t,n=this;if(null===(e=this._metadataSearchDataSource)||void 0===e?void 0:e.isMetadataSearchMode){this._metadataSearchDataSource.isMetadataSearchMode=!1;var a=null===(t=this._scopingControlDataSource)||void 0===t?void 0:t.getActiveScope.bind(this._scopingControlDataSource);this._runInShellSearch(function(e){e.SetProviderConfigUpdaters(n._searchBoxDataSource.getProviderConfigUpdaters(a,n._getViewParams)),n._updateSearchInstrumenter()})}},e.prototype._onExitSearchCallback=function(){this._searchBoxDataSource.onExitSearchCallback&&(this._searchBoxDataSource.isSearchResultsPage()&&(this._engagement.logData({name:"SuiteNavSearchBox.ExitSearch",isIntentional:!0}),this._searchBoxDataSource.onExitSearchCallback(this._viewParamsBeforeSearch)),this._onExitMetadataSearchCallback())},e.prototype._onSearchBoxActivatedCallback=function(){var e,t,n;this._isScopeControlSupported()&&(n=this._scopingControlDataSource.getScopeControlScenario(this._scopingControlDataSource.getInitialScope(),this._searchBoxDataSource.isSearchResultsPage())),this._engagement.logData({name:"SuiteNavSearchBox.FocusIn",isIntentional:!0,scenario:n,privacyClassification:b.t.optionalDiagnostic,extraData:{isMetadataSearchAvailable:!!this._metadataSearchDataSource}}),this._startQos(),null===(e=this._metadataSearchDataSource)||void 0===e||e.getSiteColumns(),Object(A.Ho)(A.S)&&(null===(t=this._metadataSearchDataSource)||void 0===t?void 0:t.shouldShowDiscoveryFRE())&&this._runContentQueryDiscoveryFRE()},e.prototype._runContentQueryDiscoveryFRE=function(){var e=this,t=document.querySelector("#".concat(U));this._metadataSearchDataSource&&t&&n.e(573).then(n.bind(null,4586)).then(function(a){e._teachingBubbleProvider.shouldBubbleBeAdded(a.DISCOVERY_TEACHING_BUBBLE_CAMPAIGN,!1).then(function(i){i?Promise.all([n.e("ondemand.resx-ondemand"),n.e(793)]).then(n.bind(null,5626)).then(function(n){n.showContentQueryDiscoveryTeachingBubble(t,function(){e._openMetadataSearchForm(),e._engagement.logData({name:a.DISCOVERY_TEACHING_BUBBLE_OPENFORM_ENGAGEMENT})},function(){e._engagement.logData({name:a.DISCOVERY_TEACHING_BUBBLE_DISMISSED_ENGAGEMENT})}),e._teachingBubbleProvider.markBubbleAsSeen(a.DISCOVERY_TEACHING_BUBBLE_CAMPAIGN),e._removeTeachingBubble=n.removeMetadataSearchTeachingBubble,e._engagement.logData({name:a.DISCOVERY_TEACHING_BUBBLE_SHOWN_ENGAGEMENT})}):a.shouldShowSecondaryDiscoveryTeachingBubble()&&e._teachingBubbleProvider.shouldBubbleBeAdded(a.DISCOVERY_TEACHING_BUBBLE_SECONDARY_CAMPAIGN,!1).then(function(i){i&&Promise.all([n.e("ondemand.resx-ondemand"),n.e(625)]).then(n.bind(null,5336)).then(function(n){n.runContentQueryDiscoverySecondaryTeachingBubble(t,function(){e._engagement.logData({name:a.DISCOVERY_SECONDARY_TEACHING_BUBBLE_DISMISSED_ENGAGEMENT})}),e._teachingBubbleProvider.markBubbleAsSeen(a.DISCOVERY_TEACHING_BUBBLE_SECONDARY_CAMPAIGN),e._removeTeachingBubble=n.removeMetadataSearchTeachingBubble,e._engagement.logData({name:a.DISCOVERY_SECONDARY_TEACHING_BUBBLE_SHOWN_ENGAGEMENT})})})})})},e.prototype._onSearchBoxDeactivatedCallback=function(){this._engagement.logData({name:"SuiteNavSearchBox.FocusOut",isIntentional:!0,privacyClassification:b.t.optionalDiagnostic}),this._endQos("FocusOut")},e.prototype._startQos=function(){this._currentQosEvent&&this._currentQosEvent.end({resultType:s.t.Failure}),this._currentQosEvent=new s.e({name:"SuiteNavSearchBox.Usage"})},e.prototype._endQos=function(e){this._currentQosEvent&&(this._currentQosEvent.end({resultType:s.t.Success,resultCode:e}),this._currentQosEvent=void 0)},e.prototype._updateSearchInstrumenter=function(){if(this._triggerSearchBoxReconfiguration(),this._isScopeControlSupported()){m(this._getScopingControlConfig(),this._searchInstrumenter);var e=this._scopingControlDataSource.getInitialScope();this._scopingControlDataSource.setActiveScope(e)}this._setSearchInstrumenterProps(),this._configureMetadataSearch()},e.prototype._isScopeControlSupported=function(){return!!this._scopingControlDataSource&&this._scopingControlDataSource.isScopingControlEnabled()},e.prototype._isMetadataSearchSupportedScope=function(e){var t=e||O,n=t===O||t===C,a=t===x||t===I;return Object(A.Ho)(A.I)?n||a:n},e.prototype._getScopingControlConfig=function(){var e=this;if(!this._isScopeControlSupported())throw new Error("Scoping control is not supported.");return{scopes:this._scopingControlDataSource.getAvailableScopes(),activeScopeId:this._scopingControlDataSource.getInitialScope().id,onChange:function(t,n){e._scopingControlDataSource.setActiveScope(n),e._triggerSearchBoxReconfiguration();var a=!!t&&e._searchBoxDataSource.isSearchResultsPage();e._logScopeChange(n,a),a?e._onSubmitSearchCallback(t,void 0,!0):e._setFocusSearchBox(),e._metadataSearchDataSource&&e._updateMetadataSearchConfiguration()}}},e.prototype._hideScopingControl=function(){this._searchInstrumenter.setProps({scopingControl:Object(i.__assign)(Object(i.__assign)({},this._searchInstrumenter.props.scopingControl),{activeScopeId:void 0,scopes:void 0})})},e.prototype._configureMetadataSearch=function(){var e=this;this._metadataSearchDataSource&&(this._metadataSearchDataSource.updateMetadataSearchConfig=function(t){e._metadataSearchDataSource.isMetadataSearchMode=e._metadataSearchDataSource.isMetadataSearchResultPage(e._getViewParams())||t,e._updateMetadataSearchConfiguration(),e._metadataSearchDataSource.isMetadataSearchMode?t&&e._setFocusSearchBox():e._isScopeControlSupported()&&m(e._getScopingControlConfig(),e._searchInstrumenter)},this._metadataSearchDataSource.isMetadataSearchMode=this._metadataSearchDataSource.isMetadataSearchResultPage(this._getViewParams()),this._updateMetadataSearchConfiguration())},e.prototype._hideMetadataSearchButton=function(){var e;null===(e=this._searchInstrumenter)||void 0===e||e.setProps({filterButtonConfig:void 0})},e.prototype._showMetadataSearchButton=function(){var e,t=this;null===(e=this._searchInstrumenter)||void 0===e||e.setProps({filterButtonConfig:{id:U,onClick:function(e){var n,a,i=e||window.event;i?(i.preventDefault(),t._teachingBubbleProvider&&!Object(A.Ho)(A.S)?t._showMetadataSearchTeachingBubble(i):(null===(n=t._removeTeachingBubble)||void 0===n||n.call(t),t._openMetadataSearchForm(i.type))):(null===(a=t._removeTeachingBubble)||void 0===a||a.call(t),t._openMetadataSearchForm())},ariaLabel:D.d,title:D.d}})},e.prototype._showMetadataSearchTeachingBubble=function(e){var t=this,a=e.target,i=e.type;Promise.all([n.e("ondemand.resx-ondemand"),n.e(625)]).then(n.bind(null,5336)).then(function(e){var n={campaignGuid:"b8ceb79a-73e5-4e1d-8df8-27dedb514597",flag:{Fallback:!0}},r=new s.e({name:"SearchBox.ShowMetadataSearchTeachingBubble"});t._teachingBubbleProvider.shouldBubbleBeAdded(n,!1).then(function(o){if(o){var c={isVisible:o,onDismiss:function(){t._teachingBubbleProvider.markBubbleAsDismissed(n),t._openMetadataSearchForm(i)},target:a,listTemplate:t._listTemplate};e.showMetadataSearchTeachingBubble(c),t._teachingBubbleProvider.markBubbleAsSeen(n),r.end({resultType:s.t.Success})}else e.removeMetadataSearchTeachingBubble(),t._openMetadataSearchForm(i),r.end({resultType:s.t.Success,resultCode:"AlreadyShowed"})}).catch(function(n){e.removeMetadataSearchTeachingBubble(),t._openMetadataSearchForm(i),r.end({resultType:s.t.Failure,error:n.message})})}).catch(function(){t._openMetadataSearchForm(i)})},e.prototype._openMetadataSearchForm=function(e){var t,n,a=this;if(this._metadataSearchDataSource&&(this._metadataSearchDataSource.isMetadataSearchMode=!0,this._updateMetadataSearchConfiguration(),this._setFocusSearchBox(),"keydown"===e&&setTimeout(function(){return a._setFocusSearchBox()},0),void 0===this._metadataSearchDataSource.showQueryableFieldMenuTeachingBubble&&Object(A.Ho)(A.S)&&(null===(t=this._metadataSearchDataSource)||void 0===t?void 0:t.shouldShowDiscoveryFRE()))){var i={campaignGuid:"6f376cef-52b4-4abc-b6e9-aca8686e5220",flag:{Fallback:!0},isDismissable:!0};null===(n=this._teachingBubbleProvider)||void 0===n||n.shouldBubbleBeAdded(i,!1).then(function(e){a._metadataSearchDataSource.showQueryableFieldMenuTeachingBubble=e,a._metadataSearchDataSource.markQueryableFieldMenuTeachingBubbleAsSeen=function(){var e;null===(e=a._teachingBubbleProvider)||void 0===e||e.markBubbleAsSeen(i),a._metadataSearchDataSource.showQueryableFieldMenuTeachingBubble=!1}})}},e.prototype._updateMetadataSearchConfiguration=function(){var e,t,n=this,a=null===(e=this._scopingControlDataSource)||void 0===e?void 0:e.getActiveScope(),i=null===(t=this._scopingControlDataSource)||void 0===t?void 0:t.getActiveScope.bind(this._scopingControlDataSource),r=this._isMetadataSearchSupportedScope(a),o=this._isMetadataSearchSupported&&r;this._runInShellSearch(function(e){e.SetProviderConfigUpdaters(n._searchBoxDataSource.getProviderConfigUpdaters(i,n._getViewParams))}),o?this._metadataSearchDataSource.isMetadataSearchMode?(this._hideScopingControl(),this._hideMetadataSearchButton()):this._searchBoxDataSource.isSearchResultsPage()?this._hideMetadataSearchButton():this._showMetadataSearchButton():this._hideMetadataSearchButton()},e.prototype._setFocusSearchBox=function(){this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){e.getO365Shell().then(function(e){e.Search.FocusSearchBox()})})},e.prototype._setSearchInstrumenterProps=function(){this._searchBoxDataSource.getSearchInstrumenterProps&&this._searchInstrumenter&&this._searchInstrumenter.setProps(this._searchBoxDataSource.getSearchInstrumenterProps())},e.prototype._triggerSearchBoxReconfiguration=function(){this._runInShellSearch(function(e){return e.RecomputeSearchBoxConfiguration()})},e.prototype._logScopeChange=function(e,t){if(!this._scopingControlDataSource)throw new Error("Scoping control is not supported.");var n=this._scopingControlDataSource.getInitialScope(),a=this._scopingControlDataSource.getScopeControlScenario(n,this._searchBoxDataSource.isSearchResultsPage());this._engagement.logData({name:"SuiteNavSearchBox.ScopeChanged",isIntentional:!0,scenario:a,extraData:{initialScope:n.id,targetScope:e.id,searchTriggered:t},privacyClassification:b.t.optionalDiagnostic})},e.dependencies={resources:c.r,engagement:E.e,searchBoxDataSource:y.e,searchBoxConfig:g.e,scopingControlDataSource:v.e.optional,metadataSearchDataSource:T.e.optional,bootOptions:P.e.optional,teachingBubbleProvider:S.I.optional},e}(),H=(t.default=F,Object(d.r)("SearchBoxProvider",F))},2288:function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(a.__extends)(t,e),t}(n(2526).e);t.e=i},2300:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"r",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"i",function(){return d}),n.d(t,"s",function(){return l}),n.d(t,"o",function(){return u});var a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)};function i(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function o(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}function s(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}function c(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})}function d(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}function l(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],a=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a}},2482:function(e,t,n){"use strict";n.d(t,"c",function(){return y}),n.d(t,"d",function(){return D}),n.d(t,"a",function(){return x}),n.d(t,"i",function(){return C}),n.d(t,"t",function(){return w}),n.d(t,"o",function(){return E}),n.d(t,"s",function(){return A});var a,i,r,o,s,c=n(894),d=n(2288),l=n(129),u=n(2048);n.d(t,"e",function(){return u.e}),n.d(t,"n",function(){return u.t}),n.d(t,"r",function(){return u.n}),n.d(t,"l",function(){return u.a}),n.d(t,"u",function(){return u.i}),n.d(t,"f",function(){return u.r});var f="ms-word",p="onenote|UsePlain",m="ms-powerpoint",_="ms-excel",h="ms-visio",b="ms-publisher",g="ms-project",v=((a={})[f]=l.OpenInWordOnline,a[p]=l.OpenInOneNoteOnline,a[m]=l.OpenInPowerPointOnline,a[_]=l.OpenInExcelOnline,a[h]=l.OpenInVisioOnline,a);function y(e){return v[e]||""}var S=((i={})[f]=l.OpenInWord,i[p]=l.OpenInOneNote,i[m]=l.OpenInPowerPoint,i[_]=l.OpenInExcel,i[h]=l.OpenInVisio,i[b]=l.OpenInPublisher,i[g]=l.OpenInProject,i["ms-infopath"]=l.OpenInInfoPath,i);function D(e){return S[e]}var I=((r={})[f]="Word",r[p]="OneNote",r[m]="PowerPoint",r[g]="Project",r[h]="Visio",r[_]="Excel",r);function x(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":I[e.appMap]||"Word"}function C(e){return I[e]}(o={})[f]="WordLogo",o[p]="OneNoteLogo",o[m]="PowerPointLogo",o[_]="ExcelLogo",o[h]="VisioLogo",o[b]="Page";var O=((s={})[f]="svg/word_16x1.svg",s[p]="svg/onenote_16x1.svg",s[m]="svg/powerpoint_16x1.svg",s[_]="svg/excel_16x1.svg",s[h]="svg/visio_16x1.svg",s[b]="Page",s.Stream="svg/stream_16x1.svg",s),w={"svg/word_16x1.svg":"svg/word_white_stroke_18x1.svg","svg/onenote_16x1.svg":"svg/onenote_white_stroke_18x1.svg","svg/powerpoint_16x1.svg":"svg/powerpoint_white_stroke_18x1.svg","svg/excel_16x1.svg":"svg/excel_white_stroke_18x1.svg","svg/visio_16x1.svg":"svg/visio_white_stroke_18x1.svg"};function E(e){var t=O[e];return t&&new d.e(t)}function A(e){var t=c.e;return-1!==t["ms-word"].lastIndexOf(e)?"ms-word":-1!==t["ms-powerpoint"].lastIndexOf(e)?"ms-powerpoint":-1!==t["ms-excel"].lastIndexOf(e)?"ms-excel":-1!==t["ms-visio"].lastIndexOf(e)?"ms-visio":-1!==t["onenote|UsePlain"].lastIndexOf(e)?"onenote|UsePlain":-1!==t["ms-access"].lastIndexOf(e)?"ms-access":-1!==t["ms-project"].lastIndexOf(e)?"ms-project":-1!==t["ms-publisher"].lastIndexOf(e)?"ms-publisher":void 0}},2526:function(e,t,n){"use strict";var a=n(25),i=function(){function e(e,t){this.value=e,this.extraClasses=t}return e.prototype.getClass=function(){var e=this.value?Object(a.w)(this.value):void 0;return"ms-Icon ms-Icon--".concat(this.value," ").concat(e||"").concat(this.extraClasses?" "+this.extraClasses:"")},e.prototype.getExtraClasses=function(){return this.extraClasses},e.prototype.toString=function(){return this.value},e}();t.e=i},3313:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(9).t)("searchUpscopeProvider")},3562:function(e,t,n){"use strict";function a(e){return e.indexOf("&web=1")>=0||e.indexOf("?web=1")>=0?e:e.indexOf("?")>=0?"".concat(e,"&web=1"):"".concat(e,"?web=1")}n.d(t,"e",function(){return a})},3659:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(3788),r=n(130),o=n(125),s=n(1578),c=Object(o.o)("SuiteNavDataSourceV2",i.e,Object(a.__assign)({pageContext:r.e},{prefetchCache:s.e.optional}))},3767:function(e,t,n){"use strict";function a(e,t,n){switch(n){case"odbMyFiles":case"odbAllFiles":return e;case"spDocLib":return t.serverRelativeListUrl;case"spSiteSite":return t.normalizedItemUrl.replace("/".concat(t.webRelativeItemUrl),"");default:return}}n.d(t,"e",function(){return a})},3996:function(e,t,n){"use strict";n.d(t,"n",function(){return b}),n.d(t,"t",function(){return g}),n.d(t,"e",function(){return v});var a=n(0),i=n(15),r=n(179),o=n(662),s=n(2507),c=n(10),d=n(9),l=n(125),u=new d.t({name:"ShortcutProvider.key",loader:new l.t(function(){return n.e(402).then(n.bind(null,2574)).then(function(e){return e.resourceKey})})}),f=n(3),p=n(2482),m=n(13),_=n(3562),h=m.e.isActivated("0052871b-1ac0-4b44-8c3d-e516d035bcba","1/17/2023","Remove list from search box dataSource dependency");function b(e){var t,n="one"===e.fileExtension||-1!==(null===(t=e.url)||void 0===t?void 0:t.toLowerCase().indexOf("/doc.aspx?"));return!!e.fileType&&"folder"===e.fileType.toLowerCase()&&!S(e)&&!n}function g(e,t,n,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n.engagement.logData({name:"InlineResult.Search.Click",isIntentional:!0}),t.onClick&&t.onClick(e),function(e){var t=e.fileExtension,n=e.fileType;return void 0===t&&"File"===n}(t)&&function(e,t){e.preventDefault(),e.stopPropagation(),window.open(t,"_blank")}(e,t.url),b(t)?(function(e,t,n){var a;e.preventDefault(),e.stopPropagation(),!n.pageContext.listUrl||function(e,t){return e.indexOf(t)>-1}(t.url,n.pageContext.listUrl)||(a=t.url.substring(0,t.url.lastIndexOf("/"))),n.navigation.updateViewParams(v(t.url,!0,a),{clearOtherParams:!0})}(e,t,n),[3,3]):[3,1];case 1:return!function(e,t,n){return!(!e.url||(r=e.url,!m.e.isActivated("31d4a0b9-e9f7-4b89-a452-b27b0222793d")&&-1!==r.indexOf("/_layouts/15/"))||function(e,t,n){return(h?!!e&&!!e.listTemplateType&&Object(i.o)(e.listTemplateType):!!n)&&t.url.toLowerCase().indexOf("dispform.aspx")>=0}(t.listContext,e,n)||function(e){return("aspx"===e.fileExtension||!e.fileExtension)&&e.url.toLowerCase().indexOf(".aspx")>=0}(e)||(a=e.fileExtension,a&&Object(p.s)(a.toLowerCase()))||S(e));var a,r}(t,n,r)||(l=(d=t.url).indexOf("?")>-1?Object(o.e)(d.substring(d.indexOf("?")+1)):void 0)&&l[c.n.idParamKey]&&l[c.n.parentIdParamKey]?[3,3]:(e.preventDefault(),e.stopPropagation(),[4,y(t,n.resources)]);case 2:s=a.sent(),window.open(s,"_blank"),a.label=3;case 3:return[2]}var d,l})})}function v(e,t,n){var a={},i=new r.e(e),o=i.path.indexOf("?"),s=i.path.substring(0,-1!==o?o:i.path.length);return a[c.n.idParamKey]=s,n&&(a[c.n.listUrlKey]=n),t||(a[c.n.parentIdParamKey]=s.substring(0,s.lastIndexOf("/"))),a}function y(e,t){return e.sPWebUrl&&Object(f.Ho)(f.ji)&&s.e.isShortcutFileType(e.fileExtension)?function(e,t,n){return n.consumeAsync(u).then(function(n){return n.getShortcutTargetData(e,!0,void 0,t).then(function(e){return e.isInternal?Object(_.e)(e.url):e.url})})}(e.url,e.sPWebUrl,t).then(function(e){return e}):Promise.resolve(Object(_.e)(e.url))}function S(e){return e.url.toLowerCase().indexOf("docsethome.aspx")>=0}},4140:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(9).t)("searchBoxDataSource")},4141:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(9).t)("scopingControlDataSource")},4212:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(1635),i=n(125),r=n(51),o=Object(i.r)("PageContextEngagementHandler",a.e,{pageContext:r.p})},4395:function(e,t,n){"use strict";n.r(t),n.d(t,"SuiteNavDataUpdater",function(){return O}),n.d(t,"resourceKey",function(){return w});var a=n(0),i=n(4462),r=n(1442),o=n(3788),s=n(229),c=n(1475),d=n(125),l=n(9),u=n(51),f=n(15),p=n(37),m=n(13),_=n(104),h=n(35),b=n(156),g=n(112),v=n(355),y=n(1481),S=n(4461),D=n(1143),I=n(1290),x=Object(h.isFeatureEnabled)(h.DocumentSettingPanel),C=m.e.isActivated("55d7c666-d509-4231-9bd7-fd3e8f76384d","05/25/2022","Use unique link id for list settings"),O=function(){function e(e,t){this._resources=t.resources,this._pageContext=this._resources?this._resources.consume(u.p):t.pageContext}return e.prototype.updateSuiteNavData=function(e){var t,o=this,c=Object(a.__assign)({},e.suiteNavData);this._suiteNavContext=e.suiteNavContext;var d=this._pageContext.isSPO;this._isODB=Number(this._pageContext.webTemplate)===_.t.mySite,c.CurrentMainLinkElementID=this._suiteNavContext.currentMainLinkElementID||this._suiteNavContext.workloadId,c.ActionsMap={};var l=this._resources?this._resources.consume(y.e.optional):void 0;l&&l.set(!!c.AdminLink);var u=this._resources?this._resources.consume(y.t.optional):void 0;if(u)for(var p=0,b=Object(a.__spreadArray)(Object(a.__spreadArray)([],c.AppsLinks||[],!0),c.WorkloadLinks||[],!0);p<b.length;p++){var C=b[p];if("ShellSites"===C.Id){u.set(C.Url||"");break}}if(d&&this._pageContext.isAnonymousGuestUser)try{var O={Text:this._pageContext.userDisplayName||c.UserDisplayName||"",Url:null},w=JSON.parse(c.ClientData);w.SignInLink=O,c.ClientData=JSON.stringify(w),c.SignOutLink=null,c.AboutMeLink=null,c.IsAuthenticated=!1,c.O365SettingsLink=null,c.UserDisplayName=null}catch(e){}else{if(c.ActionsMap[r.e.SIGN_OUT]=function(){g.e.logData({name:"SuiteNav.SignOut.Click"});try{delete localStorage["onedrive.autoredirect"]}catch(e){}return!0},d&&this._pageContext.isEmailAuthenticationGuestUser)c.CurrentWorkloadSettingsSubLinks=null,c.LogoNavigationUrl=null;else if(!m.e.isActivated("f8d47155-9b9a-4663-9477-800f8da227fa","02/11/2022","Remove links from Stream settings")&&(m.e.isActivated("a7eb44e0-dbbe-46e1-8c95-88cdab4c07d4","04/29/2022","Use SuiteNavLinkId to identify Stream")?(null===(t=this._pageContext.serverRequestPath)||void 0===t?void 0:t.indexOf("stream.aspx"))>=0:c.CurrentMainLinkElementID===r.e.STREAM))c.CurrentWorkloadSettingsSubLinks=null;else if(c.CurrentMainLinkElementID===r.e.CLIPCHAMP)c.CurrentWorkloadSettingsSubLinks=null,Object(h.isFeatureEnabled)(h.EnableClipchampFileABug)&&(c.CurrentWorkloadHelpSubLinks=[{Id:r.e.FEEDBACK,Text:"File a bug",TargetWindow:"_blank",Url:"https://onedrive.visualstudio.com/Clipchamp/_workitems/create/Bug?templateId=d6e86c3f-9dad-4009-ae89-8c4d9fa3c03a&ownerId=3db7eb97-eeaf-4acc-9b12-ef8f53c9e9be"}]);else{var E=this._pageContext.listBaseType?Object(f.a)(this._pageContext.listBaseType):Object(f.i)(this._pageContext.listBaseTemplate);x&&(c.ActionsMap[r.e.LIBRARY_SETTINGS]=function(e){var t=e.resources.consume(v.e);return new(e.resources.injected(t.LaunchDocLibSettingPanelAction))({panelHeaderText:S.e,isEditSettingPanel:x,settingPanelProps:{classicSettingLink:o._getDocLibSettingLink()}}).execute(null),!1}),c.CurrentWorkloadSettingsSubLinks=this._getSettingsLinks(E)}if(this._isSiteInformationLinkEnabled()&&(c.ActionsMap[r.e.SITE_INFORMATION]=function(e){return Object(D.e)(e.resources,function(e){return e.LaunchSiteSettingsPanelAction}),!1},window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchSiteSettings=function(){Object(D.e)(o._resources,function(e){return e.LaunchSiteSettingsPanelAction})})),this._isHubSettingsLinkEnabled()&&(c.ActionsMap[r.e.HUB_SETTINGS]=function(e){return Object(D.e)(e.resources,function(e){return e.LaunchHubSettingsPanelAction}),!1},this._pageContext.isHubSite&&window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchHubSettings=function(){Object(D.e)(o._resources,function(e){return e.LaunchHubSettingsPanelAction})})),this._isChangeTheLookLinkEnabled()&&(c.ActionsMap[r.e.CHANGE_THE_LOOK]=function(e){return Object(D.e)(e.resources,function(e){return e.LaunchChangeTheLookPanelAction}),!1}),this._isSitePermissionsLinkEnabled()&&(c.ActionsMap[r.e.SITE_PERMISSIONS]=function(e){return Object(D.e)(e.resources,function(e){return e.LaunchSitePermissionsPanelAction}),!1}),this._isSiteDesignsLinkEnabled()){var A=function(){Promise.resolve(n.e(108).then(n.bind(null,3067))).then(I.e).then(function(e){e.SiteScriptProgressStateManager.getInstance({pageContext:o._pageContext}).triggerOpenPanelAction()})};c.ActionsMap[r.e.SITE_DESIGNS]=function(e){return A(),!1},window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchSiteDesignProgress=A)}this._shouldShowGroupifyLink()&&(c.ActionsMap.Groupify=function(e){return Object(D.e)(e.resources,function(e){return e.LaunchGroupifyPanelAction}),!1}),this._isGlobalNavSettingsPanelEnabled()&&(c.ActionsMap.GLOBALNAV_SETTINGS_SUITENAVID=function(e){return Object(D.e)(e.resources,function(e){return e.LaunchGlobalNavSettingsPanelAction}),!1}),this._isWebTemplatesGalleryEnabled()&&(c.ActionsMap.SuiteMenu_MenuItem_WebTempaltesGallery=function(e){var t;return g.e.logData({name:"SiteTemplates.Panel.Clickâ€‹",webTemplateId:null===(t=o._pageContext)||void 0===t?void 0:t.webTemplate}),Object(D.e)(e.resources,function(e){return e.LaunchWebTemplatesGalleryAction}),!1},window.sessionStorage.getItem("_isRunningTABTest")&&(window._spLaunchWebTemplatesGallery=function(){Object(D.e)(o._resources,function(e){return e.LaunchWebTemplatesGalleryAction})})),this._isVivaConnectionsSettingsLinkEnabled()&&(c.ActionsMap[r.e.VIVA_CONNECTIONS]=function(e){var t=e.resources.consume(v.e);return new(e.resources.injected(t.LaunchVivaConnectionsSettingsPanelAction))({}).execute(null),!1}),!c.SignOutLink&&d||(c.SignOutLink.Url=Object(s.o)(this._pageContext)+"/_layouts/15/SignOut.aspx",c.SignOutLink.Text||(c.SignOutLink.Text=i.p)),c.UserDisplayName=this._pageContext.userDisplayName||c.UserDisplayName||this._pageContext.webTitle||null}if(c.FeedbackLink=null,this._suiteNavContext.firstRunScenarioType&&(c.CurrentWorkloadHelpSubLinks=[{Id:r.e.FIRSTRUN,Text:i.f,Url:"#"}],c.ActionsMap[r.e.FIRSTRUN]=function(e){return Object(D.e)(e.resources,function(e){return e.InvokeFirstRunExperienceAction}),!1}),d||(c.StringsOverride=c.StringsOverride||{},c.StringsOverride.l_ShellCore_O365_Text="SharePoint"),this._suiteNavContext.helpNamespace&&this._suiteNavContext.helpId?c.HelpLink.Url="https://o15.officeredir.microsoft.com/r/rlidOfficeWebHelp?p1=".concat(this._suiteNavContext.helpNamespace,"&clid=").concat(this._pageContext.currentLanguage,"&ver=").concat(d?"16":"19","&HelpId=").concat(this._suiteNavContext.helpId):c.HelpLink.Url="https://support.microsoft.com",!d){if(c.HelpLink){var L=this._suiteNavContext.helpIdOnPrem||"WSSEndUser",k=this._pageContext.currentLanguage;c.HelpLink.Url="https://support.office.com/client/results?helpid=".concat(L,"&NS=").concat("WSSEndUser","&lcid=").concat(k,"&SYSLCID=").concat(k,"&UILCID=").concat(k,"&Version=19")}c.ActionsMap[r.e.HELP]=function(){var e=window.open("","_blank","resizable=1,location=0,width=400,height=500");return e.opener=null,e.location.href=c.HelpLink.Url,!1}}c.HelpLink.Text||(c.HelpLink.Text=i.i);var M=Number(this._pageContext.webTemplate),P=M===_.t.mySite||M===_.t.mySiteHost;return c.UseSPOBehaviors=!P,c},e.prototype._getDocLibSettingLink=function(){return this._pageContext.webAbsoluteUrl+"/_layouts/15/listedit.aspx?List="+encodeURIComponent(this._pageContext.listId)},e.prototype._getSettingsLinks=function(e){var t,s=this,c=this._pageContext.webAbsoluteUrl,d=f.t.documentLibrary===Number(this._pageContext.listBaseTemplate),l=[];if(t=e&&x?{Id:r.e.LIBRARY_SETTINGS,Text:i.o,Url:"#",Hidden:!this._pageContext.listId,IsMySiteSettingLink:!1,ListPermissions:[p.e.manageLists]}:{Id:C?r.e.LIBRARY_SETTINGS:r.e.LIST_SETTINGS,Text:e?i.o:i.s,Url:c+"/_layouts/15/listedit.aspx?List="+encodeURIComponent(this._pageContext.listId),Hidden:!this._pageContext.listId,IsMySiteSettingLink:!1,ListPermissions:[p.e.manageLists]},this._suiteNavContext.currentMainLinkElementID===r.e.LISTS){var u={Id:r.e.LIBRARY_SETTINGS,Text:i.d,Url:c+"/_layouts/15/"+(this._pageContext.isSiteAdmin?"AdminRecycleBin.aspx":"RecycleBin.aspx")+"?view=5&env=WebViewList"};return l.push(u),Object(b.i)(this._pageContext)&&l.push(t),l}if(this._suiteNavContext.showMySiteSettings||this._suiteNavContext.showTrimmedSettings){var m=this._pageContext.listPermsMask||p.e.fullMask,_=this._pageContext.webPermMasks,g=!1,v=this._pageContext.MenuData&&this._pageContext.MenuData.SettingsData;if(v&&!this._isODB){for(var y=this._suiteNavContext.showTrimmedSettings&&!t.Hidden&&p.e.hasAny(m,t.ListPermissions),S=function(e){return{Id:e.Id,Text:e.Text,Url:e.Url}},D=0,I=v;D<I.length;D++){var O=I[D];O?(g&&(l.push(null),g=!1),O.Id===t.Id?y=!1:y&&O.Id===r.e.SITE_SETTINGS&&(l.push(S(t)),y=!1),l.push(S(O))):g=!0}y&&l.push(S(t)),Object(h.isFeatureEnabled)(h.ShowSharepointRestoreLink)&&this._pageContext.isSiteAdmin&&d&&l.push(S({Id:"Document_Library_Restore",Text:i.l,Url:"?p=18"}))}else for(var w=0,E=[{Id:r.e.ADD_APP,Text:i.e,Url:c+"/_layouts/15/addanapp.aspx",IsMySiteSettingLink:!0,WebPermissions:[p.e.manageLists,p.e.manageSubwebs],Hidden:this._isODB},{Id:r.e.SITE_CONTENTS,Text:i._,Url:c+"/_layouts/15/viewlsts.aspx",IsMySiteSettingLink:!0,WebPermissions:[p.e.viewFormPages],Hidden:this._isODB},null,t,{Id:r.e.SITE_SETTINGS,Text:i.v,Url:c+"/_layouts/15/settings.aspx",IsMySiteSettingLink:!0,WebPermissions:o.e.siteSettingsPermissions.concat(),Hidden:this._isODB}];w<E.length;w++){var A=E[w];g=g||!A,A&&!A.Hidden&&(this._suiteNavContext.showMySiteSettings?A.IsMySiteSettingLink:p.e.hasAny(_,A.WebPermissions)||p.e.hasAny(m,A.ListPermissions))&&(g&&(l.push(null),g=!1),l.push({Id:A.Id,Text:A.Text,Url:A.Url}))}}return this._isGlobalNavSettingsPanelEnabled()&&l.push({Id:"GLOBALNAV_SETTINGS_SUITENAVID",Text:i.n,Url:"#"}),this._isHubSettingsLinkEnabled()&&l.push({Id:r.e.HUB_SETTINGS,Text:i.r,Url:"#"}),this._isSiteInformationLinkEnabled()&&(l=l.filter(function(e){return!e||e.Id!==r.e.SITE_SETTINGS})).push({Id:r.e.SITE_INFORMATION,Text:i.h,Url:"#"}),this._isSitePermissionsLinkEnabled()&&l.push({Id:r.e.SITE_PERMISSIONS,Text:i.b,Url:"#"}),this._isWebTemplatesGalleryEnabled()&&l.push({Id:"SuiteMenu_MenuItem_WebTempaltesGallery",Text:i.y,Url:"#"}),this._isODB&&(this._pageContext.isSiteAdmin&&(Object(h.isFeatureEnabled)(h.OneDriveSettings)&&l.push({Id:"OneDrive_Settings",Text:i.c,Url:c+"/_layouts/15/onedrive.aspx?p=22"}),l.push({Id:"OneDrive_Restore",Text:i.u,Url:c+"/_layouts/15/onedrive.aspx?p=18"})),Object(h.isFeatureEnabled)(h.DownloadDebugLogs)&&l.push({Id:"Download_Logs",Text:"Download Logs",Action:function(){return Object(a.__awaiter)(s,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(582).then(n.bind(null,5307))];case 1:return(0,e.sent().downloadDebugLogs)(),[2]}})})}})),this._isSiteAnalyticsLinkEnabled()&&l.push({Id:"Site_Analytics",Text:i.m,Url:c+"/_layouts/15/siteanalytics.aspx"}),this._isChangeTheLookLinkEnabled()&&l.push({Id:r.e.CHANGE_THE_LOOK,Text:i.t,Url:"#"}),this._isSiteDesignsLinkEnabled()&&l.push({Id:r.e.SITE_DESIGNS,Text:i.g,Url:"#"}),this._shouldShowGroupifyLink()&&l.push({Id:"Groupify",Text:i.a,Url:"#"}),this._isVivaConnectionsSettingsLinkEnabled()&&l.push({Id:r.e.VIVA_CONNECTIONS,Text:this._isVivaConnectionsSettingsPreviewTagEnabled()?i.D:i.S,Url:"#"}),l.length>0?l:null},e.prototype._isSiteAnalyticsLinkEnabled=function(){return!this._isODB&&Object(h.isFeatureEnabled)(h.SiteAnalyticsV3)},e.prototype._isSiteInformationLinkEnabled=function(){var e=Number(this._pageContext.webTemplate)===_.t.mySite||Number(this._pageContext.webTemplate)===_.t.mySiteHost;return p.e.hasPermission(this._pageContext.webPermMasks,p.e.manageWeb)&&(Object(s.d)(this._pageContext)||!e)},e.prototype._isHubSettingsLinkEnabled=function(){return this._pageContext.isSiteAdmin&&this._pageContext.isHubSite},e.prototype._isSitePermissionsLinkEnabled=function(){var e=Number(this._pageContext.webTemplate);return!this._isODB&&(!this._pageContext.isAnonymousGuestUser&&!this._pageContext.isExternalGuestUser||p.e.hasPermission(this._pageContext.webPermMasks,p.e.manageWeb))&&(Object(h.isFeatureEnabled)(h.PermUpdateForChannelSIte)||e!==_.t.teamChannel)},e.prototype._isChangeTheLookLinkEnabled=function(){var e=Number(this._pageContext.webTemplate);return this._pageContext.modernThemingEnabled&&p.e.hasPermission(this._pageContext.webPermMasks,p.e.applyThemeAndBorder)&&e!==_.t.mySite&&e!==_.t.mySiteHost},e.prototype._hasApplyTemplatePermission=function(){return this._pageContext.isSiteAdmin||p.e.hasPermission(this._pageContext.webPermMasks,{High:2147483647,Low:4294705151})},e.prototype._isSiteDesignsLinkEnabled=function(){if(!this._isWebTemplatesGalleryEnabled()&&this._hasApplyTemplatePermission()){var e=Number(this._pageContext.webTemplate);return e===_.t.group||e===_.t.sitePagePublishing||"STS#3"===this._pageContext.webTemplateConfiguration}return!1},e.prototype._isWebTemplatesGalleryEnabled=function(){return Object(h.isFeatureEnabled)(h.EnableWebTemplatesGallery)&&this._hasApplyTemplatePermission()&&Object(s.l)({webTemplateConfiguration:this._pageContext.webTemplateConfiguration})},e.prototype._isGlobalNavSettingsPanelEnabled=function(){var e=this._pageContext;return Object(h.isFeatureEnabled)(h.WEXMultipleHomeSitesGlobalNav)?Object(s.u)(e)&&e.isCurrentSiteAHomeSite&&p.e.hasPermission(e.webPermMasks,p.e.manageWeb):Object(s.u)(e)&&e.companyPortalReference&&e.companyPortalReference.SiteId&&e.siteId.indexOf(e.companyPortalReference.SiteId)>=0&&p.e.hasPermission(e.webPermMasks,p.e.manageWeb)},e.prototype._shouldShowGroupifyLink=function(){return e=this,Object(h.isFeatureEnabled)(h.GroupifyFromModernPages)&&e._pageContext.isSPO&&e._pageContext.isSiteAdmin&&!e._pageContext.restrictedToRegion&&"/"!==e._pageContext.siteServerRelativeUrl&&e._pageContext.siteServerRelativeUrl===e._pageContext.webServerRelativeUrl&&Number(e._pageContext.webTemplate)===_.t.teamSite&&!e._pageContext.groupId&&!e._pageContext.isGroupifyDisabled&&(m.e.isActivated("616A3856-3AB2-4319-BB53-F25B63B5FC02","10/03/2020","Respect isGroupifyMenuButtonFeatureOff in Suite Nav")||!e._pageContext.isGroupifyMenuButtonFeatureOff);var e},e.prototype._isVivaConnectionsSettingsLinkEnabled=function(){var e,t="false"!==(null===(e=this._pageContext.farmSettings)||void 0===e?void 0:e.ExternalService_vivaconnectionsenabled),n=m.e.isActivated("30DBB208-E98E-41EF-B53E-6A7DDA4EE2AD")?p.e.hasItemPermission({permissions:this._pageContext.listPermsMask},p.e.editListItems):p.e.hasPermission(this._pageContext.webPermMasks,p.e.editListItems);return t&&Object(h.isFeatureEnabled)(h.VivaConnectionsGA)&&Object(c.n)(this._pageContext)&&n},e.prototype._isVivaConnectionsSettingsPreviewTagEnabled=function(){return!Object(h.isFeatureEnabled)(h.VivaConnectionsPreviewTagRemoval)},e}(),w=Object(d.r)("SuiteNavDataUpdater",O,{resources:l.r});t.default=O},4648:function(e,t,n){"use strict";n.r(t),n.d(t,"addSuiteNavDeferredResources",function(){return ye});var a=n(9),i=n(125),r=n(4395),o=n(3659),s=n(4140),c=n(0),d=n(15),l=n(121),u=n(660),f=n(1054),p=n(124),m=n(446),_=n(51),h=n(35),b=n(3),g=n(215),v=n(3767),y=new a.t("searchUpscopeDataSource"),S=n(674),D=n(515),I=n(478),x=n(765),C=n(10),O=n(42),w=n(1474),E=n("react-lib"),A=n(3996),L=n(3048),k=n(219),M=n(116),P=n(189),T=n(41),U=n(19),F=n(279),H=n(2609),R=new k.e,N={delayQos:{},delayTimeoutState:{}},B=function(){function e(e,t,n,a,i){var r=this;this._getSearchDataSource=function(){return Object(c.__awaiter)(r,void 0,void 0,function(){var e;return Object(c.__generator)(this,function(t){switch(t.label){case 0:return e=this._resources,Object(b.Ho)(b.bo)?[4,e.consumeAsync(g.e.optional)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2,e.consumeAsync(p.te)]}})})},this._resources=e,this._id=t,this._getScope=n,this.rx=i,this._isList=a}return e.prototype.getId=function(){return this._id},e.prototype.createStream=function(e){var t=this,n=1===e.length?"":e;return this.rx.Observable.fromPromise(this._updateDelayedQuery(n)).selectMany(function(e){return t.rx.Observable.fromArray(e)}).select(function(n){return t.transform(n,e)})},e.prototype._getSuggestionResultPromise=function(e){var t=this,n=e+"*",a=new T.e({name:this._id});return M.n.wrap(this._getSearchDataSource()).then(function(e){var i,r=null===(i=t._getScope())||void 0===i?void 0:i.id;return e.getItems(n,void 0,r).then(function(e){return a.end({resultType:T.t.Success}),e.containers[0]&&e.containers[0].results||void 0}).catch(function(e){throw a.end({resultType:T.t.Failure,error:e.message}),e})})},e.prototype._updateDelayedQuery=function(e){var t=this;return this._ensureDelayQos(),N.delayTimeoutState.delayTimeoutId&&N.delayTimeoutState.rejectQuery&&this._rejectPreviousSuggestion(),new M.n(function(n,a){N.delayTimeoutState.delayTimeoutId=R.setTimeout(function(){t._resolveSuggestion(n,e)},400),N.delayTimeoutState.rejectQuery=a})},e.prototype.transform=function(e,t){var n,a=U.format(H.b,e.lastModifiedBy,Object(F.n)(e.lastModifiedDate,P.t.language));if(e.rawTitleText)n=e.rawTitleText;else{var i=document.createElement("textarea");i.innerHTML=e.titleText,n=i.value}var r=e.fileExtension||(-1!==n.lastIndexOf(".")?n.substring(n.lastIndexOf(".")+1):""),o=this._highlight(n,t);return a=this._highlight(a,t),{id:e.url,searchText:t,displayText:o,secondaryDisplayText:a,title:o,icon:e.iconUrl,iconUrl:e.iconUrl,lastModifiedBy:e.lastModifiedBy,lastModifiedTime:e.lastModifiedDate.toISOString(),url:e.itemOpenUrl||this._fixUrl(e,n,r),fileExtension:r,fileType:this._getFileType(r,e.isContainer),sPWebUrl:e.siteUrl}},e.prototype._getFileType=function(e,t){return t&&"one"!==e?"folder":"file"},e.prototype._highlight=function(e,t){var n=new RegExp(t,"i");return e.replace(n,"<mark>$&</mark>")},e.prototype._fixUrl=function(e,t,n){var a=e.url,i=e.parentUrl?decodeURI(e.parentUrl):"";return i=i&&Object(L.e)(i),a=Object(L.t)({filename:t,isContainer:e.isContainer,parentLink:i,path:a,shouldAllowDisplayFormUrl:this._isList}),"loop"===n&&i&&(a="".concat(i,"/").concat(t,"?web=1")),a},e.prototype._ensureDelayQos=function(){N.delayQos.qosEvent||(N.delayQos.qosEvent=new T.e({name:"SuiteNavSearchBox.SearchDataSourceSuggestionProvider.delayed"}),N.delayQos.numberOfCanceledQueries=0)},e.prototype._endDelayQos=function(e){var t;null===(t=N.delayQos.qosEvent)||void 0===t||t.end({resultType:T.t.Success,extraData:{delayTimeInMs:400,numberOfCanceledQueries:N.delayQos.numberOfCanceledQueries,characterCount:e}}),N.delayQos={}},e.prototype._updateDelayQosCanceledQueries=function(){void 0!==N.delayQos.numberOfCanceledQueries&&N.delayQos.numberOfCanceledQueries++},e.prototype._rejectPreviousSuggestion=function(){R.clearTimeout(N.delayTimeoutState.delayTimeoutId),N.delayTimeoutState.rejectQuery(),this._updateDelayQosCanceledQueries(),N.delayTimeoutState={}},e.prototype._resolveSuggestion=function(e,t){N.delayTimeoutState={},this._endDelayQos(t.length),e(this._getSuggestionResultPromise(t))},e}();function j(e,t,n){return{id:"scopedFileSuggestionProvider",groupUpdaters:[{groupId:"file",createUpdater:function(){var a;if(t()){var i=B.bind(null,e,"SuiteNavSearchBox.ScopedFileSuggestionProvider",n,void 0);i.__parameters=[{index:0,name:"rxjs"}];var r="org"===(null===(a=n())||void 0===a?void 0:a.id)?[]:[i];return{providers:function(e){return r}}}return{}}}]}}function V(e){return function(){return{component:function(t){return function(n){return E.createElement(t,Object(c.__assign)(Object(c.__assign)({},n),{onClick:function(t){!function(e,t,n){var a=t.url;if("SuiteNavSearchBox.ScopedFileSuggestionProvider"!==t.providerId&&Object(A.n)(t)){var i=decodeURI(t.url);try{a=decodeURIComponent(i)}catch(e){a=i}}var r=Object(c.__assign)(Object(c.__assign)({},t),{url:a});Object(A.t)(e,r,n,void 0)}(t,n,e)}}))}}}}}var z=function(){function e(e,t){var n=this;this._deps=t,this._getSearchDataSource=function(){return Object(c.__awaiter)(n,void 0,void 0,function(){return Object(c.__generator)(this,function(e){switch(e.label){case 0:return[4,this._deps.resources.consumeAsync(g.e.optional)];case 1:return e.sent(),[2,this._deps.getSearchDataSource()]}})})},this._folderSearchEnabled=Object(h.isFeatureEnabled)(h.ODBSubstrateSearchQueryV2)&&Object(h.isFeatureEnabled)(h.CSIOdbScopedSearch),this._otherPeopleOdb3SSearchEnabled=Object(h.isFeatureEnabled)(h.ODBSubstrateSearchQueryV2)&&Object(h.isFeatureEnabled)(h.CSIOdbNotMyFiles3S)}return e.prototype.getSuiteNavProviderKey=function(){return this._deps.resources.isExposed(m.S)?m.S:f.e},e.prototype.getTokenProviders=function(){return this._deps.searchBoxConfig.getTokenProviders()},e.prototype.getProviderConfigUpdaters=function(e){var t,n=[(t=this._deps,{id:"ODBFileSuggestionProvider",groupUpdaters:[{groupId:"file",createUpdater:V(t)},{groupId:"app",createUpdater:V(t)}]})];return Object(h.isFeatureEnabled)(h.UseTsQuery)&&!(Object(h.isFeatureEnabled)(h.CSIGuestSuiteNavSearchBox)&&this._deps.pageContext.isExternalGuestUser)&&(this._folderSearchEnabled||this._otherPeopleOdb3SSearchEnabled)&&(Object(h.isFeatureEnabled)(b.O)&&e?n.push(j(this._deps.resources,this._isScopeUseSuggestionProvider.bind(this,e),e.bind(this))):n.push(j(this._deps.resources,this._isUsingSuggestionProvider.bind(this),function(){}))),n},e.prototype.onSubmitSearchCallback=function(e,t,n,a,i){var r=this;if(this._deps.instrumentationProvider.logStartSearchOnSubmit(),"org"===(null==n?void 0:n.id))e&&this._deps.searchUpscopeDataSource.getTenantUpscopeUrl(e).then(function(e){a?r._deps.navigation.navigateTo(e+"&returnUrl="+encodeURIComponent(a)):r._deps.navigation.navigateTo(e)});else{this._deps.engagement.logData({name:"Upscope.Search.Click",isIntentional:!0});var o=t(),s=this._getSearchItemId(o,n),c=this._getSearchScope(o,null==n?void 0:n.id),d=void 0;(n&&!this._shouldRemoveListUrl(n)||!n&&"library"===c)&&(d=Object(O.m)(o));var l=void 0,u=void 0,f=void 0;i&&(l=o[C.n.typeFiltersKey]||void 0,u=o[C.n.dateFilterKey]||void 0,f=o[C.n.userFiltersKey]||void 0);var p={query:e,searchItemId:s,listUrl:d,searchScope:c,typeFilter:l,dateFilter:u,userFilter:f};this._getSearchDataSource().then(function(e){e.upscopeSearch(p)})}},e.prototype.onExitSearchCallback=function(e){!function(e,t){t?e.updateViewParams(t,{clearOtherParams:!0}):(delete e.viewParams[S.n.queryTypeParamKey],delete e.viewParams[S.n.queryParamKey],delete e.viewParams[S.n.searchScopeKey],delete e.viewParams[S.n.metadataSearchIdKey],e.updateViewParams({}))}(this._deps.navigation,e)},e.prototype.isSearchResultsPage=function(){var e=this._deps.navigation.viewParams;return Object(D.e)(Object(O.g)(e))},e.prototype._getSearchScope=function(e,t){if(!t){if(this._isCurrentUserODB()){if(this._folderSearchEnabled){var n=Object(O.f)(e);return this._isSharedLibrary(n)?"library":"folder"}}else if(this._otherPeopleOdb3SSearchEnabled)return"folder";return"all"}switch(t){case"odbAllFiles":return"all";case"odbMyFiles":case"odbFolder":return"folder";case"spDocLibFolder":case"spDocLib":case"spSiteSite":return"library";case"odbOtherPeople":return this._otherPeopleOdb3SSearchEnabled?"folder":"all"}},e.prototype._isScopeUseSuggestionProvider=function(e){var t=e();if(!t)return!this._isCurrentUserODB()&&this._otherPeopleOdb3SSearchEnabled;switch(t.id){case"odbAllFiles":return!1;case"odbOtherPeople":return this._otherPeopleOdb3SSearchEnabled;default:return!0}},e.prototype._getSearchItemId=function(e,t){if(this._isScopedSearch()){var n,a=Object(O.f)(Object(c.__assign)({},e)),i=this._deps.itemUrlHelper.getItemUrlParts(a),r=this._isCurrentUserODB();if(t&&r){var o=this._deps.urlDataSourceLite.getDefaultRootItemId();n=Object(v.e)(o,i,t.id)}else!this._otherPeopleOdb3SSearchEnabled||r||this._folderSearchEnabled||(n=i.serverRelativeListUrl);return n||e[C.n.idParamKey]}},e.prototype._isCurrentUserODB=function(){return Number(this._deps.pageContext.listBaseTemplate)===d.t.mySiteDocumentLibrary&&(Object(h.isFeatureEnabled)(b.Xa)?!!this._deps.pageContext.isMySiteOwner:!!this._deps.pageContext.isSiteOwner)},e.prototype._isUsingSuggestionProvider=function(){var e=Object(O.I)(this._deps.navigation.viewParams);return e?"all"!==e:this._isScopedSearch()},e.prototype._isScopedSearch=function(){var e=Object(O.f)(Object(c.__assign)({},this._deps.navigation.viewParams));return this._isCurrentUserODB()?this._folderSearchEnabled&&!Object(I.o)(e,this._deps.itemUrlHelper):this._otherPeopleOdb3SSearchEnabled},e.prototype._shouldRemoveListUrl=function(e){var t=null==e?void 0:e.id;return!!t&&("spSiteSite"===t||"odbAllFiles"===t)},e.prototype._isSharedLibrary=function(e){return Object(I.a)(e,this._deps.itemUrlHelper)},e.dependencies={resources:a.r,navigation:l.e,instrumentationProvider:m.o,engagement:u.e,getSearchDataSource:p.te.async,searchBoxConfig:w.e,listContext:_.s,pageContext:_.p,itemUrlHelper:I.s,searchUpscopeDataSource:y,urlDataSourceLite:x.resourceKey},e}(),G=Object(i.r)("ODBSearchBoxDataSource",z),K=n(4141),W=n(8),q=n(211),Q=n(1481),Y=n(36),J=n(1467),X={id:"odbFolder",name:J.t},Z={id:"odbMyFiles",name:J.p},$={id:"odbOtherPeople",name:J.m},ee={id:"odbAllFiles",name:J.l},te={id:"org",name:J.D},ne={id:"spDocLibFolder",name:J.t},ae={id:"spDocLib",name:J.i},ie={id:"spSiteSite",name:J.o},re=function(){function e(e,t){this._deps=t}return e.prototype.getInitialScope=function(){var e=this._deps.navigation.viewParams,t=Object(O.f)(Object(c.__assign)({},e)),n=Object(O.g)(e),a=Object(D.e)(n),i=this._isCurrentUserODB(),r=ee;if(!W.t.isActivated("4A806B20-065E-46A5-BBE3-6E68108AF6EF","03/31/2023","set odb root scope base on view")){var o=Object(b.Ho)(b.ho)||this._deps.pageContext.isMySiteOwner&&(!!Object(q.n)(90147,this._deps.pageContext)||!!Object(q.n)(90052,this._deps.pageContext));n===Y.e.Files&&o&&(r=Z)}return a?this._getScopeForSearch(e,t,i):this._getScopeForNonSearch(t,i,r)},e.prototype.getAvailableScopes=function(){var e=!!this._deps.sharepointUrl.get();return function(e,t){var n;switch(e){case"odbFolder":n=[X,Z,ee];break;case"odbOtherPeople":return[];case"odbMyFiles":case"odbAllFiles":n=[Z,ee];break;case"spFolder":case"spDocLibFolder":n=[ne,ae,ie,ee];break;case"spDocLib":n=[ae,ie,ee];break;case"spSiteSite":n=[ie,ee];break;default:throw new Error("Invalid scope")}return t&&n.push(te),n}(this.getInitialScope().id,e)},e.prototype.setActiveScope=function(e){this._activeScope=e},e.prototype.getActiveScope=function(){return this._activeScope},e.prototype.isScopingControlEnabled=function(){return Object(b.Ho)(b.Aa)&&Object(b.Ho)(b.w)&&Object(b.Ho)(b.O)},e.prototype.getScopeControlScenario=function(e,t){if(t)return"ODB.Search";switch(e){case X:return"ODB.Folder";case $:return"ODB.OtherPeople";case ee:return"ODB.Root";case Z:return"ODB.MyFiles";case ne:return"ODB.Library.Folder";case ae:return"ODB.Library.Root";case ie:return"ODB.Site";default:if(W.t.isActivated("0CAE78AB-DD1D-4079-9C9D-7F73CAD56010","03/31/2023","should not throw error for unsupported scope"))throw new Error('Unsupported scope: "'.concat(e.id,'"'));return}},e.prototype._isCurrentUserODB=function(){return Number(this._deps.pageContext.listBaseTemplate)===d.t.mySiteDocumentLibrary&&(Object(b.Ho)(b.Xa)?!!this._deps.pageContext.isMySiteOwner:!!this._deps.pageContext.isSiteOwner)},e.prototype._isDocLib=function(e){return Object(I.a)(e,this._deps.itemUrlHelper)},e.prototype._getDocLibSearchScope=function(e){return Object(I.r)(e,this._deps.itemUrlHelper)?ie:Object(I.i)(e,this._deps.itemUrlHelper)?ae:ne},e.prototype._getScopeForSearch=function(e,t,n){return n?"all"===e[C.n.searchScopeKey]?ee:this._isDocLib(t)?this._getDocLibSearchScope(t):Object(I.o)(t,this._deps.itemUrlHelper)?Z:X:$},e.prototype._getScopeForNonSearch=function(e,t,n){return t?this._isDocLib(e)?this._getDocLibSearchScope(e):Object(I.o)(e,this._deps.itemUrlHelper)?n:X:$},e.dependencies={navigation:l.e,engagement:u.e,pageContext:_.p,itemUrlHelper:I.s,sharepointUrl:Q.t},e}(),oe=Object(i.r)("ODBScopingControlDataSource",re),se=n(632),ce=n(179),de=n(4221),le=function(){function e(e,t){this._pageContext=t.pageContext,this._sharepointUrl=t.sharepointUrl}return e.prototype.getTenantUpscopeUrl=function(e){var t=this._sharepointUrl.get();if(Object(b.Ho)(b.wi)){var n=new ce.e(t).authority;return Promise.resolve("".concat(n,"/").concat(this._pageContext.layoutsUrl,"/Search.aspx?q=").concat(e))}var a=t.indexOf("?")?"&":"?",i="q=".concat(e,"&v=search");return Promise.resolve("".concat(t).concat(a).concat(i))},e.prototype.getLabel=function(){return de.t},e.prototype.getAriaLabel=function(){return"".concat(de.t," ").concat(de.n)},e.dependencies={pageContext:_.p,sharepointUrl:Q.t},e}(),ue=Object(i.r)("ODBSearchUpscopeDataSource",le),fe=n(3313),pe=n(229),me=n(104),_e=n(1475),he=function(){function e(e,t){this._searchUpscopeDataSource=t.searchUpscopeDataSource,this._pageContext=t.pageContext,this._navigation=t.navigation}return e.prototype.getUpscopeUrl=function(){var e,t=Number(this._pageContext.webTemplate)===me.e.mySite,n=this.getSearchText(),a=this._pageContext.searchScope;return t||Object(_e.n)(this._pageContext)||a===pe.a.Tenant?this._searchUpscopeDataSource.getTenantUpscopeUrl(n):(e=this._pageContext.hubSiteId&&a!==pe.a.Site&&this._pageContext.isHubSite?"hub":"site",this._searchUpscopeDataSource.getSiteSearchUpscopeUrl(n,e))},e.prototype.getSearchText=function(){return Object(O.b)(this._navigation.viewParams)||""},e.prototype.getLabel=function(){return this._searchUpscopeDataSource.getLabel()},e.prototype.getAriaLabel=function(){return this._searchUpscopeDataSource.getAriaLabel()},e.prototype.getListTemplate=function(){return this._pageContext.listBaseTemplate},e.dependencies={searchUpscopeDataSource:y,pageContext:_.p,navigation:l.e},e}(),be=Object(i.r)("SearchUpscopeProvider",he),ge=n(1027),ve=new a.t({name:"".concat("SuiteNavInitDeferred",".suiteNavV2"),factory:{dependencies:{suiteNavDataSourceV2Type:o.e,suiteNavContext:se.a,suiteNavDataUpdater:r.resourceKey,suiteNavCapabilities:se.n,suiteNavDataSourceBasic:p.fe.optional},create:function(e){return{instance:new(0,e.suiteNavDataSourceV2Type)({suiteNavContext:e.suiteNavContext,suiteNavDataUpdater:e.suiteNavDataUpdater,suiteNavCapabilities:e.suiteNavCapabilities,suiteNavDataSourceBasic:e.suiteNavDataSourceBasic})}}}});function ye(e){e.isExposed(se.e)||(e.expose(se.e,!0),e.expose(Q.t,new ge.e("")),e.isExposed(p.pe)||e.exposeFactory(p.pe,new i.e(ve)),e.exposeFactory(K.e,new i.e(oe)),e.exposeFactory(s.e,new i.e(G)),e.exposeFactory(y,new i.e(ue)),e.exposeFactory(fe.e,new i.e(be)))}},5183:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return l});var a=n(159),i=n(105),r=n(220),o=n(9),s=n(1764),c=n(803),d=n(76),l=new o.t({name:"DropActionControlHandler",factory:new o.e(function(e,t){if(t.handlers&&function(e,t){var n=Object(d.e)(e);if(n&&t.itemKey){var o=Object(c.e)(e,{itemKey:t.itemKey}).itemKey;if(o){var s=a.e.deserialize(o).webAbsoluteUrl;return new r.e({},{pageContext:n}).getUrlParts({webUrl:s}).geoRelation===i.e.crossGeo}}return!1}(e,t)){for(var n=[],o=0,l=t.handlers;o<l.length;o++){var u=l[o];u.key!==s.e.key&&n.push(u)}return{handlers:n}}return{}})})},5189:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return r});var a=n(9),i={pageContext:n(4212).e.optional},r=new a.t({name:"SimpleEngagementHandlers",factory:{dependencies:i,create:function(e){var t=[],n=e.pageContext;return n&&t.push(n),{instance:t}}}})},5243:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return c}),n.d(t,"deferredSetup",function(){return d});var a=n(132),i=n(9),r=n(3659),o=n(1627),s=n(1452),c=new i.t({name:"SuiteNavDeferredSetup",factory:{dependencies:{},create:function(){return{instance:d}}}}),d=function(e,t){var i=e.rumone,c=e.resources,d=e.suiteNavCapabilities,l=e.suiteNavContext,u=e.onSuiteNavLoaded,f=e.setDataParams,p=e.onAfterSetData,m=e.deferredSetupCallback,_=e.isEarlySuiteNav,h=e.suiteNavDataUpdaterKey,b=e.suiteNavProviderKey,g=e.searchBoxProviderKey;return h&&b&&c.consumeAsync(h).then(function(e){var h,v,y=new(c.consume(r.e))({suiteNavCapabilities:d,suiteNavContext:l,suiteNavDataUpdater:e,suiteNavDataSourceBasic:c.consume(o.e.optional)});c.isExposed(s.e)||c.expose(s.e,y);var S=c.consumeAsync(b).then(function(e){return h=e,e.getO365Shell()}).then(function(e){return v=e,null==u||u(v),Promise.resolve().then(n.bind(null,1987)),m&&m({resources:c,shell:v}),v.GetResourceLoader().loadAll(),h.trySetDataAfterInitialRender(v,f||{})}).then(function(e){e&&(i.mark("Bootstrapper.SuiteNav.CompleteRendered"),i.logRUMOneForDeferredControl("SuiteNav",a.n.now())),null==p||p(v,e)}),D=g?c.consumeAsync(g).then(function(e){e.configureSearchBox(t)}):Promise.resolve();return _?Promise.all([S,D]).then(function(){}):void 0})}},5588:function(e,t,n){"use strict";n.r(t),n.d(t,"registerServiceWorker",function(){return p}),n.d(t,"registerServiceWorkerAtRemoteListHosts",function(){return m}),n.d(t,"shouldBypassSW",function(){return _}),n.d(t,"unregisterServiceWorker",function(){return h});var a=n(41),i=n(213),r=n(4529),o=n(4893),s=n(4892),c=n(4530),d=n(713),l=n(457),u=!n(8).e.isActivated("300a5278-2825-4c76-998b-52b9710ecd86","03/17/2022","Service worker master switch");function f(){return n.e(745).then(n.bind(null,5338)).then(function(e){return e.default})}function p(e,t){var n=e&&e.isSafari;if("serviceWorker"in navigator&&!n){var o=_(),p=Object(r.e)(o);if(t&&(p=t(p)),u&&!Object(l.e)()){var m=new a.e({name:"STSServiceWorker.register"}),b=navigator.serviceWorker.controller;return(i.n.isFeatureEnabled({ODB:60448})?f().then(function(e){return(new e).register(o,o)}):navigator.serviceWorker.register(p,{updateViaCache:i.n.isFeatureEnabled({ODB:1846})?"all":"none",scope:"/"})).then(function(e){var t=function(){var e=navigator.serviceWorker.controller;e&&"activated"===e.state&&(console.log("".concat(Math.round(performance.now())," install done: "),e),window.__serviceworkerInstalled=!0,m.end({resultType:a.t.Success}),b||sessionStorage.setItem(d.t,"1"),Object(s.e)(),function(){if(window.__swstats){var e=Object(c.t)();e&&(e.addEventListener("message",function(e){var t=e.data;if(t&&t.name===c.e.OfflineNotification&&t.data.offline!==window.__swstats.offline){window.__swstats.offline=t.data.offline;var n=new Event(t.data.offline?"swoffline":"swonline");window.dispatchEvent(n)}}),e.postMessage({name:c.e.CheckOffline,data:{lastKnownOffline:window.__swstats.offline}}))}}())};e.installing?e.installing.addEventListener("statechange",function(){e.waiting&&e.waiting.addEventListener("statechange",function(){t()})}):e.waiting?e.waiting.addEventListener("statechange",function(){t()}):t()}).catch(function(e){console.log("Registration failed, err is:",e),m.end({resultType:a.t.Failure,error:e})})}return h({shouldUnregister:function(e){var t=e&&e.active;return t&&t.scriptURL.indexOf(p)>=0&&"activated"===t.state},qosName:"STSServiceWorker.unregister"})}return Promise.resolve()}function m(e){if(navigator.serviceWorker&&!(null==e?void 0:e.isSafari)&&i.n.isFeatureEnabled({ODB:1918})){var t=_();return f().then(function(e){return(new e).registerAt(Object(o.e)().then(function(e){return null==e?void 0:e.filter(function(e){return e!==location.host})}),t,t).catch(function(){})})}return Promise.resolve()}function _(){var e;return("dev"===window._spModuleLink.buildNumber||(e=!1,window._spModuleLink.libraries&&(e=window._spModuleLink.libraries.some(function(e){if("dev"===e.buildNumber)return!0})),e)||document.cookie.indexOf("srr=")>=0||document.cookie.indexOf("devmode=true")>=0)&&!function(){try{if("sessionStorage"in window){var e=window.sessionStorage.enableServiceWorkerDebugging;return e&&"true"===e.toLowerCase()}}catch(e){}return!1}()}function h(e){if("serviceWorker"in navigator){var t=e.shouldUnregister,n=e.qosName;return navigator.serviceWorker.getRegistrations().then(function(e){for(var i=Promise.resolve(),r=function(e){if(t(e)){var r=new a.e({name:n});return i=e.unregister().then(function(e){console.log("unregister service worker, result: ".concat(e,".")),e?r.end({resultType:a.t.Success}):r.end({resultType:a.t.Failure})}),"break"}},o=0,s=e;o<s.length&&"break"!==r(s[o]);o++);return i})}return Promise.resolve()}}}]);