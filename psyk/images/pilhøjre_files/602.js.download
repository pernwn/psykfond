(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[602,16,18,470],{1961:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(126),r=n(66),o=n(194),s=n(1421),c=n(259);function d(e){var t=this,n=e.progressItemKey,u=e.started,f=e.completed,p=e.progressSize,m=e.isBatch;return function(_){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,h,b,g,v,y,S;return Object(a.__generator)(this,function(D){switch(D.label){case 0:t={operation:d},h=l(e.onCreated,function(e){}),b=l(e.onStarted,function(e){var t;m||_(Object(c.e)({items:(t={},t[e.progressItemKey]=Object(a.__assign)(Object(a.__assign)({},r.g.pack(r.a.started)),"number"==typeof p?Object(a.__assign)({},r.v.pack({total:0,current:0})):{}),t),publisher:b}))}),g=l(e.onCompleted,function(e){var t;m||_(Object(c.e)({items:(t={},t[n]=Object(a.__assign)(Object(a.__assign)({},r.g.pack(r.a.completed)),"number"==typeof p?Object(a.__assign)({},r.v.pack({total:0,current:p})):{}),t),publisher:g}))}),v=l(e.onFailed,function(e){var t,n=e.error;m||_(Object(c.e)({items:(t={},t[e.progressItemKey]=Object(a.__assign)(Object(a.__assign)({},r.g.pack(n&&Object(o.n)(n)?r.a.canceled:r.a.failed)),n?Object(a.__assign)({},i.t.pack(n)):{}),t),publisher:v}))}),_(Object(s.e)({owner:t,items:(S={},S[n]={},S)})),h({progressItemKey:n}),D.label=1;case 1:return D.trys.push([1,4,5,6]),[4,u];case 2:return D.sent(),b({progressItemKey:n}),[4,f];case 3:return D.sent(),g({progressItemKey:n}),[3,6];case 4:return y=D.sent(),v({progressItemKey:n,error:y}),[3,6];case 5:return _(Object(s.n)({owner:t})),[7];case 6:return[2]}})})}}function l(e,t){return e?function(n,a){e(n,function(e){t(e,a)})}:t}},1963:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n(0),i=n(2557),r=n(50),o=n(66),s=n(7),c=n(2),d=n(312),l=n(759),u=n(519),f=n(152),p=n(806),m=n(2222),_=n(150),h=n(1961);function b(e){var t=this,n=e.operationTypeFacet,b=e.progressKeyFacet,g=e.initializeBatch;return Object(f.t)(function(e){var f=e.items,v=Object(a.__rest)(e,["items"]);return function(y){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,S,D,I,x,C,O,w,E,A,L,k,M,P;return Object(a.__generator)(this,function(T){switch(T.label){case 0:for(t=l.e.serializeNext(),S=b.serializeBatchKey(t),D=y(Object(_.e)(function(e){for(var l,p,_=e.demandItemFacet(i.e,S),h=i.e.evaluate(_)(e,{progressItemKey:S,progressRootItemKey:u.e}),g=h.progressRootItemKey,v=h.itemControlHandler,y=h.onBatchCreated,D=h.onBatchCompleted,I=h.onBatchFailed,x={},C=[],O=new d.e,w=0,E=Object.keys(f);w<E.length;w++){var A=E[w],L=f[A],k=b.serializeTaskKey(t,A,L),M=e.demandItemFacet(i.t,k),P=i.t.evaluate(M,v)(e,{progressItemKey:k}),T=P.onItemCreated,U=P.onItemCompleted,F=P.onItemFailed;O.resolveItems({items:(l={},l[k]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},s.r.pack({itemKey:S})),o.y.pack({itemKey:A})),Object(c.t)({options:n},{options:L})),o.g.pack(o.a.created)),o.m.pack({onItemCreated:T,onItemCompleted:U,onItemFailed:F})),l)}),x[A]=Object(a.__assign)(Object(a.__assign)({},L),{progressItemKey:k}),C.push(k)}return O.resolveItems({items:(p={},p[g]=Object(c.t)({childItems:s.e},{childItems:{itemKeys:new m.e([S],function(e){return e})}}),p[S]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},s.r.pack({itemKey:g})),Object(c.t)({childItems:s.e},{childItems:{itemKeys:new m.e(C,function(e){return e})}})),o.m.pack({onItemCreated:y,onItemCompleted:D,onItemFailed:I})),r.r.pack(!0)),p)}),{itemResolver:O,finalItems:x}},{evaluationContext:e.evaluationContext})),I=D.itemResolver,x=D.finalItems,y(I.execute()),g&&y(g({items:x,progressBatchKey:S})),C=y(Object(_.e)(function(e){return e.demandItemFacet(o.m,S)})),O=y(Object(p.e)(Object(a.__assign)(Object(a.__assign)({},v),{operationTypeFacet:n,items:x}))),w=O.started,E=O.completed,A=O.items,L=function(e){var n=f[e],i=b.serializeTaskKey(t,e,n),r=y(Object(_.e)(function(e){return e.demandItemFacet(o.m,i)}));y(Object(h.e)(Object(a.__assign)({progressItemKey:i,onCreated:null==r?void 0:r.onItemCreated,onStarted:null==r?void 0:r.onItemStarted,onCompleted:null==r?void 0:r.onItemCompleted,onFailed:null==r?void 0:r.onItemFailed},A[e])))},k=0,M=Object.keys(A);k<M.length;k++)P=M[k],L(P);return y(Object(h.e)({progressItemKey:S,started:w,completed:E,onCreated:null==C?void 0:C.onItemCreated,onStarted:null==C?void 0:C.onItemStarted,onCompleted:null==C?void 0:C.onItemCompleted,onFailed:null==C?void 0:C.onItemFailed,isBatch:!0})),[4,E];case 1:return T.sent(),[2]}})})}})}},2109:function(e,t,n){"use strict";n.r(t),n.d(t,"sharedWithMeContextMenuControlHandler",function(){return b});var a=n(0),i=n(360),r=n(238),o=n(458),s=n(677),c=n(1330),d=n(4042),l=n(4127),u=n(337),f=n(8),p=n(3270),m=n(3310),_=!f.t.isActivated("A62AD86A-B7EB-4EF6-A7F2-CC139D544AE7","",""),h={name:"-",key:"divider_1",itemType:u.e.Divider};function b(e,t){return{commands:Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([m.e?i.e:p.t,r.n,r.t],_?[h]:[],!0),[c.e],!1),_?[o.e]:[],!0),[d.e,l.e,s.e],!1)}}},2524:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"e",function(){return a});var a,i={applyPanel:"filtersPane-applyInPanel",pinnedToFiltersPaneChanged:"filtersPane-pinnedToFiltersPaneChanged",showInFiltersPaneChanged:"filtersPane-showInFiltersPaneChangedChanged",sectionInfosChanged:"filtersPane-sectionInfosChanged",canvasFilterChanged:"filtersPane-canvasFilterChanged"};function r(e){return e}!function(e){e[e.none=0]="none",e[e.last3Months=1]="last3Months",e[e.last30Days=2]="last30Days",e[e.last7Days=3]="last7Days",e[e.yesterday=4]="yesterday",e[e.today=5]="today",e[e.tomorrow=6]="tomorrow",e[e.next7Days=7]="next7Days",e[e.next30Days=8]="next30Days",e[e.next3Months=9]="next3Months",e[e.nextYear=10]="nextYear"}(a||(a={}))},2557:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(5),i=new a.e("progressItemOperation",{onItemCreated:a.t,onItemCompleted:a.t,onItemFailed:a.t}),r=new a.e("progressBatchOperation",{onBatchCreated:a.t,onBatchCompleted:a.t,onBatchFailed:a.t,progressRootItemKey:a.t,itemControlHandler:Object(a.n)(i)})},2743:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("bundle")},2810:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a="root",i="me",r="/drive/root:",o=30},2863:function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),function(e){e.AddToOneDrive="AddToOneDrive",e.BrowseFiles="BrowseFiles",e.CloseVault="CloseVault",e.CreateFolder="CreateFolder",e.CreateFile="CreateFile",e.DeleteFile="DeleteFile",e.DeleteFolder="DeleteFolder",e.DownloadFile="DownloadFile",e.DownloadBatch="DownloadBatch",e.GetFile="GetFile",e.RenameFile="RenameFile",e.RenameFolder="RenameFolder",e.OpenVault="OpenVault",e.PopulateRecentFiles="PopulateRecentFiles",e.PopulateSharedWithMe="PopulateSharedWithMe",e.Search="Search",e.UploadFile="UploadFile",e.SaveFile="SaveFile",e.UploadBatch="UploadBatch"}(a||(a={})),function(e){e.ActiveUserOperation="AUO",e.BackgroundOperation="BGO",e.PassiveOperation="PO"}(i||(i={}))},2884:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("convergenceConfigurationFacet")},2950:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(19);function i(e){return new Date(e)}function r(e,t){void 0===t&&(t=!1);var n=new Date(e),i=n.getTimezoneOffset()<0,r=n.getFullYear()+"",o=Object(a.leftPad)(n.getMonth()+1+"",2),s=Object(a.leftPad)(n.getDate()+"",2),c=Object(a.leftPad)(n.getHours()+"",2),d=Object(a.leftPad)(n.getMinutes()+"",2),l=Object(a.leftPad)(n.getSeconds()+"",2),u=(i?"+":"-")+Object(a.leftPad)(i?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+Object(a.leftPad)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?r+"-"+o+"-"+s+"T"+c+":"+d+":"+l+u:r+o+s+"T"+c+d+l+u}},3012:function(e,t,n){"use strict";n.d(t,"e",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"n",function(){return h}),n.d(t,"a",function(){return b}),n.d(t,"i",function(){return g}),n.d(t,"r",function(){return y}),n.d(t,"o",function(){return S});var a=n(0),i=n(1455),r=n(3312),o=n(3311),s=n(81),c=n(111),d=n(133),l=n(3247),u=n(8),f=!u.e.isActivated("DAF1BE9A-8497-4F4F-8797-73EF984441D3","04/05/2022","Fix logic in hasRequiredRole"),p=!u.e.isActivated("A7214F2C-B4A0-4A90-AB59-4F8E4927261F","04/05/2022","Revises hasPermission `isOwner` logic to be self-contained and available to addon-graph consumers (not just odsp-next)"),m=(new c.e("addToOneDrive",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.e}))}),new c.e("canCreateFolder",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.t}))})),_=(new c.e("canCreateLink",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.n}))}),new c.e("canDelete",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.a}))})),h=new c.e("canDownload",function(e,t){return!e.demandItemFacet(d.i,t.itemKey)&&v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.i}))}),b=(new c.e("canInvite",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.r}))}),new c.e("canMove",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.o}))}),new c.e("canUseOfficeLens",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.s}))}),new c.e("canRename",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.c}))})),g=new c.e("canUpload",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.d}))});function v(e,t){var n=t.itemKey,a=t.commandFacet,i=e.demandItemFacet(s.e,n);if(!i)return!1;var r=i.endpoint,c=i.driveId,d=e.demandItemFacet(a,o.e.serialize({endpoint:r,driveId:c}));return!!d&&!!d.roles&&y(e,{itemKey:n,oneOfRequiredRoles:d.roles})}function y(e,t){var n=t.itemKey,a=t.oneOfRequiredRoles,r=function(e,t){if(S(e,t))return["read","write","owner"];var n=e.demandItemFacet(i.e,t);return n&&n.effectiveRoles?n.effectiveRoles:[]}(e,n);return function(e,t){var n=t.oneOfRequiredRoles,a=t.effectiveRoles;if(f)for(var i=0,r=a;i<r.length;i++){var o=r[i];if(n.indexOf(o)>=0)return!0}else for(var o in a)if(o in n)return!0;return!1}(0,{oneOfRequiredRoles:a,effectiveRoles:r})}function S(e,t,n){var a,r,o=e.demandItemFacet(i.e,t);if(p){var c=e.demandItemFacet(s.e,t);if(Object(l.e)(e,{driveItemKey:c}))return!0}else{var d=null===(r=null===(a=null==o?void 0:o.owner)||void 0===a?void 0:a.user)||void 0===r?void 0:r.id;if(n&&d)return n.toUpperCase()===d.toUpperCase()}return!o||!o.effectiveRoles||!(o.owner||o.sharedBy)}},3013:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("driveItemResponse")},3017:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("itemsViewSearch",{getSearchItemKey:a.t,query:a.t,isAvailable:a.t})},3153:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n("react-lib"),i=n(1513),r=n(919),o=n(4),s=n(22),c=n(450),d=n(179),l=n(216),u=n(8),f=n(3237),p=u.e.isActivated("AB1B9B00-C482-451A-A5DA-500AC7533605","1/31/2022","Require Name to be clickable for parent path to be clickable"),m=[];function _(e,t){var n=t.itemKey,d=t.renderer,u=e.demandItemFacet(o.k,n),_=e.demandItemFacet(o.A,null==u?void 0:u.itemKey)||"",b=e.demandItemFacet(f.e,n),g=f.e.evaluate(b)(e,{itemKey:n,displayPathSegments:_?h(_):m,openUrl:_,action:u&&_?Object(l.a)(e,a.createElement(c.e,{itemKey:u.itemKey})):null}),v=g.displayPathSegments,y=void 0===v?m:v,S=g.action,D=g.openUrl;return{renderer:function(e,t,n){var o=d?d(e,t,n):null;return a.createElement(a.Fragment,null,o?a.createElement(a.Fragment,{key:"content"},o):null,y.length>0?a.createElement(s.n,{key:"path",action:S},function(t){var n=t.execute,o=t.isAvailable&&(p||e.isInvokable)?function(e){n({event:e}).catch(function(){}),e.preventDefault(),e.stopPropagation()}:void 0;return a.createElement(i.e,{className:r.e,displayPathSegments:y,parentLink:o?D:void 0,onClick:o})}):null)}}}function h(e){for(var t=[],n=0,a=new d.e(e).segments.slice(1);n<a.length;n++){var i=a[n];try{t.push(decodeURIComponent(i))}catch(e){t.push(i)}}return t}},3172:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(8);function i(e){var t;return a.t.isActivated("70112978-C401-4C01-AC5E-CFB577601CD6","","")?e.parentReference:(null===(t=e.remoteItem)||void 0===t?void 0:t.parentReference)||e.parentReference}},3173:function(e,t,n){"use strict";function a(e){var t;return"PersonalVault"===(null===(t=null==e?void 0:e.sharepointIds)||void 0===t?void 0:t.webRelativeListUrl)&&!!(null==e?void 0:e.containingDrivePolicyScenarioViewpoint)}function i(e){if(!e)return{isLocked:!0,expirationInSeconds:0,root:{}};var t=e.isPolicyMet,n=e.expirationDateTime;return{isLocked:t,expirationInSeconds:Math.floor(Math.max(new Date(n).getTime()-(new Date).getTime(),0)/1e3),root:{}}}n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i})},3226:function(e,t,n){"use strict";n.d(t,"e",function(){return G}),n.d(t,"t",function(){return W});var a=n(0),i=n(133),r=n(4),o=n(7),s=n(81),c=n(1035),d=n(3250),l=n(3013),u=n(2743),f=n(772),p=n(1455),m=n(2),_=new m.e("deletedDateTime"),h=new m.e("deletedFromLocation"),b=n(3251),g=n(239),v=n(363),y=n(172),S=n(50),D=n(1059),I=n(1480),x=n(1055),C=n(1462),O=n(3789),w=n(3172),E=n(1053),A=n(3564),L=n(3404),k=n(264),M=n(4038),P=n(3660),T=n(779),U=n(3790),F=n(3791),H=n(3792),R=n(1489),N=n(312),B=n(8),j=!B.e.isActivated("9744858D-1FBE-4889-99CD-288F9CB2B2B1","06/01/2022","Actively pack undefined `mountPointFacet` + `shortcutItemFacet` in `getDriveItemFacets`"),V=!B.e.isActivated("1AEC6B12-C1F5-40E0-8D77-DDD9B65B3C25","09/15/2022","Disable overriding document library names"),z=!B.e.isActivated("5EDF71CC-AEE3-4FF3-BFC7-E895EB999F8F5","12/09/2022","Add follow facet if Favorites is enabled");function G(e){var t=e.itemKey,n=e.driveItemKey,m=e.driveItem,B=e.endpoint,q=e.parentFolderItemKey,Q=e.shouldReturnShareFacets,Y=void 0===Q||Q,J=m.coverImage,X=m.file,Z=m.fileSystemInfo,$=m.name,ee=m.remoteItem,te=m.root,ne=m.size,ae=m.thumbnails,ie=m.image,re=m.video,oe=m.eTag,se=m.tags,ce=m.photo,de=m.specialFolder,le=m.photoStreamItemSource;return function(e){var Q,ue,fe,pe,me,_e,he=m.lastModifiedDateTime,be=void 0===he?Z&&Z.lastModifiedDateTime||ee&&ee.lastModifiedDateTime:he,ge=m.createdDateTime||Z&&Z.createdDateTime||ee&&ee.createdDateTime,ve=Object(w.e)(m),ye=null==ve?void 0:ve.driveId,Se=null==ve?void 0:ve.driveType,De="personal"===Se,Ie=m.webDavUrl||ee&&ee.webDavUrl,xe=null==ve?void 0:ve["@oneDrive.displayPath"],Ce=null===(me=null===(pe=null==ee?void 0:ee.owner)||void 0===pe?void 0:pe.user)||void 0===me?void 0:me.displayName,Oe=s.e.serialize({endpoint:B,driveId:ye,itemId:null==ve?void 0:ve.id}),we=Z&&Z.lastAccessedDateTime||ee&&ee.fileSystemInfo&&ee.fileSystemInfo.lastAccessedDateTime,Ee=(null==ce?void 0:ce.takenDateTime)||(null==ce?void 0:ce.alternateTakenDateTime),Ae=m.package||(null==ee?void 0:ee.package),Le=ae||(null==ee?void 0:ee.thumbnails),ke=!(null==Le?void 0:Le.length)||void 0===Le[0].isPreAuth,Me=ie||ee&&ee.image,Pe=re||ee&&ee.video,Te=m.shared||ee&&ee.shared,Ue=m.deletedFromLocation,Fe=m.deletedDateTime,He={itemId:m.id,driveId:ye,endpoint:B},Re=Z&&Z.systemPath,Ne=n||ee&&ee.parentReference&&{itemId:ee.id,driveId:ee.parentReference.driveId,endpoint:B}||He,Be=s.e.serialize(Ne),je=Ie&&decodeURIComponent(Ie);_e=("business"===Se||!V&&"documentLibrary"===Se||"personal"===Se)&&te?v.n:$||ee&&ee.name||"";var Ve=m.bundle||(null==ee?void 0:ee.bundle),ze=m.folder||(null==ee?void 0:ee.folder)||Ve,Ge=null!=ne?ne:null==ee?void 0:ee.size,Ke=null==ze?void 0:ze.childCount,We=W(_e,!!ze),qe=We.extension||(null==Ae?void 0:Ae.type),Qe=qe&&Object(O.e)(qe),Ye=m.sharepointIds||ee&&ee.sharepointIds,Je=m.localItem,Xe=m.webUrl||ee&&ee.webUrl,Ze=new N.e({publisher:G});return Ze.resolveItems({items:(Q={},Q[t]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},s.e.pack(Ne)),r.u.pack(_e)),r.L.pack(Ce)),void 0!==Ge?r.m.pack(Ge):{}),r._.pack(ze?{}:void 0)),Xe?r.A.pack(Xe):{}),x.a.pack(Re)),je||Ve?r.i.pack(je):{}),r.c.pack(be?new Date(be).getTime():void 0)),x.e.pack(xe)),r.s.pack(ge?new Date(ge).getTime():void 0)),y.c.pack(Ee?new Date(Ee).getTime():void 0)),we?Object(a.__assign)({},r.o.pack(new Date(we).getTime())):{}),i.i.pack(Ae&&"oneNote"===Ae.type?{}:void 0)),Le?Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},d.e.pack(Le)),L.e.pack(ke)),P.e.pack(Object(T.i)(We.extension))):{}),Object(k.e)().forFacet(y.h).thenInvalidate(Be,d.e).pack()),l.e.pack(m)),oe?r.f.pack(oe):{}),Me&&Me.width&&Me.height?y.d.pack({width:Me.width,height:Me.height}):{}),Me&&!Pe?y.m.pack({}):{}),Pe?y.g.pack({}):{}),o.t.pack({itemKey:c.e.serialize({driveItemKey:Ne,sortBy:"",isAscending:!0})})),r.n.pack({itemKey:f.e.serialize({driveItemKey:Ne})})),r.k.pack(q?{itemKey:q}:Oe?{itemKey:Oe}:void 0)),!De&&Ie?Object(a.__assign)({},r.M.pack(K(Ie))):{}),D.e.pack(Se)),De?Object(a.__assign)({},I.e.pack(m.vault)):{}),De&&m.restricted?Object(a.__assign)({},U.e.pack(m.restricted)):{}),r.p.pack(We)),Y?Object(a.__assign)(Object(a.__assign)({},r.D.pack(!!Te)),p.e.pack(Te)):{}),Je?x.t.pack(Je):{}),"number"==typeof Ke?S.e.pack(Ke):{}),M.e.pack(J)),F.e.pack(se)),H.e.pack(!!le)),x.n.pack(X&&X.mimeType)),Qe?C.e.pack(Qe):{}),Ye?E.e.pack(Ye):{}),de?A.e.pack(de.name):{}),Ue?h.pack(Ue):{}),Fe?_.pack(Fe):{}),r.d.pack(Fe||Ue?{}:void 0)),j?Object(a.__assign)(Object(a.__assign)({},b.e.pack(void 0)),g.e.pack(void 0)):{}),Q)}),Ze.resolveItems({items:(ue={},ue[t]=Object(a.__assign)(Object(a.__assign)({},Ve?u.e.pack(Ve):{}),z?Object(a.__assign)({},r.h.pack({itemKey:R.e.serialize({driveItem:Ne})})):{}),ue)}),z&&Ze.resolveItems({items:(fe={},fe[t]=Object(a.__assign)({},r.h.pack({itemKey:R.e.serialize({driveItem:Ne})})),fe)}),{itemResolver:Ze}}}function K(e){var t=e.split("/");return t.length>2?decodeURIComponent(t[t.length-2]):void 0}function W(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}},3228:function(e,t,n){"use strict";var a=n(272);function i(e){return void 0!==e.action}function r(e){return void 0!==e.activityDateTime}function o(e){var t=g(e).comment;return void 0!==t&&!t.isReply}function s(e){var t=g(e).comment;return void 0!==t&&t.isReply}function c(e){return void 0!==g(e).mention}function d(e){return void 0!==g(e).version}function l(e){return void 0!==g(e).pointInTimeRestore}function u(e){return void 0!==g(e).restoreVersion}function f(e){return void 0!==g(e).move}function p(e){return void 0!==g(e).rename}function m(e){return void 0!==g(e).delete}function _(e){return void 0!==g(e).share}function h(e){var t=g(e).addToOneDrive;return void 0!==t&&!t.removedDateTime}function b(e){var t=g(e).addToOneDrive;return void 0!==t&&!!t.removedDateTime}function g(e){return i(e)?e.action:e}function v(e){return e.driveItem||e.listItem}var y=n(74),S=!n(8).t.isActivated("DC1B3A2B-2469-49B2-9230-7F6CD01BD84C","12/30/2020","Enable deeplinking for comment activities"),D=function(){function e(){}return e.prototype.processResponse=function(e){var t=this,n=e.item,a=e.response;return{isPlaceholder:!1,activities:a.value.map(function(e){if(r(e))if(o(e)||s(e)){var a=g(e).comment;(a.contentId||a.navigationId)&&(e.docDetails={contentId:a.contentId,navigationId:a.navigationId})}else if(c(e)){var i=g(e).mention;(i.contentId||i.navigationId)&&(e.docDetails={contentId:i.contentId,navigationId:i.navigationId})}return t._processActivityResponse(n,e)}),nextRequestToken:this._getNextRequestToken(a),success:!0}},e.prototype.processActivitiesByIntervalResponse=function(e){var t=this;return{activitiesByInterval:e.value.map(function(e){return t._processActivitySummaryResponse(e)}),success:!0}},e.prototype._processActivitySummaryResponse=function(e){return{totalCount:(void 0!==e.create?e.create.actionCount:0)+(void 0!==e.delete?e.delete.actionCount:0)+(void 0!==e.edit?e.edit.actionCount:0)+(void 0!==e.move?e.move.actionCount:0)+(void 0!==e.rename?e.rename.actionCount:0)+(void 0!==e.restore?e.restore.actionCount:0)+(void 0!==e.copy?e.copy.actionCount:0),startDateTime:new Date(e.startDateTime),endDateTime:new Date(e.endDateTime)}},e.prototype._getNextRequestToken=function(e){if(e.value&&!(e.value.length<1)){var t=e["@odata.nextLink"],n=t&&t.match(/skiptoken=([^&]+)/i);return n?n[1]:void 0}},e.prototype._processActivityResponse=function(e,t){var n=this._getItem(e,t),a=this._getParentItem(t),i=this._getAction(e,n,a,t);if(r(t)){var o=t.actor&&t.actor.user,s=o&&{displayName:o.displayName,id:o.id,email:o.email,self:o.self};return{id:t.id,type:this._getActivityType(t),actors:s?[s]:[],item:n,parentItem:a,time:new Date(t.activityDateTime),action:i}}var c=t.actor&&t.actor.user,d=c&&{displayName:c.displayName,email:c.email,self:c.self,userPrincipalName:c.userPrincipalName};return{id:t.id,type:this._getActivityType(t),actors:[d],item:n,parentItem:a,time:t.times.recordedTime?new Date(t.times.recordedTime):new Date(t.times.recordedDateTime),friendlyDisplayTime:t["@sharePoint.localizedRelativeTime"],action:i}},e.prototype._getActivityType=function(e){return(t={Comment:function(){return a.e.comment},CommentResponse:function(){return a.e.commentResponse},Create:function(){return a.e.create},Delete:function(){return a.e.delete},Edit:function(){return a.e.edit},Mention:function(){return a.e.mention},Move:function(){return a.e.move},Rename:function(){return a.e.rename},Restore:function(){return a.e.restore},RestoreVersion:function(){return a.e.restoreVersion},PointInTimeRestore:function(){return a.e.pointInTimeRestore},Share:function(){return a.e.share},Version:function(){return a.e.version},Copy:function(){return a.e.copy},AddShortcutToOneDrive:function(){return a.e.addShortcutToOneDrive},RemoveShortcutFromOneDrive:function(){return a.e.removeShortcutFromOneDrive}},function(e){return c(e)?t.Mention(e):o(e)?t.Comment(e):s(e)?t.CommentResponse(e):function(e){return void 0!==g(e).create}(e)?t.Create(e):m(e)?t.Delete(e):function(e){return void 0!==g(e).edit}(e)?t.Edit(e):f(e)?t.Move(e):p(e)?t.Rename(e):function(e){return void 0!==g(e).restore}(e)?t.Restore(e):u(e)?t.RestoreVersion(e):_(e)?t.Share(e):d(e)?t.Version(e):function(e){return void 0!==g(e).copy}(e)?t.Copy(e):l(e)?t.PointInTimeRestore(e):h(e)?t.AddShortcutToOneDrive(e):b(e)?t.RemoveShortcutFromOneDrive(e):void 0})(e);var t},e.prototype._getItem=function(e,t){var n,a,o=v(t);if(f(t)){if(i(t)){var s=g(t).move;if(s&&s.to)return{name:this._getFileNameFromPath(s.to),isRoot:this._isRootItem(s.to),graphItemUrl:void 0,relativePath:void 0,absolutePath:s.to}}}else if(m(t)&&i(t)){var c=g(t).delete;if(c&&c.name){var d=(a=(n=o&&o.parentReference)&&this._getRelativePathFromVroomPath(n.path))&&o&&a+"/"+o.name+"/"+c.name;return{name:c.name,isRoot:this._isRootItem(c.name),graphItemUrl:void 0,relativePath:d,absolutePath:void 0,isFolder:"Folder"===c.objectType}}}return o?(t.docDetails&&(o.webUrl=this._getNavLink(o,t.docDetails)),d=(a=(n=o&&(o.parentReference||o.remoteItem&&o.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(n.path))&&a+"/"+o.name,m(t)?{name:o.name,isRoot:this._isRootItem(o.name),graphItemUrl:void 0,relativePath:d,absolutePath:void 0}:{name:o.name,isRoot:this._isRootItem(o.name),graphItemUrl:n&&"/drives/".concat(n.driveId,"/items/").concat(o.id),relativePath:d,absolutePath:void 0,driveItem:o,navigationId:this._getNavigationId(t)}):r(t)?void 0:e},e.prototype._getParentItem=function(e){var t=v(e);if(f(e)){var n=g(e).move;if(n&&n.to){var a=this._getDirNameFromPath(n.to),r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference);return{name:this._getFileNameFromPath(a),isRoot:this._isRootItem(a),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(r.id),relativePath:void 0,absolutePath:this._getDirNameFromPath(a),isFolder:!0,driveItem:r&&{id:r.id}}}}else if(m(e)&&t){if(i(e)){var o=(c=(r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(r.path))&&c+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(t.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(r=t&&t.parentReference){o=this._getRelativePathFromVroomPath(r.path);var s=r.name?r.name:o&&this._getFileNameFromPath(o);if(void 0===o||void 0===s||void 0===r.id)return;return{name:s,isRoot:this._isRootItem(s),graphItemUrl:"/drives/".concat(r.driveId,"/items/").concat(r.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:r.id}}}}else{if(u(e)&&t)return o=(c=(r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(r.path))&&c+"/"+name,{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(t.id),relativePath:o,absolutePath:void 0,isFolder:!1,driveItem:t};var c;if(l(e)&&t)return o=(c=(r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(r.path))&&c+"/"+name,{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(t.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t};if(t&&(r=t.parentReference&&t.parentReference)){o=this._getRelativePathFromVroomPath(r.path);var d=r.name?r.name:o&&this._getFileNameFromPath(o);return{name:d,isRoot:this._isRootItem(d),graphItemUrl:"/drives/".concat(r.driveId,"/items/").concat(r.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:r.id}}}}},e.prototype._getNavLink=function(e,t){var n=e.webUrl,a=n&&new y.t(n),i=t.navigationId;return a&&i&&a.setQueryParameter("nav",i),a.toString()||n},e.prototype._getNavId=function(e){return e&&e.navigationId},e.prototype._getNavigationId=function(e){var t,n,a;if(null==e?void 0:e.docDetails)return this._getNavId(e.docDetails);if(S&&o(e)){var i=g(e);return(null===(t=null==i?void 0:i.comment)||void 0===t?void 0:t.navigationId)?null===(n=null==i?void 0:i.comment)||void 0===n?void 0:n.navigationId:null===(a=null==i?void 0:i.comment)||void 0===a?void 0:a.commentId}},e.prototype._getAction=function(e,t,n,a){var i,l={};if(d(a)&&(l.version={newVersion:g(a).version.newVersion}),f(a)){var u=g(a).move;if(r(a)){var m=void 0,v=void 0;u.from&&(m=this._getDirNameFromPath(u.from)),u.to&&(v=this._getDirNameFromPath(u.to)),l.move={from:{name:this._getFileNameFromPath(m),isRoot:this._isRootItem(m),graphItemUrl:void 0,absolutePath:m},to:{name:this._getFileNameFromPath(v),isRoot:this._isRootItem(v),graphItemUrl:void 0,absolutePath:v}}}else if(u.From){var y=this._getDirNameFromPath(u.From);l.move={from:{name:this._getFileNameFromPath(y),isRoot:this._isRootItem(y),graphItemUrl:void 0,absolutePath:y},to:void 0}}else if(u.to){var S=this._getDirNameFromPath(u.to);l.move={from:void 0,to:{name:this._getFileNameFromPath(S),isRoot:this._isRootItem(S),graphItemUrl:void 0,absolutePath:S}}}}if(p(a)){var D=g(a).rename;l.rename={newItem:{name:D.newName,isRoot:this._isRootItem(D.newName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0},oldItem:{name:D.oldName,isRoot:this._isRootItem(D.oldName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0}}}if(s(a)&&(i=g(a).comment).isReply&&(l.commentResponse={commentAuthor:i.parentAuthor&&i.parentAuthor.user}),o(a)&&((i=g(a).comment).isReply||(l.comment={commentId:i.commentId})),c(a)){var I=g(a).mention;l.mention={mentionees:I.mentionees&&I.mentionees.map(function(e){return e.user})||[],commentId:r(a)?I.navigationId:void 0}}if(_(a)){var x=g(a).share;l.share={recipients:x.recipients&&x.recipients.map(function(e){return e.user})||[]}}if(h(a)&&(l.addShortcutToOneDrive={}),b(a)){var C=g(a).addToOneDrive;l.removeShortcutFromOneDrive={mountPointName:C.mountPointName}}return l},e.prototype._getRelativePathFromVroomPath=function(e){if(e)return e.split(":",2)[1]},e.prototype._getDirNameFromPath=function(e){return e&&e.substring(0,e.lastIndexOf("/"))},e.prototype._getFileNameFromPath=function(e){return e&&e.substring(e.lastIndexOf("/")+1)},e.prototype._isRootItem=function(e){return e&&"/LiveFolders"===e},e}();t.e=D},3236:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(0),i=n(240),r=n(3153),o=n(196),s=n(83),c=n(1061),d=n(1076),l=n(1072),u=n(1073),f=n(782),p=n(195),m=n(8).e.isActivated("A8ABE184-9647-42E8-BBAD-7AC7F51995D6","5/20/2022","Fix signals positioning in nameAndPathColumn")?[f.t,r.e]:[r.e,f.t],_=Object(c.e)({key:o.s,name:i.c,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:s.a,data:{facets:Object(a.__assign)({},p.e.pack("nameAndPath"))}},Object(a.__spreadArray)(Object(a.__spreadArray)([d.e],m,!0),[l.e,u.e],!1))},3237:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("itemPathField",{displayPathSegments:a.t,openUrl:a.t,action:a.t})},3247:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(81),i=n(2810);function r(e,t){var n,r=null!==(n=t.driveItemKey)&&void 0!==n?n:{};return r.driveId===function(e,t){var n=t.endpoint;if(n){var r=a.e.serialize({endpoint:n,driveId:i.n,itemId:i.a}),o=e.demandItemFacet(a.e,r,{suppressGetItems:!1});return null==o?void 0:o.driveId}}(e,{endpoint:r.endpoint})}},3250:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("graphThumbnailSet")},3251:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("mountPoint")},3270:function(e,t,n){"use strict";n.d(t,"e",function(){return C}),n.d(t,"t",function(){return O});var a=n(0),i=n("react-lib"),r=n(68),o=n(360),s=n(514),c=n(2261),d=n(1462),l=n(372),u=n(117);Object(u.n)([{rawString:".iconContainer_8aac815c{position:relative;font-size:16px;margin:0 4px;height:16px;width:16px}.brandIcon_8aac815c{position:relative;margin:0 4px;height:16px;width:16px}.brandIcon_8aac815c img{display:block}.menuItemIconContainer_8aac815c{position:relative;margin:0 4px;height:36px;line-height:36px;width:14px}.logoFillIcon_8aac815c,.logoIcon_8aac815c{height:100%;position:absolute;left:0;right:0}.logoFillIcon_8aac815c[data-icon-name=ExcelLogo16],.logoIcon_8aac815c[data-icon-name=ExcelLogo16]{color:#217346}.logoFillIcon_8aac815c[data-icon-name=OneNoteLogo16],.logoIcon_8aac815c[data-icon-name=OneNoteLogo16]{color:#5c2d91}.logoFillIcon_8aac815c[data-icon-name=PowerPointLogo16],.logoIcon_8aac815c[data-icon-name=PowerPointLogo16]{color:#d24726}.logoFillIcon_8aac815c[data-icon-name=WordLogo16],.logoIcon_8aac815c[data-icon-name=WordLogo16]{color:#2b579a}.logoFillIcon_8aac815c[data-icon-name=VisioLogo16],.logoIcon_8aac815c[data-icon-name=VisioLogo16]{color:#3854a2}.logoFillIcon_8aac815c{color:#fff}.contextualMenuItemLinkContent_8aac815c{white-space:nowrap;height:inherit;display:flex;align-items:center;max-width:100%}.contextualMenuItemTextLabel_8aac815c{margin:0 4px;vertical-align:middle;display:inline-block;flex-grow:1;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}"}]);var f=n(17),p=n(54),m=n(4),_=n(3400),h={key:n(1553).e,automationId:"openInOfficeOnlineCommand",action:i.createElement(_.t,null),facets:Object(a.__assign)({},r.t.pack(!0))},b=n(3511),g={key:n(1554).e,automationId:"openInOfficeClientCommand",action:i.createElement(b.t,null),facets:Object(a.__assign)({},r.t.pack(!0))},v=n(2),y=n(1494),S=new v.e("fileHandlerOpenCommand").id,D=Object(f.r)()(Object(f.a)()(Object(p.e)(function(e,t){var n=t.itemKey,a=t.item,i=e.demandItem({appMap:d.e},n).appMap,r=a.name;return a.key===h.key?r=r||(i?Object(l.r)(i,!1):l.e.OpenInBrowser):a.key===g.key&&(r=r||(i?Object(l.o)(i,!0):l.e.Open)),{name:r}})(function(e){return i.createElement("div",{className:"contextualMenuItemLinkContent_8aac815c"},i.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_8aac815c"},e.name))}))),I=Object(f.r)()(Object(f.a)()(Object(p.e)(function(e,t){var n=t.itemKey,i=t.menuProps,r=e.demandItem({appMap:d.e,fileName:m.p},n),o=r.appMap,s=r.fileName,c={};if(i&&i.items){var u=i.items[0];u&&-1!==u.key.indexOf(S)&&u.iconProps&&(c=u.iconProps)}var f=!!s&&!!s.extension&&".pdf"===s.extension.toLowerCase(),p={iconName:o?Object(l.t)(o):f?"PDF":"OpenFile"},_=void 0;return i&&i.items&&(_=i.items.map(function(e){return e.key===h.key?Object(a.__assign)(Object(a.__assign)({},e),{iconProps:p,name:e.name||o&&Object(l.r)(o,!0)||(f?l.e.OpenInBrowser:l.e.Open),onRenderIcon:o?x.bind(void 0,o,!0):void 0}):e.key===g.key?Object(a.__assign)(Object(a.__assign)({},e),{iconProps:p,name:e.name||o&&Object(l.i)(o),onRenderIcon:o?x.bind(void 0,o,!0):void 0}):e})),{iconProps:c||p,onRenderIcon:o?x.bind(void 0,o,!1):void 0,text:l.e.Open,menuProps:_?Object(a.__assign)(Object(a.__assign)({},i),{items:_}):i}})(c.e)));function x(e,t){var n=e&&Object(l.n)(e),a=e&&Object(l.a)(e);return a?i.createElement(y.e,{size:16,extension:"",brand:a.toLowerCase(),className:"brandIcon_8aac815c"}):n?i.createElement("span",{className:t?"menuItemIconContainer_8aac815c":"iconContainer_8aac815c"},i.createElement(s.e,{iconName:n.logoFill16,className:"logoFillIcon_8aac815c"}),i.createElement(s.e,{iconName:n.logo16,className:"logoIcon_8aac815c"})):null}var C={key:o.e.key,automationId:o.e.automationId,subMenuProps:{items:[h,g]},onRender:function(e){return i.createElement(I,Object(a.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(a.__assign)({},r.t.pack(!0))},O={key:o.e.key,automationId:o.e.automationId,name:o.e.name,subMenuProps:{items:[h,g],contextualMenuItemAs:D},facets:Object(a.__assign)({},r.t.pack(!0))}},3310:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=n(8).e.isActivated("EB854331-5340-42D0-8893-9E093DC56A47","03/10/2022","Use standard Open command for Office files")},3311:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(18),r=new a.e("commands",{endpoint:i.e,driveId:i.t})},3312:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"r",function(){return d}),n.d(t,"o",function(){return l}),n.d(t,"s",function(){return u}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return p});var a=n(2),i=new a.e("addToOneDrive"),r=new a.e("createFolder"),o=new a.e("createLink"),s=new a.e("delete"),c=new a.e("download"),d=new a.e("invite"),l=new a.e("move"),u=new a.e("officeLens"),f=new a.e("rename"),p=new a.e("upload")},3400:function(e,t,n){"use strict";n.d(t,"e",function(){return f}),n.d(t,"t",function(){return p});var a=n(0),i=n(2039),r=n(54),o=n(26),s=n(4),c=n(17),d=n(38),l=n(1567),u=n(1462),f=Object(r.e)(function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:s.A,appFacet:u.e,isMalwareDetected:s.O},n),o=r.openUrl,c=r.appFacet,f=r.isMalwareDetected,p=e.demandItemFacet(l.e,n),m=l.e.evaluate(p)(e,{itemKey:n,isAvailable:!f&&!!c&&!!o,forceInSameWindow:!1}),_=m.isAvailable,h=m.forceInSameWindow,b=m.getOpenUrl,g=m.onExecute;return Object(a.__assign)({isAvailable:_,onExecute:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e,t,n;return Object(a.__generator)(this,function(a){return e=null==b?void 0:b(),t=(new Date).getTime().toString(),(n=e||o&&i.e.AddWopiPerfMarkToTargetUrl(t,"ItemsView",o))&&(g&&g(),h?window.location.href=n:window.open(n)),[2]})})}},Object(d.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeOnline",isIntentional:!0}}))})(o.e),p=Object(c.r)()(Object(c.a)()(f))},3404:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("hasThumbnailAuthTokenFacet")},3511:function(e,t,n){"use strict";n.d(t,"e",function(){return g}),n.d(t,"t",function(){return v});var a=n(0),i=n(107),r=n(1528),o=n(54),s=n(26),c=n(17),d=n(38),l=n(4),u=new(n(5).e)("openInOfficeClientAction",{}),f=n(1462),p=n(81),m=n(3012),_=n(1480),h=new i.e,b=function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2]})})},g=Object(o.e)(function(e,t){var n=t.itemKey,i=e.demandItem({key:p.e,appMap:f.e,fileName:l.p,openUrl:l.A,canonicalUrl:l.i,isMalwareDetected:l.O,vault:_.e},n),o=i.key,s=i.appMap,c=i.fileName,g=i.openUrl,v=i.canonicalUrl,S=i.isMalwareDetected,D=i.vault,I=!1,x=b,C=Object(m.r)(e,{itemKey:n,oneOfRequiredRoles:["write","owner"]});if(n){var O=!S&&!!s&&!D&&!!g&&(h.isMac||h.isWindows||h.isIOS||h.isWinPhone||h.isAndroid),w=e.demandItemFacet(u,n),E=u.evaluate(w)(e,{itemKey:n,isAvailable:O,protocolCallback:y}),A=E.protocolCallback,L=E.isAvailable;I=O&&L,o&&I&&(x=function(e){var t=this,n=e.key,i=e.openUrl,o=e.canonicalUrl,s=e.canEdit,c=e.appMap,d=e.fileName,l=e.isNew,u=e.defaultLocation,f=e.protocolCallback;return function(){return Object(a.__awaiter)(t,void 0,void 0,function(){var e,t;return Object(a.__generator)(this,function(a){return n?(e=!!s,t=function(){i&&window.open(i)},Object(r.e)({app:c||"",itemUrl:o||"",extension:d&&d.extension||"",shouldEdit:e,isNew:Boolean(l),defaultLocation:u||"",platformDetection:h,onNavigate:f,onFailureCallback:t}),[2]):[2]})})}}({key:o,openUrl:g,canonicalUrl:v,canEdit:C,appMap:s,fileName:c,protocolCallback:A}))}return Object(a.__assign)({isAvailable:I,onExecute:x},Object(d.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeClient",isIntentional:!0}}))})(s.e),v=Object(c.r)()(Object(c.a)()(g));function y(e){window.location.href=e}},3564:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("specialFolder")},3565:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(18),r=new a.e("thumbnailToken",{endpoint:i.e,driveId:i.t})},3646:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(18),r=new a.e("userByEmail",{email:i.e,endpoint:i.e})},3651:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(1532),i=n(281),r={key:"OpenFileLocation",name:i.i,title:i.i,action:a.t,iconProps:{iconName:"FabricFolder"}}},3660:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("hasPdfFacet")},3661:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("thumbnailAccessToken")},3662:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("passwordProtectedErrorFacet")},3663:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(18),r=new a.e("currentUserKey",{endpoint:i.e})},3765:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("deleteProgress",{commands:a.t,description:a.t})},3789:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(894);function i(e){var t=e.replace(".",""),n=Object.keys(a.e);for(var i in n)if(a.e.hasOwnProperty(n[i])){var r=n[i];if(a.e[r].indexOf(t)>-1)return r}}},3790:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("restricted")},3791:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("tags")},3792:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("isPhotoStreamItem")},3794:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(23),i=n(407),r=n(81),o=new a.e("driveItemUnauthenticatedThumbnail",{driveItemKey:r.e.subKeyPart,width:i.e,height:i.e})},4038:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("coverImage")},4040:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("isUnauthenticatedConfiguration")},4041:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(8),i=function(){return a.e.isActivated("8B2678E4-71A6-4034-A604-01CE2E306BA6","07/28/2022","Use getItemThumbnailOperation to get thumbnail blob for each item")}},4042:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(55),i=n(2),r=n("react-lib"),o=n(281),s=n(798),c={action:r.createElement(a.t,null,r.createElement(s.t,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:o.c,iconProps:{iconName:"FabricFolderLink"},key:new i.e("RemoveShortcutFromSWM").id,name:o.s}},4127:function(e,t,n){"use strict";n.d(t,"e",function(){return w});var a=n("react-lib"),i=n(55),r=n(0),o=n(54),s=n(44),c=n(148),d=n(22),l=n(26),u=n(17),f=n(1662),p=n(1963),m=n(1315),_=Object(p.e)({operationTypeFacet:m.t,progressKeyFacet:m.e}),h=n(38),b=n(223),g=n(8),v=Object(o.t)(function(e,t){var n=t.itemKeys,i=t.removeFromSharedListWizard,o=t.removeItemsFromSharedList,u=void 0===o?_:o,p=Object(s.e)(e)||"",m=e.demandItemFacet(b.e,p);if(0===n.length)return null;for(var v=m&&n.length<=200,y=i,S=0,D=n;S<D.length;S++){var I=D[S],x=e.demandItemFacet(f.e,I),C=g.t.isActivated("6c28a705-1f14-4f06-97c7-ee39b2d66e9e","11/5/2020","Action should be available unless otherwise stated in control handler");f.e.evaluate(x)(e,{itemKey:I,isAvailable:!C}).isAvailable||(v=!1)}var O=e.dispatch,w=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return e={itemSetKey:p},t=Object(c.e)(n,function(){return e}),[4,O(u({items:t}))];case 1:return a.sent(),[2]}})})},E=Object(d.o)(function(e){return a.createElement(y,Object(r.__assign)({},e,{onItemRemoved:w,itemKeys:n}))});return a.createElement(l.e,Object(r.__assign)({isAvailable:v,onExecute:E},Object(h.t)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:n.length}}})))}),y=Object(u.r)()(v),S=n(158),D=n(152),I=Object(S.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(597)]).then(n.bind(null,5318))];case 1:return[2,e.sent().RemoveFromSharedListWizard]}})})}),x=Object(D.t)(function(e){return function(t){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var a;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(597)]).then(n.bind(null,5318))];case 1:return a=i.sent().removeItemsFromSharedListWithProgress,[4,t(a(e))];case 2:return[2,i.sent()]}})})}}),C=Object(o.e)(function(){return{removeFromSharedListWizard:I,removeItemsFromSharedList:x}})(y),O=n(281),w={key:new(n(2).e)("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:O.l,action:a.createElement(i.t,null,a.createElement(C,null)),iconProps:{iconName:"Cancel"}}},4207:function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return i}),function(e){e[e.MalwareDetected=0]="MalwareDetected",e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut",e[e.DLPBlocked=2]="DLPBlocked",e[e.MissingMetaData=3]="MissingMetaData",e[e.DLPWarning=4]="DLPWarning",e[e.AwaitingApproval=5]="AwaitingApproval",e[e.Trending=6]="Trending",e[e.New=7]="New",e[e.NeedsRepublishing=8]="NeedsRepublishing"}(a||(a={})),function(e){e[e.Mail=0]="Mail",e[e.CalendarEvent=1]="CalendarEvent",e[e.Teams=2]="Teams"}(i||(i={}))},4224:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(196),r=n(240),o=n(3153),s=n(1061),c=n(83),d=n(195),l=Object(s.e)({key:i.c,name:r.d,fieldName:"",isCollapsible:!1,minWidth:c.e.regularMin,maxWidth:c.e.displayNameMax,sortProps:void 0,isResizable:!0,data:{facets:Object(a.__assign)({},d.e.pack("path"))}},[o.e])},4227:function(e,t,n){"use strict";function a(e){return"."===e[0]}n.d(t,"e",function(){return a})},4228:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=n(213).n.isFeatureEnabled({ODC:"EnableDefaultSortOrderFromBackend"})},4229:function(e,t,n){"use strict";n.d(t,"e",function(){return I}),n.d(t,"t",function(){return x});var a=n(0),i=n(4),r=n(133),o=n(81),s=n(3250),c=n(3565),d=n(3661),l=n(3404),u=n(3013),f=n(671),p=n(179),m=n(396),_=n(269),h=n(8),b=n(1103),g=n(3794),v=n(172),y=n(4041),S=h.e.isActivated("AB808229-F141-4F5A-B7E9-C1DEF8EC6F64","10/21/2021","Enable crop mode for folder cover thumbnail"),D=h.e.isActivated("75843FC5-8F0A-4925-BB0B-AA5FCE46444C","02/07/2022","Enable various thumbnail fixes in ItemResultProcessor and addon-graph ItemThumbnailControl");function I(e,t){var n=t.itemKey,h=t.desiredSize,S=t.fitMode,I=t.requestOptions,C=e.demandItemFacet(o.e,n);if(!C)return{};var O=e.demandItemFacet(l.e,n)?function(e,t){var n=t.itemKey,a=t.desiredSize,i=t.fitMode,r=x(e.demandItemFacet(s.e,n));if(r&&r.large){var o=e.demandItemFacet(u.e,n),c=o&&(o["@microsoft.graph.downloadUrl"]||o["@content.downloadUrl"]),d=Object(b.e)(e,{itemKey:n});return{url:E(d&&c||r.large.url,a,i,d),width:0,height:0}}}(e,{itemKey:n,driveItem:C,desiredSize:h,fitMode:S}):function(e,t){var n,o,s=t.itemKey,l=t.driveItem,u=t.desiredSize;if(!D){var h=!!e.demandItemFacet(i._,s),b=!!e.demandItemFacet(r.i,s);if(h||b)return}if(!Object(y.e)()&&!(null===(n=t.requestOptions)||void 0===n?void 0:n.allowsHeaders))return function(e,t){var n=t.driveItem,a=t.desiredSize,i=Math.ceil(a.width),r=Math.ceil(a.height),o=g.e.serialize({driveItemKey:{driveId:n.driveId,itemId:n.itemId,endpoint:n.endpoint},width:i,height:r}),s=e.demandItemFacet(v.h,o);return s?{url:s.url,height:i,width:r}:void 0}(e,{driveItem:l,desiredSize:u});var S,I,x=e.demandItemFacet(i.f,s,{suppressGetItems:!0})||"",C=new p.e(l.endpoint).authority;if(D)I=l.endpoint.indexOf("/_api/v2.")>-1,S="".concat(C,I?"/_api/v2.1":"/v1.0");else{I=l.endpoint.indexOf("/v2.")>-1;var O=Object(f.a)(e,l.endpoint);S="".concat(C,I&&!O?"/_api/v2.1":"/v1.0")}var w=c.e.serialize({endpoint:S,driveId:l.driveId}),E=e.demandItemFacet(d.e,w);if(E){var A=Object(m.t)({endpoint:S,driveId:l.driveId,itemId:l.itemId}),L=Math.ceil(u.width),k=Math.ceil(u.height),M="".concat(A,"/thumbnails/0/c").concat(L,"x").concat(k,"/content"),P={prefer:"noredirect,closestavailablesize",cb:x};if(I||!D){var T=Object(a.__assign)(Object(a.__assign)({},P),{access_token:{uriValue:E}});return{url:"".concat(M,"?").concat(Object(_.e)(T)),width:L,height:k}}if(null===(o=t.requestOptions)||void 0===o?void 0:o.allowsHeaders){var U={Authorization:"bearer ".concat(E)};return{url:"".concat(M,"?").concat(Object(_.e)(P)),width:L,height:k,headers:U}}}}(e,{itemKey:n,driveItem:C,desiredSize:h,requestOptions:I});return O?{thumbnail:O}:{}}function x(e){return e&&(t=e)&&"number"==typeof t.length?e[0]:e;var t}var C=/width=[0-9]*/,O=/height=[0-9]*/,w=/cropmode=[a-z]*/;function E(e,t,n,a){if(a)return e;if(!S){var i="cover"===n?"center":"none";w.test(e)?e=e.replace(w,"cropmode=".concat(i)):e+="".concat(e.indexOf("?")>-1?"&":"?","cropmode=").concat(i)}var r="number"==typeof t.width?Math.ceil(t.width):t.width,o="number"==typeof t.height?Math.ceil(t.height):t.height,s="".concat(r||"");C.test(e)?e=e.replace(C,"width=".concat(s)):e+="".concat(e.indexOf("?")>-1?"&":"?","width=").concat(s);var c="".concat(o||"");return O.test(e)?e=e.replace(O,"height=".concat(c)):e+="".concat(e.indexOf("?")>-1?"&":"?","height=").concat(c),e}},4230:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("moveCopyProgress",{commands:a.t,description:a.t})},4463:function(e,t,n){"use strict";n.r(t),n.d(t,"recentContextMenuControlHandler",function(){return f});var a=n(360),i=n(238),r=n(677),o=n(3651),s=n(337),c=n(3270),d=n(3310),l={name:"-",key:"divider_1",itemType:s.e.Divider},u=[d.e?a.e:c.t,o.e,l,i.n,i.t,r.e];function f(e,t){return{commands:u}}},4686:function(e,t,n){"use strict";n.d(t,"e",function(){return m}),n.d(t,"t",function(){return _});var a,i=n(0),r=n(116);!function(e){e[e.MalwareDetected=0]="MalwareDetected",e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut",e[e.DLPBlocked=2]="DLPBlocked",e[e.MissingMetaData=3]="MissingMetaData",e[e.DLPWarning=4]="DLPWarning",e[e.AwaitingApproval=5]="AwaitingApproval",e[e.Trending=6]="Trending",e[e.New=7]="New",e[e.NeedsRepublishing=8]="NeedsRepublishing"}(a||(a={}));var o=n(1432),s=n(41),c=n(669),d=n(553),l=n(2950),u=6e3,f="/_layouts/15/userphoto.aspx?size=S&accountname=",p="v2.1",m=function(){function e(e,t){this._eTagMap={},this._dataRequestor=t.vroomDataRequestor;var n=t.getProfileImageUrl,a=void 0===n?function(e){return Object(o.getUserPhotoUrl)(e)}:n,i=t.caller,r=void 0===i?"hovercard":i,s=t.useSharePointApi,c=void 0!==s&&s;this._getProfileImageUrl=a,this._caller=r,this._useSharePointApi=c}return e.prototype.getItemAnalytics=function(e,t){void 0===t&&(t={});var n=t.apiVersion,a=void 0===n?p:n,i=t.skipToken,o=void 0===i?"":i,s=t.headers,c=void 0===s?{Caller:this._caller}:s,d=o?";$skiptoken=".concat(o):"",l=e.queryType?"_".concat(e.queryType):"",u="GetItemAnalytics".concat(a).concat(l,"_WithGuestUser"),f=this._getBaseUrl(e);if(!f)return r.n.resolve();var m="".concat(f,"/analytics/allTime?$expand=activities"),_="".concat(m).concat("($filter=access%20ne%20null)").concat(d);return this._getAnalytics(u,_,!1,e,c)},e.prototype.getAnalyticsSections=function(e,t){if(void 0===t&&(t={}),this._useSharePointApi)return r.n.reject(void 0);var n=t.headers,a=void 0===n?{Caller:this._caller}:n,i=this._getBaseUrl(e);if(!i)return r.n.resolve();var o="$select=*".concat(",id,reactions").concat(",malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention"),s="".concat(o,"&").concat("$expand=insights($expand=keyPoints)"),c=this._useSharePointApi?"".concat(i,"/driveItem?").concat(s):"".concat(i,"?").concat(s);return this._getAnalytics("GetAnalyticsSections_WithReaction_WithKeyPoints_WithLifeCycle",c,!0,e,a)},e.prototype.getItemAnalyticsSections=function(e,t){void 0===t&&(t={});var n="$expand=analytics($expand=allTime($expand=activities($filter=access%20ne%20null)))",a=this._getBaseUrl(e);if(!a)return r.n.resolve();var i=t.apiVersion,o=void 0===i?p:i,s=t.headers,c=void 0===s?{Caller:this._caller}:s,d=e.queryType?"_".concat(e.queryType):"";if(this._useSharePointApi){var l="GetItemAnalyticsSharePoint".concat(o).concat(d),u="".concat(a,"/driveItem?").concat(n);return this._getAnalytics(l,u,!0,e,c)}var f="GetItemAnalyticsSections".concat(o).concat(d,"_WithGuestUser_WithReaction_WithKeyPoints_WithLifeCycle"),m="$select=*".concat(",id,reactions").concat(",malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention"),_="".concat(m,"&").concat(n).concat(",insights($expand=keyPoints)"),h="".concat(a,"?").concat(_);return this._getAnalytics(f,h,!0,e,c)},e.prototype.getLastSevenDaysItemAnalytics=function(e){var t=this._getBaseUrl(e),n={Caller:this._caller};if(!t)return r.n.resolve();var a="".concat(t,"/analytics/lastSevenDays?$expand=activities($filter=ActivityType%20eq%20%27Access%27)");return this._getAnalytics("GetLastSevenDaysItemAnalytics",a,!1,e,n)},e.prototype.getItemAnalyticsByInterval=function(e,t,n,a){var i=p,r=t.toISOString(),o=n.toISOString(),s=this._getBaseUrl(e)||"",c=this._getAnalyticsByIntervalPath(s,i,r,o,a);return this._getAnalyticsByInterval("GetDailyItemAnalytics",c,e.getAccessToken&&e.getAccessToken(),i)},e.prototype._getAnalytics=function(e,t,n,a,r,o){var s=this;return this._dataRequestor.send({apiName:e,path:t,accessToken:a.getAccessToken&&a.getAccessToken(),headers:r,timeout:u,qosExtraData:{Caller:this._caller}}).then(function(e){return"string"==typeof e.isTrending&&"True"===e.isTrending||"boolean"==typeof e.isTrending&&!0===e.isTrending?e.isTrending=!0:e.isTrending=!1,e.eTag&&(s._eTagMap[a.itemId]=e.eTag),n?_(e,s._getProfileImageUrl):function(e,t){var n=e.activities,a=e.access,r=e.endDateTime,o=Object(i.__rest)(e,["activities","access","endDateTime"]);return{activities:b(n,t),incompleteData:o.incompleteData,startDateTime:o.startDateTime,skipToken:o.skipToken,isTrending:o.isTrending,viewCount:a&&a.actionCount,viewerCount:a&&a.actorCount,lastActivityDateTime:r}}(e,s._getProfileImageUrl)})},e.prototype.updateItemKeyPoints=function(e,t){var n=this,a="".concat(this._getBaseUrl(e),"/insights/keyPoints");return this._dataRequestor.send({path:a,apiName:"UpdateKeyPoints",requestType:"POST",headers:{Caller:this._caller,"if-Match":this._eTagMap[e.itemId]},postData:JSON.stringify({value:t}),accessToken:e.getAccessToken&&e.getAccessToken(),timeout:u,qosExtraData:{Caller:this._caller},parseResponse:function(t){return n._eTagMap[e.itemId]=t.getResponseHeader("eTag")||"",JSON.parse(t.responseText)}}).then(function(e){return e.value})},e.prototype._getAnalyticsByInterval=function(e,t,n,a){return this._dataRequestor.send({apiName:e,path:t,accessToken:n,useAuthorizationHeaders:this._useSharePointApi,timeout:u,qosExtraData:{Caller:this._caller}}).then(function(e){var t;return"v2.1"===a?(e=e)&&e.value&&(t=e.value.map(g)):t=(e=e).Items,t})},e.prototype._getBaseUrl=function(e){return e&&e.graphItemUrl?"".concat(e.graphItemUrl):null},e.prototype._getAnalyticsByIntervalPath=function(e,t,n,a,i){var r;i=i||"day";var o="v2.1"===t?"oneDrive.getActivitiesByInterval":"getanalyticsbyinterval";return r=this._useSharePointApi?"interval='".concat(i,"',startDateTime='").concat(n,"',endDateTime='").concat(a,"'"):"v2.1"===t?"startDateTime=".concat(n,"&endDateTime=").concat(a,"&interval=").concat(i):"startDateTime='".concat(n,"'&endDateTime='").concat(a,"'&interval='").concat(i,"'"),this._useSharePointApi?"".concat(e,"/oneDrive.getActivitiesByInterval(").concat(r,")"):"".concat(e,"/").concat(o,"?").concat(r)},e.prototype.getFilesAnalytics=function(e,t,n){var a=this;return e&&t?this._dataRequestor.send({apiName:"getFilesAnalytics.byItems",useAuthorizationHeaders:!0,accessToken:n,apiVersion:"v2.1",path:"".concat(t,"/items?$expand=analytics($expand=lastSevenDays)&$filter=sharepointIds/listItemUniqueId eq '").concat(e.join("' or sharepointIds/listItemUniqueId eq '"),"'"),postProcessQos:this._overrideFilesAnalyticsExpectedFailure}).then(function(e){return a._parseFilesAnalyticsResponse(e)}):r.n.resolve()},e.prototype.getRecommendedActions=function(e){var t="".concat(this._getBaseUrl(e)).concat("?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities))");return this._dataRequestor.send({apiName:"RecommendedActions",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:u,parseResponse:function(e){return JSON.parse(e.responseText).recommendedActionSet},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})},e.prototype.getShareWith=function(e){var t="".concat(this._getBaseUrl(e)).concat("/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'");return this._dataRequestor.send({apiName:"ShareWith",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:u,parseResponse:function(e){return JSON.parse(e.responseText).value},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})},e.prototype._overrideFilesAnalyticsExpectedFailure=function(e,t){var n=t?Object(c.t)(t,function(e){if("notSupported"===e)return{resultType:s.t.ExpectedFailure}}):{};return Object(i.__assign)(Object(i.__assign)({},e),n)},e.prototype._parseFilesAnalyticsResponse=function(e){var t=this,n=(e.value,Object(i.__rest)(e,["value"])),a=e.value.map(function(e){var n=e.analytics,a=Object(i.__rest)(e,["analytics"]);return Object(i.__assign)(Object(i.__assign)({},a),{analytics:{lastSevenDays:h(n.lastSevenDays,t._getProfileImageUrl)}})});return Object(i.__assign)(Object(i.__assign)({},n),{value:a})},e}();function _(e,t){var n=e&&e.analytics&&e.analytics.allTime,i=n&&n.access,r=n&&n.endDateTime,o=b(n&&n.activities,t),s=function(e){var t,n,i,r=[];return e.malware&&r.push({status:a.MalwareDetected}),e.publication&&e.publication.level.indexOf("checkout")>-1&&r.push({status:a.ThisFileIsCheckedOut,userCheckedOutThis:e.publication.checkedOutBy&&e.publication.checkedOutBy.user}),e.dataLossPrevention&&(e.dataLossPrevention.block?r.push({status:a.DLPBlocked}):e.dataLossPrevention.notify&&r.push({status:a.DLPWarning})),e.metadataMissing&&r.push({status:a.MissingMetaData}),e.awaitingApproval&&r.push({status:a.AwaitingApproval}),e.trending&&r.push({status:a.Trending}),e.createdDateTime&&(t=new Date(e.createdDateTime),n=(new Date).getTime(),i=t&&t.valueOf(),!isNaN(i)&&n-i<1728e5&&r.push({status:a.New,createdRelativeTime:Object(d.n)(Object(l.t)(e.createdDateTime)),creator:e.createdBy&&e.createdBy.user})),r}(e),c=function(e){var t=e&&e.insights,n=t&&t.keyPoints;return t&&{readTime:t.readTime,keyPoints:n}}(e),u=e&&e.reactions;return{activities:o||[],incompleteData:n&&n.incompleteData,startDateTime:n&&n.startDateTime,skipToken:n&&n.skipToken,isTrending:n&&n.isTrending,viewCount:i&&i.actionCount,viewerCount:i&&i.actorCount,commentCount:u&&u.commentCount,likeCount:u&&u.likeCount,lifeCycleStatus:s,keyPointsData:c,lastActivityDateTime:r,createdBy:e.createdBy&&e.createdBy.user,createdDateTime:e.createdDateTime}}function h(e,t){e.activities;var n=Object(i.__rest)(e,["activities"]),a=e.activities&&e.activities.map(function(e){var n=Object(i.__rest)(e,[]),a=n.actor&&n.actor.user&&n.actor.user.email;return n.activityDateTime=Object(d.n)(Object(l.t)(n.activityDateTime)),n.actor.user.image=t&&t(n.actor.user.email)||"".concat(f).concat(a),n});return Object(i.__assign)(Object(i.__assign)({},n),{activities:a})}function b(e,t){return e&&e.map(function(e){var n=Object(i.__rest)(e,[]),a=n.actor&&n.actor.user&&n.actor.user.email,r=Object(i.__assign)(Object(i.__assign)({},n.actor.user),{image:t?t(a):"".concat(f).concat(a),userType:n.actor.user.userType});return Object(i.__assign)(Object(i.__assign)({},n),{activityDateTime:Object(d.n)(Object(l.t)(n.activityDateTime)),actor:Object(i.__assign)(Object(i.__assign)({},n.actor),{location:n.location,user:r}),activityType:n.access?"Access":"Edit"})})}function g(e){return e&&{activity:{},incompleteData:{missingDataBeforeDateTime:e.endDateTime,wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},isTrending:e.isTrending,startDateTime:e.startDateTime,viewCount:e.access&&e.access.actionCount,viewerCount:e.access&&e.access.actorCount}}},4699:function(e,t,n){"use strict";n.r(t),n.d(t,"graphSharesAddon",function(){return S});var a=n(6),i=n(288),r=n(437),o=n(1060),s=n(0),c=n(671),d=n(396),l=n(81),u=n(3226),f=n(7),p=n(1035),m=n(312),_=n(349),h=n(169),b=n(57),g=n(179),v=n(8).e.isActivated("DBA99941-AB2F-497E-8E0F-5FFDE50EDC04","02/03/2023","Allow endpoint redirect in getSharesItem"),y=Object(a.i)({maxParallelOperationCount:8})(function e(t){var n=this,a=t.itemKey,i=o.e.deserialize(a),r=i.endpoint;return function(t){return Object(s.__awaiter)(n,void 0,void 0,function(){var n,o,y,S,D,I,x,C,O,w,E,A,L,k,M,P,T,U,F,H,R;return Object(s.__generator)(this,function(N){switch(N.label){case 0:return n=t(Object(h.e)({graphEndpoint:b.y,graphRecentEndpoint:b.I})),o=n.graphEndpoint,y=n.graphRecentEndpoint,[4,t(Object(c.t)(Object(s.__assign)({url:"".concat(Object(d.a)(i),"?$expand=thumbnails&select=*,webDavUrl"),qosName:"getSharesItem",endpoint:r,headers:{Prefer:"redeemSharingLinkIfNecessary"}},v?{}:{allowEndpointRedirect:!0})))];case 1:return S=N.sent(),D=new m.e({publisher:e}),I=S&&S.parentReference,x=I&&I.driveId,C=S&&S.webDavUrl,!v&&C&&(O=new g.e(C).authority,w=new g.e(r),E=w.authority,A=w.path,E!==O&&(r="".concat(O).concat(A))),L={endpoint:r,driveId:x,itemId:S.id},k=l.e.serialize(L),M=I&&I.id?l.e.serialize({endpoint:r,driveId:x,itemId:I.id}):void 0,D.merge(t(Object(u.e)({itemKey:k,driveItem:S,endpoint:r,parentFolderItemKey:M})).itemResolver),P=t(Object(h.e)({processDriveItemFromSharePoint:b.k})).processDriveItemFromSharePoint,T=r.indexOf("/_api/v2.0")>-1||r.indexOf("/_api/v2.1")>-1,U=o||y,P&&(T||U)&&(F=t(P.process({itemKey:k,driveItem:S})).itemResolver,D.merge(F)),D.resolveItems({items:(H={},H[k]=Object(s.__assign)(Object(s.__assign)({},_.n.pack(l.e)),f.t.pack({itemKey:p.e.serialize({driveItemKey:L,sortBy:"",isAscending:!0})})),H)}),D.mapKeys({mappings:(R={},R[k]=a,R)}),t(D.execute()),[2]}})})}}),S=Object(a.t)(function(){return function(e){e(Object(i.a)(o.e,r.e)(y))}})},5439:function(e,t,n){"use strict";n.r(t),n.d(t,"graphAddon",function(){return Rs});var a=n(0),i=n(6),r=n(1728),o=n(1825),s=n(288),c=n(1767),d=n(223),l=n(396),u=n(671),f=n(169),p=n(264),m=n(7),_=n(23),h=n(18),b=new _.e("driveItemPage",{endpoint:h.e,setItemKey:h.e,token:h.e}),g=n(312),v=n(316),y=n(323),S=n(57),D=n(252),I=n(41),x=n(179),C=n(3226),O=n(81),w=n(4),E=n(1066),A=n(1465),L=n(231),k=n(2),M=new k.e("sharedBy"),P=n(3646);function T(e){var t=e.itemKey,n=e.driveItemKey,i=e.parentFolderItemKey,r=e.setItemKey,o=e.driveItemResponse,s=e.endpoint,c=e.getDriveItemFacets,d=void 0===c?C.e:c,l=e.shouldInvalidateItemSetOnChildItemRename,u=void 0===l?void 0:l;return function(e){var c,l,f,_,h,b,v,y=new g.e({publisher:T}),S=E.e.serialize({driveItemKey:n}),D=void 0;if(r){var I=Object(p.e)().forFacet(w.d).thenInvalidate(r,m.e).forFacet(w.k).thenInvalidate(r,m.e);u&&!u(s)||(I=I.forFacet(w.u).thenInvalidate(r,m.e)),D=I.pack()}y.merge(e(d({itemKey:t,driveItemKey:n,driveItem:o,endpoint:s,parentFolderItemKey:i,setItemKey:r})).itemResolver),y.resolveItems({items:(c={},c[t]=Object(a.__assign)(Object(a.__assign)({},w.e.pack({itemKey:S})),D),c)});var x=null!==(l=o.lastModifiedBy)&&void 0!==l?l:null===(f=o.remoteItem)||void 0===f?void 0:f.lastModifiedBy;if(x&&(null==(F=x.user)?void 0:F.email)){var C=P.e.serialize({email:F.email,endpoint:s}),O=U({itemKey:t,personFacet:w.E,userKey:C,user:F}).itemResolver;y.merge(O)}var L=null!==(_=o.createdBy)&&void 0!==_?_:null===(h=o.remoteItem)||void 0===h?void 0:h.createdBy;if(L&&(null==(F=L.user)?void 0:F.email)){var k=P.e.serialize({email:F.email,endpoint:s});O=U({itemKey:t,personFacet:A.a,userKey:k,user:F}).itemResolver,y.merge(O)}if(null===(b=o.remoteItem)||void 0===b?void 0:b.shared){var F,H=null!==(v=o.remoteItem.shared.sharedBy)&&void 0!==v?v:o.remoteItem.shared.owner;if(null==(F=null==H?void 0:H.user)?void 0:F.email){var R=P.e.serialize({email:F.email,endpoint:s});O=U({itemKey:t,personFacet:M,userKey:R,user:F}).itemResolver,y.merge(O)}}return{itemResolver:y}}}function U(e){var t,n,i=e.itemKey,r=e.personFacet,o=e.userKey,s=e.user,c=new g.e({publisher:U});return c.resolveItems({items:Object(a.__assign)((t={},t[o]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(s.displayName)),L.e.pack(s.email)),L.i.pack(s.id)),t),r&&(n={},n[i]=Object(a.__assign)({},r.pack({itemKey:o,displayValue:s.displayName})),n))}),{itemResolver:c}}var F=n(2810),H=new _.e("driveItem",{endpoint:h.e,driveId:h.t,canonicalUrl:h.e}),R=n(2884);function N(e){var t=e.driveItemResponse,n=e.endpoint,i=e.getDriveItemFacets,r=void 0===i?C.e:i;return function(i){var o,s,c,d=t.remoteItem,l=d&&d.parentReference,u=t.parentReference,p=u||l,m=p&&p.driveId,_=p&&p.id,h="personal"===(p&&p.driveType),b=!!t.root,g=i(Object(f.e)({convergenceConfiguration:R.e})).convergenceConfiguration;d?(c=d.id,l&&(m=l.driveId)):c=h&&t.root?F.a:t.id;var v={endpoint:m&&(null==g?void 0:g.getVroomEndpoint(m))||n,driveId:m,itemId:c},y=O.e.serialize(v),S=t&&(t.webDavUrl||t.webUrl),D=h&&p&&p.path===F.e?F.a:_||void 0,I=p&&D?O.e.serialize({endpoint:n,driveId:p.driveId||m,itemId:D}):void 0,C=[],E="";if(!h&&S){var A=new x.e(S);C.push.apply(C,A.path.split("/").slice(1,-1).map(function(e){return decodeURIComponent(e)})),C.unshift(A.authority),E=C.join("/")}p&&!b&&!D&&E&&(I=H.serialize({endpoint:n,driveId:p.driveId,canonicalUrl:E}));var L=i(T(Object(a.__assign)(Object(a.__assign)({},e),{itemKey:y,driveItemKey:v,parentFolderItemKey:I}))).itemResolver;if(L.resolveItems({items:Object(a.__assign)({},I&&(o={},o[I]=Object(a.__assign)({},E?w.A.pack(E):{}),o))}),d&&l){var k=O.e.serialize({endpoint:n,driveId:u&&u.driveId,itemId:t.id}),M=O.e.serialize({endpoint:n,driveId:l.driveId,itemId:d.id});L.mapKeys({mappings:(s={},s[k]=M,s)}),L.merge(i(r({itemKey:M,driveItem:t,endpoint:n})).itemResolver)}return{itemResolver:L,actualDriveItemKey:v,actualItemKey:y}}}var B=n(150),j=n(50),V=n(1766),z=n(133),G=n(1035),K=n(3250),W=n(3013),q=n(3251),Q=n(239),Y=n(772),J=n(1455),X=n(363),Z=n(172),$=n(1059),ee=n(1480),te=n(1055),ne=n(1462),ae=n(3789),ie=n(1053),re=n(3564),oe=n(3404),se=n(2743),ce=n(4038),de=n(3660),le=n(779),ue=n(3791),fe=n(3792),pe=n(425),me=n(3790),_e=n(3173);function he(e){var t=e.itemKey,n=e.driveItemKey,i=e.driveItem,r=e.endpoint,o=e.parentFolderItemKey,s=e.shouldReturnShareFacets,c=void 0===s||s,l=e.setItemKey,u=i.coverImage,f=i.file,_=i.fileSystemInfo,h=i.name,b=i.parentReference,v=i.lenses,y=i.remoteItem,S=i.root,D=i.size,I=i.thumbnails,x=i.image,C=i.video,E=i.eTag,A=i.photo,L=i.restricted,k=i.tags,M=i.specialFolder,P=i.photoStreamItemSource;return function(e){var s,T,U,H,R,N,B,V,be,ge,ve=i.lastModifiedDateTime,ye=void 0===ve?_&&_.lastModifiedDateTime:ve,Se=i.createdDateTime||_&&_.createdDateTime,De=(new Date).getTime(),Ie=Se?new Date(Se).getTime():void 0,xe=Ie?De-Ie<1728e5:void 0,Ce=b&&b.driveId,Oe=b&&b.driveType,we="personal"===Oe,Ee=Object(_e.e)(y),Ae=_&&_.lastAccessedDateTime,Le=(null==A?void 0:A.takenDateTime)||(null==A?void 0:A.alternateTakenDateTime),ke=i.package||(null==y?void 0:y.package),Me=I,Pe=!(null==Me?void 0:Me.length)||void 0===Me[0].isPreAuth,Te=x,Ue=C,Fe=Ee?void 0:i.shared||(null==y?void 0:y.shared),He={itemId:i.id,driveId:Ce,endpoint:r},Re=_&&_.systemPath,Ne=void 0;y&&(Ne={itemId:y.root?F.a:y.id,driveId:y.parentReference&&y.parentReference.driveId||"",endpoint:r},ge=O.e.serialize({itemId:y.root?F.a:y.id,driveId:null!==(N=null===(R=y.parentReference)||void 0===R?void 0:R.driveId)&&void 0!==N?N:Ce,endpoint:r}));var Be,je=n||He,Ve=O.e.serialize(je),ze=i.webDavUrl,Ge=ze&&decodeURIComponent(ze);Be="business"!==Oe&&"documentLibrary"!==Oe&&"personal"!==Oe||!S||y?h||"":X.n;var Ke,We=i.bundle||(null==y?void 0:y.bundle),qe=i.folder||(null==y?void 0:y.folder)||We;if(qe){var Qe=d.e.matches(l);Ke=y?Qe?2:12:Fe?5:2}var Ye=(null===(B=null==qe?void 0:qe.folderView)||void 0===B?void 0:B.sortBy)||"",Je="descending"===(null===(V=null==qe?void 0:qe.folderView)||void 0===V?void 0:V.sortOrder),Xe=Ye&&{columnKey:Object(pe.l)(Ye),isAscending:!Je},Ze=null!=D?D:null==y?void 0:y.size,$e=null==qe?void 0:qe.childCount,et=function(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}(Be,!!qe),tt=et.extension||(null==ke?void 0:ke.type),nt=tt&&Object(ae.e)(tt),at=i.sharepointIds,it=i.localItem,rt=i.webUrl,ot=new g.e({publisher:he});return ot.resolveItems({items:(s={},s[t]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},O.e.pack(je)),w.u.pack(Be)),te.a.pack(Re)),w.c.pack(ye?new Date(ye).getTime():void 0)),w.s.pack(Ie)),Z.c.pack(Le?new Date(Le).getTime():void 0)),w.S.pack(xe)),z.i.pack(ke&&"oneNote"===ke.type?{}:void 0)),Object(p.e)().forFacet(Z.h).thenInvalidate(Ve,K.e).pack()),W.e.pack(i)),m.t.pack({itemKey:G.e.serialize({driveItemKey:je,sortBy:Ye,isAscending:!Je})})),w.n.pack({itemKey:Y.e.serialize({driveItemKey:je})})),w.k.pack(o?{itemKey:o}:void 0)),$.e.pack(Oe)),w.p.pack(et)),se.e.pack(We)),ce.e.pack(u)),te.n.pack(f&&f.mimeType)),q.e.pack(Ne)),ne.t.pack(v&&v.length>0?v:void 0)),ue.e.pack(k)),fe.e.pack(!!P)),w._.pack(qe?{}:void 0)),Ae?Object(a.__assign)({},w.o.pack(new Date(Ae).getTime())):{}),Me?Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},K.e.pack(Me)),oe.e.pack(Pe)),de.e.pack(Object(le.i)(et.extension))):{}),E?w.f.pack(E):{}),Te&&Te.width&&Te.height?Z.d.pack({width:Te.width,height:Te.height}):{}),Te&&!Ue?Z.m.pack({}):{}),Ue?Z.g.pack({}):{}),we?Object(a.__assign)({},ee.e.pack(Ee?Object(_e.t)(null==y?void 0:y.containingDrivePolicyScenarioViewpoint):i.vault)):{}),c?Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.D.pack(!!Fe)),J.e.pack(Fe)),Ke?z.e.pack(Ke):{}):{}),s)}),((null===(be=i.vault)||void 0===be?void 0:be.root)||Ee)&&ot.mapKeys({mappings:(T={},T[O.e.serialize({endpoint:r,driveId:Ce,itemId:"vault"})]=t,T)}),ot.resolveItems({items:(U={},U[t]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},void 0!==Ze?w.m.pack(Ze):{}),rt?w.A.pack(rt):{}),Xe?m.s.pack(Xe):{}),Ge||We?w.i.pack(Ge):{}),it?te.t.pack(it):{}),"number"==typeof $e?j.e.pack($e):{}),nt?ne.e.pack(nt):{}),L?me.e.pack(L):{}),at?ie.e.pack(at):{}),M?re.e.pack(M.name):Ee?re.e.pack("vault"):{}),U)}),ot.resolveItems({items:(H={},H[t]=Object(a.__assign)({},Q.e.pack(ge?{itemKey:ge}:void 0)),H)}),{itemResolver:ot}}}function be(e){var t=e.driveItemResponse,n=e.endpoint;return function(i){var r=t.parentReference,o=r&&r.driveId,s=r&&r.id,c=t.id;t.root&&(c=F.a);var d={endpoint:n,driveId:o,itemId:c},l=O.e.serialize(d),u=!r||r.path!==F.e&&r.path!=="/drives/".concat(r.driveId,"/root:")?s||void 0:F.a,f=r&&u?O.e.serialize({endpoint:n,driveId:r.driveId,itemId:u}):void 0;return{itemResolver:i(T(Object(a.__assign)(Object(a.__assign)({},e),{itemKey:l,driveItemKey:d,getDriveItemFacets:he,parentFolderItemKey:f}))).itemResolver,actualDriveItemKey:d,actualItemKey:l}}}var ge=n(8),ve=!ge.e.isActivated("2517C3C6-AAA1-43DA-BBB6-F27E6C7497D1","06/13/2022","Fallback children response to value of `[]` when `@odata.null` is asserted"),ye=!ge.e.isActivated("241308BC-D957-4B3D-97F4-07ACD4C725B5","09/08/2022","Fixes issues with endpoint resolution for migrated content");function Se(e){return function(t){var n,i,r,o,s,c,d,l,u,_=e.itemKey,h=e.parentItemKey,C=e.itemSetKeyFacet,O=e.filterChildItems,w=e.onProcessResponse,E=e.groupChildItems,A=e.response,L=e.skip,k=void 0===L?0:L,M=e.enableRandomAccess,P=void 0!==M&&M,T=e.disableRemoteItem,U=e.totalChildCount,F=e.getDriveItemFacets,H=C.deserialize(_),z=H.driveItemKey.endpoint,G=new g.e({publisher:Se}),K=t(Object(D.e)({name:"remoteItemsMissingParentRef"}));ve&&!A.value&&A["@odata.null"]&&(A.value=[]);var W,q="number"==typeof A["@odata.count"]?A["@odata.count"]:U||A.value.length,Q=A["@odata.nextLink"],Y=!!Q,J=t(Object(B.e)(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(m.e,_),prevChildKeys:e.demandItemFacet(m.e,_)}})),X=J.childItemsFacetResolved,Z=J.prevChildKeys,$=Z&&Z.itemKeys,ee=0,te=0,ne=0;P&&(X&&$?W=$.slice(0):"number"==typeof q&&(W=new Array(q+(Y&&q<=A.value.length?1:0)))),W||(W=new Array(A.value.length+(Y?1:0)));for(var ae=k,ie=0,re=0,oe=A.value;re<oe.length;re++){var se=oe[re],ce=O&&O(se),de=se.remoteItem,le=!(se.remoteItem&&se.remoteItem.parentReference&&se.remoteItem.parentReference.driveId),ue=de&&le;if(ue&&ie++,ce||ue)W.splice(ae,1),q--;else{var fe=t(Object(f.e)({graphEndpoint:S.y,graphRecentEndpoint:S.I,processDriveItemSet:S.M,allowDisableRemoteItemInPlace:S.i,convergenceConfiguration:R.e,getIsExternalItem:S.g})),pe=fe.graphEndpoint,me=fe.graphRecentEndpoint,_e=fe.processDriveItemSet,he=fe.allowDisableRemoteItemInPlace,ge=fe.convergenceConfiguration,De=fe.getIsExternalItem,Ie=he&&T,xe=Ie?be:N,Ce=z.indexOf("/_api/v2.0")>-1||z.indexOf("/_api/v2.1")>-1,Oe=pe||me;if(Ce){var we=null===(s=se.parentReference)||void 0===s?void 0:s.driveId,Ee=ye&&we&&(null==ge?void 0:ge.isMigratedContent(we))?(null===(d=null===(c=se.parentReference)||void 0===c?void 0:c.sharepointIds)||void 0===d?void 0:d.siteUrl)||(null===(l=se.sharepointIds)||void 0===l?void 0:l.siteUrl):se.webDavUrl||!Ie&&se.remoteItem&&se.remoteItem.webDavUrl||se.webUrl;if(Ee){var Ae=new x.e(decodeURIComponent(Ee)).authority;z=ye||Oe?"".concat(Ae,"/_api/v2.0"):"".concat(Ae).concat(new x.e(z).path)}}var Le=t(xe({shouldInvalidateItemSetOnChildItemRename:_e&&_e.shouldInvalidateItemSetOnChildItemRename,setItemKey:_,driveItemResponse:se,endpoint:z,getDriveItemFacets:F})),ke=Le.itemResolver,Me=Le.actualItemKey,Pe=Le.actualDriveItemKey,Te=se.thumbnails,Ue=se.remoteItem;if(ee++,(Te||!Ie&&Ue&&Ue.thumbnails)&&te++,De&&(null===(u=null==Ue?void 0:Ue.sharepointIds)||void 0===u?void 0:u.tenantId)&&De({tenantId:Ue.sharepointIds.tenantId})&&ne++,W[ae]=Me,G.merge(ke),w){var Fe=w({itemKey:_,driveItemKey:Pe,item:se});Fe&&G.merge(Fe.itemResolver)}var He=t(Object(f.e)({processDriveItemFromSharePoint:S.k})).processDriveItemFromSharePoint;if(He&&(Ce||Oe)){var Re=t(He.process({itemKey:Me,driveItem:se})).itemResolver;G.merge(Re)}ae++}}if(t(K(Object(a.__assign)({resultType:ie<1?I.t.Success:I.t.Failure},ie>0?{extraData:{count:ie}}:{}))),Y){var Ne=b.serialize({setItemKey:_,endpoint:z,token:Q});G.merge(Object(v.t)({itemKey:Ne}).itemResolver),W[ae]=Ne}if(E){var Be=E(H);Be&&G.merge(Be.itemResolver)}else G.resolveItems({items:(n={},n[_]=Object(a.__assign)({},m.e.pack({itemKeys:W})),n)});return G.resolveItems({items:(i={},i[_]=Object(a.__assign)({},V.e.pack({childCount:ee,childCount_withThumbnail:te,childCount_external:ne})),i)}),q!==U&&G.resolveItems({items:(r={},r[h]=Object(a.__assign)({},j.e.pack(q)),r)}),G.resolveItems({items:(o={},o[_]=Object(a.__assign)(Object(a.__assign)({},m.r.pack({itemKey:h})),Object(p.e)().forFacet(m.e).thenInvalidate(y.e).pack()),o)}),{itemResolver:G}}}var De=n(1317),Ie=n(175);function xe(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,r=e.childItemsResponse,o=e.disableRemoteItem,s=e.parentItemResponse,c=e.mapItemSetKey,d=n.deserialize(t),l=i.serialize(d.driveItemKey),u=d.driveItemKey.endpoint;return function(n){var i,d;Ie.t(De.e.processData.start);var _=n(Se(Object(a.__assign)(Object(a.__assign)({},e),{response:r,disableRemoteItem:o,parentItemKey:l}))).itemResolver;if(c){var h=c().itemResolver;_.merge(h)}var b=n(Object(f.e)({allowDisableRemoteItemInPlace:S.i})).allowDisableRemoteItemInPlace;if(s){var g=n((b&&o?be:N)({setItemKey:t,driveItemResponse:s,endpoint:u})),v=g.itemResolver,y=g.actualItemKey;_.mapKeys({mappings:(i={},i[y]=l,i)}),_.merge(v)}return _.resolveItems({items:(d={},d[l]=Object(a.__assign)({},Object(p.e)().forFacet(m.t).thenInvalidate(e.itemKey,m.e).pack()),d)}),Ie.t(De.e.processData.end),{itemResolver:_}}}var Ce=n(389),Oe=ge.t.isActivated("cade488d-480a-444f-a1ea-d3d121529bb7","11/01/2021","Set one minute timeout for API requests");function we(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,r=e.getUrl,o=e.sortChildItems,s=e.qosName,c=e.preprocessResponse,d=e.expectedErrors,f=e.disableRemoteItem,p=void 0!==f&&f,m=e.scenarioInfo,_=i.deserialize(n),h=_.driveItemKey,b=h.endpoint,g=h.driveId;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,f,h,v,y;return Object(a.__generator)(this,function(S){switch(S.label){case 0:t=Object(l.n)(_.driveItemKey),S.label=1;case 1:return S.trys.push([1,4,,5]),[4,n(Object(u.n)({url:r(_),driveUrl:t,driveId:g,qosName:"getChildren".concat(s?".".concat(s):""),endpoint:b,headers:e.additionalHeaders,expectedErrors:d,timeout:Oe?void 0:6e4,scenarioInfo:m}))];case 2:return i=S.sent(),f=Object(a.__spreadArray)([],i.value,!0),h=c&&c(f)||i.value,v=o&&o(h)||h,[4,n(xe(Object(a.__assign)(Object(a.__assign)({},e),{disableRemoteItem:p,childItemsResponse:Object(a.__assign)(Object(a.__assign)({},i),{value:v})})))];case 3:return[2,{itemResolver:S.sent().itemResolver}];case 4:throw y=S.sent(),new Ce.e(Object(a.__assign)({code:"UnknownError"},y instanceof Error?{innerError:y}:{message:JSON.stringify(y)}));case 5:return[2]}})})}}var Ee=n(147),Ae=n(106),Le=n(675),ke=n(448),Me=n(366);function Pe(e,t){var n=new Date(e.valueOf());return n.setDate(n.getDate()-t),n}var Te=n(2524),Ue=new Map([["code",Ae.e.text],["csv",Ae.e.excel],["docx",Ae.e.word],["dotx",Ae.e.word],["one",Ae.e.onenote],["onepkg",Ae.e.onenote],["onetoc",Ae.e.onenote],["pdf",Ae.e.pdf],["photo",Ae.e.media],["potx",Ae.e.powerpoint],["ppsx",Ae.e.powerpoint],["pptx",Ae.e.powerpoint],["rtf",Ae.e.text],["txt",Ae.e.text],["video",Ae.e.media],["xlsx",Ae.e.excel],["xltx",Ae.e.excel],["zip",Ae.e.zip]]);var Fe=n(196);function He(e,t,n){var a=e.lastModifiedDateTime,i=t.lastModifiedDateTime,r=a&&i&&new Date(a).getTime()-new Date(i).getTime()||0,o=a&&i&&new Date(i).getTime()-new Date(a).getTime()||0;return n?r:o}function Re(e,t,n){var a=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,r=a&&i&&new Date(a).getTime()-new Date(i).getTime()||0,o=a&&i&&new Date(i).getTime()-new Date(a).getTime()||0;return n?r:o}function Ne(e,t,n){var a=e.name,i=t.name,r=a&&i&&a.localeCompare(i)||0,o=a&&i&&i.localeCompare(a)||0;return n?r:o}function Be(e,t,n){var a,i,r,o,s,c,d=(null===(a=e.remoteItem)||void 0===a?void 0:a.shared)&&(null!==(i=e.remoteItem.shared.sharedBy)&&void 0!==i?i:e.remoteItem.shared.owner),l=null===(r=null==d?void 0:d.user)||void 0===r?void 0:r.displayName,u=(null===(o=t.remoteItem)||void 0===o?void 0:o.shared)&&(null!==(s=t.remoteItem.shared.sharedBy)&&void 0!==s?s:t.remoteItem.shared.owner),f=null===(c=null==u?void 0:u.user)||void 0===c?void 0:c.displayName,p=l&&f&&l.localeCompare(f)||0,m=l&&f&&f.localeCompare(l)||0;return n?p:m}function je(e,t,n,i){return function(e,r){return Object(a.__spreadArray)([],e,!0).sort(function(e,a){var r,o,s,c,d=e.folder||(null===(r=e.remoteItem)||void 0===r?void 0:r.folder)||(null===(o=e.remoteItem)||void 0===o?void 0:o.bundle),l=a.folder||(null===(s=a.remoteItem)||void 0===s?void 0:s.folder)||(null===(c=a.remoteItem)||void 0===c?void 0:c.bundle);return n&&d&&!l?-1:n&&!d&&l?1:i(e,a,t)})}(e)}var Ve=n(4040),ze=new _.e("SharedByPersonKeyFacet",{displayName:h.e,email:h.e,id:h.e}),Ge=new _.e("dateSharedGroupKeyFacet",{relativeTime:h.e,sharedDateTime:h.e}),Ke=new _.e("relativeTimeGroupKeyFacet",{relativeTime:h.e}),We=n(4825),qe=n(570),Qe=n(19),Ye=n(60),Je=n(4823),Xe=(Je.T,Je.l,Je.F,Je.H,Je.U,Je.i,Je.p,Je.L,Je.C,Je.M,Je.P,Je.k,Je.v,Je.E,Je.y,Je.g,Je.I,Je._,Je.x,Je.D,Je.S,Je.h,Je.A,Je.w,Je.O,Je.b,[Je.r,Je.a,Je.c,Je.e,Je.d,Je.s,Je.o,Je.t,Je.m,Je.f,Je.u,Je.n]),Ze=ge.t.isActivated("1E74BB9A-47A2-40F6-89FA-C628928BEC2F","04/12/2022","Enable grouping of items that are missing the email or display name of the person who shared an item");function $e(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=e.endpoint,i=n(Object(f.e)({getUserOneDriveEndpoint:S.v,graphEndpoint:S.y})),r=i.getUserOneDriveEndpoint,(o=i.graphEndpoint)&&t!==o&&r?[4,n(r({endpoint:t}))]:[3,2];case 1:s=a.sent(),t=s,a.label=2;case 2:return[2,t]}})})}}var et=n(2863),tt=Object(i.i)()(function e(t){var n=this,i=d.e.deserialize(t.itemKey),r=i.filters,o=i.sortBy,s=i.isAscending;return function(i){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,c,l,p,_,h,b,v,y,D,I,x,C,E;return Object(a.__generator)(this,function(A){switch(A.label){case 0:return n=function(e){if(d.e.matches(e)){var t=d.e.deserialize(e).groupBy;if(t===pe.a[pe.c])return function(e){var t={},n=function(i){for(var r,o,s=new g.e({publisher:n}),c=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];if(!ze.matches(i))return e;var r=ze.deserialize(i);t.push(r)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return ze.serialize(e)})}(Object.keys(t)),d=[],l=0,u=c;l<u.length;l++){var f=u[l];if(ze.matches(f)){var p=ze.deserialize(f);s.resolveItems({items:(r={},r[f]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(p.displayName)),j.r.pack(!0)),m.e.pack({itemKeys:t[f]})),r)}),d.push(f)}}return s.resolveItems({items:(o={},o[e]=Object(a.__assign)(Object(a.__assign)({},m.e.pack({itemKeys:d})),Ye.e.pack(!0)),o)}),{itemResolver:s}};return{onProcessResponse:function(e){var n,i,r,o,s,c=e.driveItemKey,d=e.item;if(d&&c){var l=d.remoteItem,u=l&&l.shared&&(null!==(n=l.shared.sharedBy)&&void 0!==n?n:l.shared.owner),f=(null===(i=null==u?void 0:u.user)||void 0===i?void 0:i.displayName)||(Ze?"":(null===(r=null==u?void 0:u.user)||void 0===r?void 0:r.email)||We.s),p=Object(a.__assign)(Object(a.__assign)({},null!==(o=null==u?void 0:u.user)&&void 0!==o?o:{}),{displayName:f}),m=O.e.serialize(c);if(!Ze||p.email||p.id){var _=ze.serialize({displayName:p.displayName,email:p.email||"",id:p.id||""});s=_,t.hasOwnProperty(s)||(t[_]=[]),t[_].push(m)}}},groupChildItems:n}}(e);if(t===pe.a[pe.e])return function(e){var t={},n=function(i){for(var r,o,s=new g.e({publisher:n}),c=function(e){for(var t={},n=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];if(!Ge.matches(i))return e;var r=Ge.deserialize(i);t.push(r)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return Ge.serialize(e)})}(Object.keys(e)),a=function(e){return t.hasOwnProperty(e)},i=0,r=n;i<r.length;i++){var o=r[i];if(Ge.matches(o)){var s=Ge.deserialize(o).relativeTime,c=Ke.serialize({relativeTime:s});if(a(c))for(var d=0,l=e[o];d<l.length;d++){var u=l[d];t[c].push(u)}else{t[c]=[];for(var f=0,p=e[o];f<p.length;f++)u=p[f],t[c].push(u)}}}return t}(t),d=[],l=0,u=Object.keys(c);l<u.length;l++){var f=u[l];if(Ke.matches(f)){var p=Ke.deserialize(f).relativeTime;s.resolveItems({items:(r={},r[f]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(p)),j.r.pack(!0)),m.e.pack({itemKeys:c[f]})),r)}),d.push(f)}}return s.resolveItems({items:(o={},o[e]=Object(a.__assign)(Object(a.__assign)({},m.e.pack({itemKeys:d})),Ye.e.pack(!0)),o)}),{itemResolver:s}};return{onProcessResponse:function(e){var n,a=e.driveItemKey,i=e.item;if(i&&a){var r=i.remoteItem,o=r&&r.shared&&r.shared.sharedDateTime,s=O.e.serialize(a);if(o){var c=function(e,t){if(!e)return We.n;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return qe.today;if(n.setDate(n.getDate()-1),e>=n)return qe.yesterday;if(n.setDate(t.getDate()-t.getDay()),e>=n)return We.i;if(n.setDate(n.getDate()-7),e>n)return We.t;var a=new Date(t.getFullYear(),t.getMonth(),1);if(e>=new Date(t.getFullYear(),t.getMonth()-1,1)&&e<a)return We.e;if(n.setDate(n.getDate()-7),e>n)return We.o;if(n.setDate(n.getDate()-7),e>n)return We.r;if(e>=a)return We.a;var i=t.getFullYear()===e.getFullYear(),r=Xe[e.getMonth()];return i?r:Qe.format(qe.MonthAndYear,r,e.getFullYear())}(new Date(o),new Date),d=Ge.serialize({relativeTime:c,sharedDateTime:o});n=d,t.hasOwnProperty(n)||(t[d]=[]),t[d].push(s)}}},groupChildItems:n}}(e)}return{onProcessResponse:void 0,groupChildItems:void 0}}(t.itemKey),c=n.onProcessResponse,l=n.groupChildItems,p=d.e.deserialize(t.itemKey),_=p.driveItemKey.endpoint,h=i(Object(f.e)({graphSharedWithMeEndpoint:S.C,isUnauthenticated:Ve.e,convergenceConfiguration:R.e})),b=h.graphSharedWithMeEndpoint,v=h.isUnauthenticated,y=void 0!==v&&v,D=h.convergenceConfiguration,!ge.e.isActivated("8D6592C3-9CFD-4B17-B0EC-F88A5B9B7EFA","01/17/2023","Do not query SWM if user is unauth")&&y?[2]:(_=b||_,ge.e.isActivated("C8633E26-C16D-4D6D-ABE5-BE1A2C3C256A","02/23/2022","Use OneDrive endpoint for Shared with me")?[3,3]:b&&b!==p.driveItemKey.endpoint?(p=Object(a.__assign)(Object(a.__assign)({},p),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},p.driveItemKey),{endpoint:b})}),[3,3]):[3,1]);case 1:return[4,i($e({endpoint:_}))];case 2:(I=A.sent())!==p.driveItemKey.endpoint&&(p=Object(a.__assign)(Object(a.__assign)({},p),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},p.driveItemKey),{endpoint:I})})),A.label=3;case 3:return(x=i(Object(u.i)(p.driveItemKey.endpoint)))&&!o&&(o=pe.i,s=!0),C=d.e.serialize(p),[4,i(we(Object(a.__assign)(Object(a.__assign)({},t),{qosName:"sharedWithMe",itemKey:C,itemSetKeyFacet:d.e,parentItemKeyFacet:Ee.e,disableRemoteItem:!1,getUrl:function(e){var t=e.driveItemKey.endpoint;if(x)return"".concat(t,"/drive/oneDrive.sharedWithMe?select=*,webDavUrl");var n=!ge.e.isActivated("C0AA2EE3-DAE6-4EF6-B432-5A5ED517EFE2","3/23/2022","Enable WebDavUrl in SWM");return!ge.e.isActivated("211F049A-DF94-41B3-99C3-E71620C63E23","05/31/2022","Remove me from request Url")&&I?"".concat(t,"/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500").concat(n?"&select=*,webDavUrl":""):"".concat(t,"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500").concat(n?"&select=*,webDavUrl":"")},filterChildItems:function(e){return!function(e,t){return void 0===t&&(t=[]),t.every(function(t){var n,a=!("sharedByName"===t.type)||function(e,t){var n,a,i,r=(null===(n=e.remoteItem)||void 0===n?void 0:n.shared)&&(null!==(a=e.remoteItem.shared.sharedBy)&&void 0!==a?a:e.remoteItem.shared.owner),o=null===(i=null==r?void 0:r.user)||void 0===i?void 0:i.displayName;return!!o&&t.indexOf(o)>-1}(e,t.values),i=!("fileName"===t.type)||function(e,t){return!!e.name&&function(e,t){var n,a,i=(n=e,a=Object(Le.t)(n,!0),Object(ke.n)(a)),r=Ue.get(i);return!!r&&Object(Ae.t)(t.filters,r)}(e.name,t)}(e,Object(Me.t)(t.values)),r=!("dateModified"===t.type)||function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t}(e,function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case Te.e.today:return n;case Te.e.yesterday:return Pe(n,1);case Te.e.last7Days:return Pe(n,7);case Te.e.last30Days:return Pe(n,30);case Te.e.last3Months:return Pe(n,90);default:return new Date(0)}}((n=t.values).length<1||-1===Object.keys(Te.e).indexOf(n[0])?Te.e.none:Te.e[n[0]]));return a&&i&&r})}(e,r)},sortChildItems:function(e){return function(e,t,n,a){void 0===a&&(a=!1);var i=pe.a[pe.e],r=pe.a[pe.c],o=pe.a[Fe.a],s=pe.a[Fe.n],c=pe.a[pe.o],d=pe.a[Fe.s];switch(t){case i:return je(e,n,a,Re);case r:return je(e,n,a,Be);case o:case s:case d:return je(e,n,a,Ne);case c:return je(e,n,a,He);default:return e}}(e,o,s,!0)},onProcessResponse:function(e){var t,n,a;if(c&&c(e),!ge.e.isActivated("D5DE03D9-65F1-4DBC-ACED-1454D5E5B534","02/06/2023","Call setMigrationState for all migrated drives in SWM")){var i=e.item,r=!!(null===(t=null==i?void 0:i.remoteItem)||void 0===t?void 0:t.sharepointIds),o=null===(a=null===(n=null==i?void 0:i.remoteItem)||void 0===n?void 0:n.parentReference)||void 0===a?void 0:a.driveId;D&&r&&o&&D.setMigrationState(o,!0)}},groupChildItems:l,mapItemSetKey:function(){var n,a=new g.e({publisher:e});return a.mapKeys({mappings:(n={},n[C]=t.itemKey,n)}),{itemResolver:a}},scenarioInfo:{scenario:et.e.PopulateSharedWithMe,scenarioType:et.t.ActiveUserOperation}})))];case 4:return E=A.sent().itemResolver,i(E.execute()),[2]}})})}}),nt=n(259),at=n(437),it=n(1830),rt=Object(i.t)(function(){return function(e){e(Object(nt.t)({keyFacet:d.e,facets:[d.e,m.e]})),e(c.e),e(Object(s.a)(d.e,at.e)(tt)),e(it.e)}}),ot=new _.e("sharedByMeRootItem",{endpoint:h.e}),st=new _.e("sharedByMeItemSet",{driveItemKey:O.e.subKeyPart}),ct=n(344),dt=n(442),lt=n(114),ut=n(280),ft=n(1088);function pt(e,t){var n=t.itemsScopeItemKey,i=t.engagement,r=i&&i.name;return{engagement:{objectType:"SharedByMe",datasource:"Graph",extraData:Object(a.__assign)({},"ItemsView.Load"===r?Object(ft.e)(e,{itemsScopeItemKey:n}):{})}}}function mt(e,t){return{engagement:{currentPage:"SharedByMe"}}}var _t=Object(i.t)(function(){return function(e){e(Object(dt.e)(ot,lt.e)(pt)),e(Object(dt.e)(st,lt.e)(pt)),e(Object(dt.e)(ot,ut.e)(mt))}}),ht=Object(ct.e)(ot,function(e){return function(){return{defaultChildItemSet:{itemKey:st.serialize({driveItemKey:e})},displayName:X.r,icon:void 0}}},_t),bt=!ge.e.isActivated("519F99F6-DD95-455D-8604-464641B5540D","06/13/2022","Do NOT request thumbnails from SBY API"),gt=Object(i.i)()(function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o;return Object(a.__generator)(this,function(s){switch(s.label){case 0:return t=e.itemKey,i=st.deserialize(t).driveItemKey.endpoint,r=n(Object(u.i)(i)),[4,n(we(Object(a.__assign)(Object(a.__assign)({},e),{qosName:"sharedByMe",itemSetKeyFacet:st,parentItemKeyFacet:ot,disableRemoteItem:!1,getUrl:function(e){var t="".concat(i,"/drive/shared"),n=bt&&r?"":"$expand=thumbnails";return"".concat(t,"?").concat(n,"&").concat("$select=*,fileSystemInfo,folder,reactions,bundle,webDavUrl,package")}})))];case 1:return o=s.sent().itemResolver,n(o.execute()),[2]}})})}}),vt=Object(i.t)(function(){return function(e){e(Object(nt.t)({keyFacet:ot,facets:[ot,w.u,w.m,w._,w.A,w.i,w.c,m.t,w.k,te.a]})),e(Object(nt.t)({keyFacet:st,facets:[st,m.e]})),e(ht),e(Object(s.a)(st,at.e)(gt)),e(_t)}}),yt=n(1044),St=n(339),Dt=n(1078),It=n(232);function xt(e,t){var n=t.handlers,i=t.itemKey,r=e.demandItemFacet(St.e,i);if(n&&r){for(var o=[],s=0,c=n;s<c.length;s++){var d=c[s];if(d.key===It.l.key)o.push("photo");else if(d.key===It.u.key)o.push("video");else if(d.key===It.a.key)o.push("folder");else if(d.key===It.n.key)o.push("file");else if(d.key===It.d.key)o.push("onenote");else if(d.key===It.s.key)o.push("!photo");else if(d.key===It.c.key)o.push("!video");else if(d.key===It.r.key)o.push("!folder");else if(d.key===It.o.key)o.push("!onenote");else{var l=Object(Dt.e)(d);l&&o.push(l)}}return{itemKey:St.e.serialize(Object(a.__assign)(Object(a.__assign)({},r),{filters:o}))}}return{}}var Ct,Ot=n(1765),wt=n(164),Et=n(438),At=n(578),Lt=new _.e("recentGroup",{recentItemSet:St.e.subKeyPart,relativeTime:Object(At.e)({today:"today",yesterday:"yesterday",thisWeek:"thisWeek",lastWeek:"lastWeek",twoWeeksAgo:"twoWeeksAgo",threeWeeksAgo:"threeWeeksAgo",thisMonth:"thisMonth",lastMonth:"thisMonth",twoMonthsAgo:"twoMonthsAgo",older:"older"})}),kt=864e5;function Mt(e,t){return e.toDateString()===t.toDateString()}!function(e){e.today="today",e.yesterday="testerday",e.thisWeek="thisWeek",e.lastWeek="lastWeek",e.twoWeeksAgo="twoWeeksAgo",e.threeWeeksAgo="threeWeeksAgo",e.thisMonth="thisMonth",e.lastMonth="lastMonth",e.twoMonthsAgo="twoMonthsAgo",e.older="older"}(Ct||(Ct={}));var Pt=n(1325),Tt=n(4227),Ut=n(1124),Ft=!ge.t.isActivated("670094E2-09D8-4B36-90FB-B7EF6BA067C9","04/06/2022","Add support for `photo` and `video` filters for the picker");function Ht(e){return e.reduce(function(e,t){return e&&t?"(".concat(e," or ").concat(t,")"):t||e})}function Rt(e){return e.reduce(function(e,t){return e&&t?"(".concat(e," and ").concat(t,")"):t||e})}function Nt(e){return function(t){for(var n=void 0,a=void 0,i=0;i<e.length;i++){var r=e[i],o=!1,s=r;if(Object(Pt.e)(r)&&(s=Object(Pt.t)(r),o=!0),"."===s[0])if(t.name){var c=new RegExp("".concat(s.toLocaleLowerCase(),"$")),d=t.name.toLocaleLowerCase().split(c),l=2===d.length&&""===d[1]||!1;o?n=void 0!==n?n&&!l:l:a=a||l}else n=!1,a=!1;else if("folder"===s){var u=void 0!==t.folder||void 0!==t.remoteItem&&void 0!==t.remoteItem.folder||!1;o?n=void 0!==n?n&&!u:u:a=a||u}else if("onenote"===s){var f=t.package&&"oneNote"===t.package.type||t.remoteItem&&t.remoteItem.package&&"oneNote"===t.remoteItem.package.type||!1;o?n=void 0!==n?n&&!f:f:a=a||f}else if("photo"===s&&Ft){var p=void 0!==t.photo||void 0!==t.image;o?n=void 0!==n?n&&!p:p:a=a||p}else if("video"===s&&Ft){var m=!!t.video;o?n=void 0!==n?n&&!m:m:a=a||m}}return void 0===a?void 0!==n&&n:(void 0===n||n)&&!a}}var Bt=n(4824),jt=!ge.e.isActivated("667B27A0-823E-489C-B1CF-3AA1F1E5C454","04/09/2022","Enable the Older grouping for list items in Recent pivot"),Vt=!ge.e.isActivated("213A4632-291F-4C56-A70F-D16FF269A867","04/07/2022","Enforce maxmimum filter complexity for Graph Recent API"),zt=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})},Gt=Object(i.i)()(function(e){var t=this,n=St.e.deserialize(e.itemKey),i=n.filters,r=void 0===i?[]:i,o=n.groupBy,s=void 0===o?"":o,c=Object(Me.e)({extFilters:Object(Me.t)(r),allowedMediaTypes:[Ae.e.photo,Ae.e.video],fileTypeIconMap:Et.e}),d=Object(Me.e)({extFilters:Object(Me.t)(r),allowedMediaTypes:[Ae.e.photo],fileTypeIconMap:Et.e}),p=Object(Me.e)({extFilters:Object(Me.t)(r),allowedMediaTypes:[Ae.e.video],fileTypeIconMap:Et.e});return function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,o,_,h,b,v,y,D,I,x,C,E,A,L,k,M,P,T,U,F,H,R,N,B,V,z,G,K,W,q,Q,Y,J,X,Z,$,ee,te;return Object(a.__generator)(this,function(ne){switch(ne.label){case 0:return t=i(Object(f.e)({graphRecentEndpoint:S.I,enableOverflowRecentGroup:S.u,enableRecentVroom21Takeover:S.p})),o=t.graphRecentEndpoint,_=t.enableOverflowRecentGroup,h=void 0===_?jt:_,b=t.enableRecentVroom21Takeover,v=n,o?(v=Object(a.__assign)(Object(a.__assign)({},v),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},v.driveItemKey),{endpoint:o})}),[3,3]):[3,1];case 1:return[4,i($e({endpoint:v.driveItemKey.endpoint}))];case 2:(y=ne.sent())!==v.driveItemKey.endpoint&&(v=Object(a.__assign)(Object(a.__assign)({},v),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},v.driveItemKey),{endpoint:y})})),ne.label=3;case 3:return D=St.e.serialize(v),I=Lt.serialize({recentItemSet:v,relativeTime:"today"}),x=Lt.serialize({recentItemSet:v,relativeTime:"yesterday"}),C=Lt.serialize({recentItemSet:v,relativeTime:"thisWeek"}),E=Lt.serialize({recentItemSet:v,relativeTime:"lastWeek"}),A=Lt.serialize({recentItemSet:v,relativeTime:"twoWeeksAgo"}),L=Lt.serialize({recentItemSet:v,relativeTime:"threeWeeksAgo"}),k=Lt.serialize({recentItemSet:v,relativeTime:"lastMonth"}),M=Lt.serialize({recentItemSet:v,relativeTime:"twoMonthsAgo"}),P=Lt.serialize({recentItemSet:v,relativeTime:"older"}),T=[],U=[],F=[],H=[],R=[],N=[],B=[],V=[],z=[],G="",K="date"===s,W=function(e){var t,n=e.driveItemKey,i=e.item,r=new g.e({publisher:W});if(i&&n){var o=i.remoteItem,s=o&&o.fileSystemInfo,c=s&&s.lastAccessedDateTime,d=O.e.serialize(n);if(K&&c){var l=new Date(c);switch(function(e){var t=new Date;return function(e,t){return Mt(t,e)}(e,t)?Ct.today:function(e,t){return Mt(new Date(t.getTime()-kt),e)}(e,t)?Ct.yesterday:function(e,t){var n=t.setHours(0,0,0,0)-t.getDay()*kt;return e.getTime()>n}(e,t)?Ct.thisWeek:function(e,t){var n=t.setHours(0,0,0,0)-(t.getDay()+7)*kt;return e.getTime()>n}(e,t)?Ct.lastWeek:function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n}(e,t)?Ct.twoWeeksAgo:function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n}(e,t)?Ct.threeWeeksAgo:function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()}(e,t)?Ct.thisMonth:function(e,t){return t.getMonth()-e.getMonth()==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1}(e,t)?Ct.lastMonth:function(e,t){var n=t.getFullYear(),a=e.getFullYear(),i=t.getMonth(),r=e.getMonth();return n===a&&i-r==2||n-a==1&&i-r==-10}(e,t)?Ct.twoMonthsAgo:Ct.older}(l)){case Ct.today:T.push(d);break;case Ct.yesterday:U.push(d);break;case Ct.thisWeek:F.push(d);break;case Ct.lastWeek:H.push(d);break;case Ct.twoWeeksAgo:R.push(d);break;case Ct.threeWeeksAgo:N.push(d);break;case Ct.lastMonth:B.push(d);break;case Ct.twoMonthsAgo:V.push(d),G=Xe[l.getMonth()];break;case Ct.older:default:z.push(d)}}return r.resolveItems({items:(t={},t[d]=Object(a.__assign)({},w._.pack(void 0)),t)}),{itemResolver:r}}},q=!c&&K?function(t){var n,i,r=new g.e({publisher:q});r.resolveItems({items:(n={},n[I]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Bt.r)),j.r.pack(!0)),m.e.pack({itemKeys:T})),n[x]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Bt.s)),j.r.pack(!0)),m.e.pack({itemKeys:U})),n[C]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Bt.a)),j.r.pack(!0)),m.e.pack({itemKeys:F})),n[E]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Bt.t)),j.r.pack(!0)),m.e.pack({itemKeys:H})),n[A]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Bt.o)),j.r.pack(!0)),m.e.pack({itemKeys:R})),n[L]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Bt.i)),j.r.pack(!0)),m.e.pack({itemKeys:N})),n[k]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Bt.e)),j.r.pack(!0)),m.e.pack({itemKeys:B})),n[M]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(G)),j.r.pack(!0)),m.e.pack({itemKeys:V})),n[P]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Bt.n)),j.r.pack(!0)),m.e.pack({itemKeys:z})),n)});var o=[];return T.length>0&&o.push(I),U.length>0&&o.push(x),F.length>0&&o.push(C),H.length>0&&o.push(E),R.length>0&&o.push(A),N.length>0&&o.push(L),B.length>0&&o.push(k),V.length>0&&o.push(M),z.length>0&&h&&o.push(P),r.resolveItems({items:(i={},i[e.itemKey]=Object(a.__assign)({},m.e.pack({itemKeys:o})),i)}),{itemResolver:r}}:void 0,Q=i(Object(u.i)(v.driveItemKey.endpoint)),Y=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}],J="ApiVersion=2.1",X=ge.e.isActivated("ec806106-9a41-4826-810d-712db11fef90","22/7/2022","Use RecentExcludeMediaApp in Prefer Header"),Z=X?"RecentOnlyMediaApp":"RecentExcludeMediaApp",[4,i(we(Object(a.__assign)(Object(a.__assign)({},e),{qosName:c?"recentMedia":Q?"ODC-recent":"recent",itemKey:D,itemSetKeyFacet:St.e,parentItemKeyFacet:wt.e,getUrl:function(e){var t="".concat(Object(l.n)({endpoint:e.driveItemKey.endpoint,driveId:"me"}),"/recent?"),n=ge.e.isActivated("022299AD-ACC7-4C1F-B2E8-010FBC126277","1/7/2022","Narrow filters for media queries");if(Q)t="".concat(e.driveItemKey.endpoint,"/drive/view.recent?");else{if(d&&!n){var i="$filter=(remoteItem/image ne null)",o="$expand=thumbnails";return"".concat(t).concat(i,"&").concat(o)}if(p&&!n)return i="$filter=(remoteItem/image eq null or remoteItem/video ne null)",o="$expand=thumbnails","".concat(t).concat(i,"&").concat(o);if(c)return i="$filter=(remoteItem/image ne null or remoteItem/video ne null)",o="$expand=thumbnails","".concat(t).concat(i,"&").concat(o)}return"".concat(t).concat(function(e){if(!e||0===e.length||Vt&&e.length>8)return"";for(var t=[],n=[],i=0;i<e.length;i++){var r=e[i],o=!1,s=r;Object(Pt.e)(r)&&(s=Object(Pt.t)(r),o=!0),"folder"===s?!o&&t.push("folder ne null"):"onenote"===s?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==s[0]||!o&&t.push("(endsWith(name, '".concat(s.toLowerCase(),"') or endsWith(remoteItem/name, '").concat(s.toLowerCase(),"'))"))}return t.length>0||n.length>0?"&$filter=".concat(0===n.length?Ht(t):0===t.length?Rt(n):Rt(Object(a.__spreadArray)([Ht(t)],n,!0))):""}(r))},getDriveItemFacets:Kt,expectedErrors:Y,preprocessResponse:function(e){return J.indexOf("2.1")<0&&!b&&(d?e=zt(e,"image"):p&&(e=zt(e,"video|^application"))),(t=e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,a=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||a?n?a?n>a?-1:1:-1:1:0}))?t.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t}):t;var t},additionalHeaders:c?{Prefer:"".concat(J,",").concat(Z,",NoPreAuthThumbnailUrls")}:{Prefer:"".concat(J,";ODC,returnparentresource,returnowner")},onProcessResponse:W,groupChildItems:q,scenarioInfo:{scenario:et.e.PopulateRecentFiles,scenarioType:et.t.ActiveUserOperation}})))];case 4:return $=ne.sent().itemResolver,c&&$.resolveItems({items:(ee={},ee[e.itemKey]=Object(a.__assign)({},j.s.pack({})),ee)}),$.mapKeys({mappings:(te={},te[D]=e.itemKey,te)}),i($.execute()),[2]}})})}});function Kt(e){return function(t){var n,i=new g.e({publisher:Kt});i.merge(t(Object(C.e)(e)).itemResolver);var r=e.driveItem,o=r.thumbnails,s=r.remoteItem,c=o||s&&s.thumbnails;return i.resolveItems({items:(n={},n[e.itemKey]=Object(a.__assign)({},c?Object(a.__assign)({},oe.e.pack(!1)):{}),n)}),{itemResolver:i}}}var Wt=n(1829),qt=Object(i.t)(function(){return function(e){e(Object(nt.t)({keyFacet:St.e,facets:[St.e,m.e]})),e(Ot.e),e(Object(s.a)(St.e,at.e)(Gt)),e(Object(dt.e)(St.e,yt.e)(xt)),e(Wt.e)}}),Qt=n(126),Yt=ge.t.isActivated("5F12686F-52A2-4E49-A1D8-A2AE7969622E","10/29/2021","Use multiPart getItem api(ODC vroom) to avoid CORS if KS is not activated.");function Jt(){return function(e){return!e(Object(f.e)({isWinApp:S.E})).isWinApp&&!Yt}}var Xt=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=O.e.deserialize(n);return function(r){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,o,s,c,d,p,m,_,h,b,g,v,y,D,I;return Object(a.__generator)(this,function(x){switch(x.label){case 0:return t=i,r(Object(B.e)(function(e){return e.demandItemFacet(w.d,n)}))?[2]:i.driveId&&"me"!==i.driveId?[3,2]:[4,r($e({endpoint:i.endpoint}))];case 1:(o=x.sent())!==i.endpoint&&(t=Object(a.__assign)(Object(a.__assign)({},i),{endpoint:o})),x.label=2;case 2:return s=Object(l.n)(t),c=i.driveId,d=r(Object(f.e)({disableRemoteItemInPlace:S.i})).disableRemoteItemInPlace,p=d?be:N,[4,r(Object(u.i)(t.endpoint))];case 3:return m=x.sent(),_=r(Jt())&&m,[4,r(Object(u.n)({url:"".concat(Object(l.t)(t),"?$expand=thumbnails"),driveUrl:s,driveId:c,qosName:"getItem",useMultiPartIfSupported:_,endpoint:t.endpoint}))];case 4:return h=x.sent(),b=r(p({driveItemResponse:h,endpoint:t.endpoint})),g=b.itemResolver,v=b.actualItemKey,g.resolveItems({items:(y={},y[e.itemKey]=Object(a.__assign)({},Qt.i.pack(O.e)),y)}),g.mapKeys({mappings:(D={},D[v]=n,D)}),i.driveId&&"me"!==i.driveId||g.mapKeys({mappings:(I={},I[O.e.serialize(Object(a.__assign)(Object(a.__assign)({},i),{driveId:"me"}))]=O.e.serialize(Object(a.__assign)(Object(a.__assign)({},i),{driveId:""})),I[n]=O.e.serialize(t),I)}),r(g.execute()),[2]}})})}}),Zt=!ge.e.isActivated("E4E006D3-AD74-4A5E-AD82-20E4FDF57586","12/01/2022","Add A2OD prefer header in request to get shortcut remoteitem"),$t=!ge.e.isActivated("32BA5FD1-7F6E-4CBD-8613-9FA9B41A194C","03/15/2023","Enable allow throttle queries header to mitigate orderby broken with skip token issue"),en="HonorNonIndexedQueriesWarningMayFailRandomly",tn=Zt?"".concat(en,", ").concat("Include-Feature=AddToOneDrive"):en,nn=$t?"".concat(tn,", ").concat("allowthrottleablequeries"):tn,an="Migration=EnableRedirect;FailOnMigratedFiles",rn=Object(i.i)()(function e(t){var n=this,i=t.itemKey,r=b.deserialize(i),o=r.setItemKey,s=r.endpoint,c=r.token,d=_.e.get(o).deserialize(o),h=d.extFilters,y=d.driveItemKey,D=Object(l.n)(y),I=G.e.matches(o);return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,d,l,_,x,E,A,L,k,M,P,T,U,H,N,B,j,V,z,G,K,W,q,Q,Y,J,X;return Object(a.__generator)(this,function(Z){switch(Z.label){case 0:return[4,t(Object(u.i)(s))];case 1:return n=Z.sent(),r=t(Jt())&&n,d=t(Object(f.e)({convergenceConfiguration:R.e})).convergenceConfiguration,l=null==y?void 0:y.driveId,_=null==d?void 0:d.isMigratedContent,x=l&&_&&_(l),E=n&&x?{Prefer:"".concat(nn)}:void 0,[4,t(Object(u.t)({endpoint:s,url:c,driveUrl:D,headers:E,driveId:y.driveId,useMultiPartIfSupported:r,qosName:"getChildrenPage"}))];case 2:for(A=Z.sent(),L=h&&h.length>0?Nt(h):void 0,k=new g.e({publisher:e}),M=[],P=0,T=A.value;P<T.length;P++)U=T[P],L&&L(U)||(H=U&&(U.parentReference||U.remoteItem&&U.remoteItem.parentReference),N=H&&H.driveId,B=O.e.serialize({itemId:U.id,driveId:N,endpoint:s}),j=null==H?void 0:H.id,V=(null==H?void 0:H.path)===F.e?F.a:j||void 0,z=H?O.e.serialize({itemId:V,driveId:N,endpoint:s}):void 0,G=t(Object(f.e)({allowDisableRemoteItemInPlace:S.i,processDriveItemFromSharePoint:S.k})),K=G.allowDisableRemoteItemInPlace,W=G.processDriveItemFromSharePoint,q=I&&K?he:C.e,M.push(B),k.merge(t(q({itemKey:B,driveItem:U,endpoint:s,parentFolderItemKey:z})).itemResolver),k.resolveItems({items:(X={},X[B]=Object(a.__assign)({},Object(p.e)().forFacet(w.u).thenInvalidate(i,m.e).forFacet(w.d).thenInvalidate(i,m.e).pack()),X)}),W&&(Q=t(W.process({itemKey:B,driveItem:U})).itemResolver,k.merge(Q)));return(Y=A["@odata.nextLink"])&&(J=b.serialize({setItemKey:o,endpoint:s,token:Y}),k.merge(Object(v.t)({itemKey:J}).itemResolver),M.push(J)),k.merge(Object(v.e)({itemKey:i,itemSetKey:o,childItemKeys:M}).itemResolver),t(k.execute()),[2]}})})}}),on=n(669),sn=n(200),cn=n(3662);function dn(e,t){var n=Object(k.t)({},{});return e instanceof on.e&&(n=Object(on.t)(e,function(n){var i,r;switch(n){case 404:return sn.p.pack({});case"sharingPasswordRequired":return Object(a.__assign)(Object(a.__assign)({},cn.e.pack({fixItUrl:null===(r=null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.error)||void 0===r?void 0:r.fixItUrl})),sn.e.pack({}));case 401:return sn.e.pack({});case 0:return sn.g.pack({domain:new x.e(t).domain})}})||Object(k.t)({},{})),n}var ln,un=n(4228),fn=new k.e("enableListViewDataPrefetchConfiguration"),pn=(new k.e("enableQuotaPrefetchConfiguration"),new k.e("prefetchCacheConfiguration")),mn=n(74),_n=!ge.e.isActivated("1B495665-36BF-4607-9FA5-4188B441480C","01/17/2022","Expand thumbnails in parent Item request"),hn=((ln={})[pe.r]="name",ln[pe.s]="lastModifiedDateTime",ln[pe.d]="size",ln[pe.n]="photo/takenDateTime",ln),bn=!ge.e.isActivated("03493AC3-19D5-41B4-819C-AA79F8EF0A6B","07/14/2022","Add special Folder to the select query"),gn=!ge.e.isActivated("0EE393E4-FFA7-42F0-A80F-087B337FC123","04/01/2022","Restrict `loadAndProcessPagedDriveItemSet` to throw 1 error. Throw child error with preference if both child and parent response throw."),vn=!ge.e.isActivated("FC3A83FA-3DF5-4FF4-8DD8-A0B87B3136CC","06/07/2022","Check if the parent item is resolved or not using resolvedAsKeyFacetFacet"),yn=!ge.e.isActivated("3601D612-C2B7-4B43-9EE4-DD98BBE9A680","09/12/2022","Allows processing of user migrated error in ODC prefetch");function Sn(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s,c,d,p,m,_,h,b,v,y,S,D,I,x,C,w,E,A,L,M,P,T,U,F,H,N,V,z,K,W,q,Q,Y,J,X,Z,ee,te,ne,ae,ie,re,oe,se,ce,de,le,ue,fe,pe,me,_e;return Object(a.__generator)(this,function(he){switch(he.label){case 0:return t=e.itemKey,i=e.top,r=e.skip,o=e.disableRemoteItemInPlace,s=G.e.deserialize(t),c=s.driveItemKey,d=s.extFilters,p=s.sortBy,m=s.isAscending,_=s,h=c,c.driveId&&"me"!==c.driveId?[3,2]:[4,n($e({endpoint:c.endpoint}))];case 1:(b=he.sent())!==c.endpoint&&(h=Object(a.__assign)(Object(a.__assign)({},c),{endpoint:b}),_=Object(a.__assign)(Object(a.__assign)({},s),{driveItemKey:h})),he.label=2;case 2:return v=O.e.serialize(h),y=Object(l.n)(h),S=h.driveId||"",[4,n(Object(B.e)(function(e){return{isParentItemResolved:vn?e.demandItemFacet(Qt.i,v)===O.e:e.isItemFacetResolved(O.e,v),totalChildCount:e.isItemFacetResolved(j.e,v)?e.demandItemFacet(j.e,v):void 0,driveType:e.isItemFacetResolved($.e,v)?e.demandItemFacet($.e,v):void 0}}))];case 3:return D=he.sent(),I=D.isParentItemResolved,x=D.totalChildCount,C=D.driveType,w=n(Object(u.i)(h.endpoint)),E=n(Jt())&&w,A=n(Object(f.e)({convergenceConfiguration:R.e,enableListViewDataPrefetchConfiguration:fn,prefetchCache:pn,isUnauthenticated:Ve.e})),L=A.convergenceConfiguration,M=A.enableListViewDataPrefetchConfiguration,P=A.prefetchCache,T=A.isUnauthenticated,U=void 0!==T&&T,F=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"},{code:"userContentMigrated"}],H=L&&L.canHandleUserMigration,N=null==L?void 0:L.isMigratedContent,V=S&&N&&N(S),z=Promise.resolve(void 0),I||(K=function(e){var t=e.driveItem,n=Object(l.t)(t);if(!n)return"";var a=new mn.t(n);return ge.e.isActivated("8FDE7872-BA01-4201-BD71-AB3447C7568E","03/29/2023","Enable webDavUrl in parent Item request")?a.setQueryParameter("$select","*,sharepointIds"):a.setQueryParameter("$select","*,sharepointIds,webDavUrl"),_n&&a.setQueryParameter("$expand","thumbnails"),a.toString()}({driveItem:h}),W="getItem",q=function(){return n(Object(u.n)({url:K,driveUrl:y,driveId:S,useMultiPartIfSupported:E,qosName:W,endpoint:h.endpoint,headers:w&&H?{Prefer:an}:void 0,expectedErrors:w?F:void 0,scenarioInfo:{scenario:et.e.BrowseFiles,scenarioType:et.t.ActiveUserOperation}}))},M&&P?(ee=P.getData({url:K,qosName:W}),z=ee?ee.catch(function(e){if(yn&&e instanceof on.e&&"userContentMigrated"===e.code)throw e;return q()}):q()):z=q()),Q=function(e){var t=e.driveItem,n=e.skip,i=e.totalChildCount,r=e.isConsumerEndpoint,o=e.isMigratedContent,s=e.isUnauthenticated,c=e.enableDefaultSortOrderFromBackend,d=e.sortBy,u=e.isAscending,f=e.extFilters,p=e.top,m=Object(l.t)(t),_=n?"&skiptoken=".concat(n+1,"/").concat(i,"&skip=").concat(n):"",h=c?"&orderby=folder,".concat(o||s?"name":"savedSortFieldValue"):"",b=d&&void 0!==u?function(e,t){return"&orderby=folder,".concat(hn[e]," ").concat(t?"asc":"desc")}(d,u):h,g=function(e){if(!e||0===e.length)return"";e.unshift("folder");for(var t=[],n=[],i=0,r=Object(Ut.e)(e);i<r.length;i++){var o=r[i],s=!1,c=o;if(Object(Pt.e)(o)&&(c=Object(Pt.t)(o),s=!0),s)return"";if(Object(Tt.e)(c))return"";if(!Ft)return"";if("media"===c)t.push("photo ne null"),t.push("video ne null");else if("photo"===c)t.push("photo ne null");else if("video"===c)t.push("video ne null");else{if("folder"!==c)return"";t.push("folder ne null")}}return t.length>0||n.length>0?"&$filter=".concat(0===n.length?Ht(t):0===t.length?Rt(n):Rt(Object(a.__spreadArray)([Ht(t)],n,!0))):""}(f),v=bn?",specialFolder":"",y="thumbnails".concat(r?",lenses,tags":"");return"".concat(m,"/children?$top=").concat(p).concat(_).concat(b,"&$expand=").concat(y,"&select=*,ocr,webDavUrl,sharepointIds,isRestricted,commentSettings").concat(v).concat(g)}({driveItem:c,skip:r,totalChildCount:x,isConsumerEndpoint:w,isMigratedContent:!!V,isUnauthenticated:U,enableDefaultSortOrderFromBackend:un.e,sortBy:p,isAscending:m,extFilters:d,top:i}),Y="getChildren.folder",J=V?{Prefer:"".concat(nn)}:void 0,X=function(){return n(Object(u.n)({url:Q,driveUrl:y,driveId:S,qosName:Y,useMultiPartIfSupported:E,endpoint:h.endpoint,headers:w&&H?{Prefer:an}:J,expectedErrors:F,scenarioInfo:{scenario:et.e.BrowseFiles,scenarioType:et.t.ActiveUserOperation}}))},M&&P?(ee=P.getData({url:Q,qosName:Y}),Z=ee?ee.catch(function(e){if(yn&&e instanceof on.e&&"userContentMigrated"===e.code)throw e;return X()}):X()):Z=X(),te=!1,Ie.e(De.e.dataFetch.start)||(Ie.t(De.e.dataFetch.start),te=!0),gn?[4,z.catch(function(t){ie=n(function(e,t){var n=e.error;return function(i){var r,o=dn(n,t),s=Object(k.n)({accessDeniedError:sn.e,passwordProtectedError:cn.e},o),c=s.accessDeniedError,d=s.passwordProtectedError,l=new Ce.e({facets:o,innerError:new Ce.e(n)});if(c&&d){var u=new g.e;u.updateItems({items:(r={},r[e.itemKey]=Object(a.__assign)({},Qt.t.pack(l)),r)}),i(u.execute())}return l}}(Object(a.__assign)(Object(a.__assign)({},e),{error:t}),h.endpoint))})]:[3,6];case 4:return ne=he.sent(),[4,Z.catch(function(t){re=n(Dn(Object(a.__assign)(Object(a.__assign)({},e),{error:t,parentItemError:ie}),h.endpoint))})];case 5:if(ae=he.sent(),re)throw re;if(ae=ae,ie)throw ie;return[3,8];case 6:return oe=[Z.catch(function(t){throw n(Dn(Object(a.__assign)(Object(a.__assign)({},e),{error:t}),h.endpoint))}),z],[4,Promise.all(oe)];case 7:ue=he.sent(),ae=ue[0],ne=ue[1],he.label=8;case 8:return te&&Ie.t(De.e.dataFetch.end),ne&&(ne.folder&&(x=ne.folder.childCount),ne.parentReference&&ne.parentReference.driveType&&(C=ne.parentReference.driveType)),se=n(Object(u.r)(h.endpoint,C)),(ce=new g.e({publisher:Sn})).mapKeys({mappings:(fe={},fe[G.e.serialize(_)]=e.itemKey,fe[v]=O.e.serialize(s.driveItemKey),fe)}),s.driveItemKey.driveId&&"me"!==s.driveItemKey.driveId||((null===(_e=null==ne?void 0:ne.parentReference)||void 0===_e?void 0:_e.driveId)&&ce.mapKeys({mappings:(pe={},pe[G.e.serialize(Object(a.__assign)(Object(a.__assign)({},_),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},_.driveItemKey),{driveId:ne.parentReference.driveId})}))]=e.itemKey,pe)}),ce.mapKeys({mappings:(me={},me[O.e.serialize(Object(a.__assign)(Object(a.__assign)({},s.driveItemKey),{driveId:"me"}))]=O.e.serialize(Object(a.__assign)(Object(a.__assign)({},s.driveItemKey),{driveId:""})),me)})),le=(de=ce).merge,[4,n(xe({itemKey:t,itemSetKeyFacet:G.e,parentItemKeyFacet:O.e,parentItemResponse:ne,childItemsResponse:ae,disableRemoteItem:o,filterChildItems:d&&d.length>0?Nt(d):void 0,skip:r,enableRandomAccess:se,totalChildCount:x,onProcessResponse:function(e){var t,n=e.driveItemKey,i=new g.e({publisher:Sn});return n&&i.resolveItems({items:(t={},t[O.e.serialize(n)]=Object(a.__assign)({},Qt.i.pack(O.e)),t)}),{itemResolver:i}}}))];case 9:return le.apply(de,[he.sent().itemResolver]),[2,ce]}})})}}function Dn(e,t){var n=e.error,i=e.parentItemError;return function(r){var o,s=dn(n,t),c=Object(k.n)({itemNotFoundError:sn.p,accessDeniedError:sn.e,networkBlockedError:sn.g},s),d=c.itemNotFoundError,l=c.accessDeniedError,u=c.networkBlockedError,f=Object(k.n)({passwordProtectedError:cn.e},i instanceof Ce.e?i.facets:Object(k.t)({},{})).passwordProtectedError,p=new Ce.e({facets:Object(a.__assign)(Object(a.__assign)({},s),f?cn.e.pack(f):{}),innerError:new Ce.e(n)});if(d||l||u){var _=new g.e;_.updateItems({items:(o={},o[e.itemKey]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},m.e.pack(void 0)),m.o.pack(void 0)),Qt.t.pack(p)),o)}),r(_.execute())}return p}}var In=Object(i.i)()(function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(a.__generator)(this,function(r){switch(r.label){case 0:return t=n(Object(f.e)({pageSize:S.r})).pageSize,[4,n(Sn(Object(a.__assign)(Object(a.__assign)({},e),{disableRemoteItemInPlace:!0,skip:0,top:t||F.t})))];case 1:return i=r.sent(),Ie.t(De.e.resolveData.start),n(i.execute()),Ie.t(De.e.resolveData.end),[2]}})})}}),xn=Object(i.t)(function(){return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return e(Object(nt.t)({keyFacet:G.e,facets:[G.e,m.e]})),e(Object(s.a)(G.e,at.e)(In)),[2]})})}}),Cn=n(44),On=n(152),wn=n(370),En=n(492);function An(e,t){var n=t.folderItemKey,i=t.itemSet;if(n&&i){var r=e.demandItemFacet(W.e,n),o=function(e,t){return!("photo"===(null==e?void 0:e.folderType))&&t===pe.t}(null==r?void 0:r.folder,i.sortBy)?"":i.sortBy;return Object(a.__assign)(Object(a.__assign)({},i),{sortBy:o})}return i}function Ln(e,t){var n,i,r=Object(Cn.e)(e),o={},s=e.demandItemFacet(G.e,t.itemKey),c=e.demandItemFacet(O.e,t.itemKey),d=e.demandItemFacet(Q.e,t.itemKey,{suppressGetItems:!0}),l=e.demandItemFacet(q.e,t.itemKey,{suppressGetItems:!0});if(ge.e.isActivated("09AA0112-641E-4D73-805E-DBCD89D22C3D","9/30/2021","Use new shortcutItemFacet for shortcut checks")){if(l&&t.itemKey)return i={driveItemKey:l,sortBy:"",isAscending:!0},f=G.e.serialize(i),Object(a.__assign)(Object(a.__assign)({},kn(0,{itemSetKey:f,parentItemKey:O.e.serialize(i.driveItemKey),stageItem:t.stageItem})),{itemKey:wn.e.serialize({localItemKey:t.itemKey,remoteItemKey:f})})}else if(d&&t.itemKey){var u=e.demandItemFacet(O.e,d.itemKey);if(u){i={driveItemKey:u,sortBy:"",isAscending:!0};var f=G.e.serialize(i);return Object(a.__assign)(Object(a.__assign)({},kn(0,{itemSetKey:f,parentItemKey:O.e.serialize(i.driveItemKey),stageItem:t.stageItem})),{itemKey:wn.e.serialize({localItemKey:t.itemKey,remoteItemKey:f})})}}if(s){var p=c||s.driveItemKey;i=An(e,{folderItemKey:O.e.serialize(p),itemSet:s}),n=kn(0,{itemSetKey:G.e.serialize(i||s),parentItemKey:O.e.serialize(s.driveItemKey),stageItem:t.stageItem}),o={itemKey:t.itemKey}}else i=function(e,t){var n=t.folderItemKey,i=t.currentItemSetKey;if(i&&n){var r=e.demandItemFacet(G.e,i),o=e.demandItemFacet(O.e,n);if(r&&o){if(!ge.e.isActivated("D8B0FDDF-555D-49A4-B069-D03ED692694A","11/4/2021","Do not emit item set key for non-folder items")&&o.itemId&&"root"!==o.itemId&&!e.demandItemFacet(w._,n))return;var s=o.endpoint,c=o.driveId,d=o.itemId;return Object(a.__assign)(Object(a.__assign)({},r),{driveItemKey:{endpoint:s,driveId:c,itemId:d}})}}}(e,{folderItemKey:t.itemKey,currentItemSetKey:r}),o=(f=(i=An(e,{folderItemKey:t.itemKey,itemSet:i}))?G.e.serialize(i):void 0)?{itemKey:f}:{},n=i&&f&&kn(0,{itemSetKey:f,parentItemKey:O.e.serialize(i.driveItemKey),stageItem:t.stageItem});var m=Object(En.e)(e),_=m?e.demandItemFacet(O.e,m.localItemKey):void 0;if(m&&(i||o||c)){var h=_&&_.driveId,b=s&&s.driveItemKey&&s.driveItemKey.driveId||c&&c.driveId,g=i?G.e.serialize(i):s?G.e.serialize(s):c?O.e.serialize(c):void 0;if(h!==b&&g)return Object(a.__assign)({itemKey:wn.e.serialize({localItemKey:m.localItemKey,remoteItemKey:g})},n?{stageItem:n}:{})}return Object(a.__assign)(Object(a.__assign)({},o),n?{stageItem:n}:{})}function kn(e,t){var n=this,i=t.parentItemKey,r=t.itemSetKey,o=t.stageItem;if(i)return o?Object(On.t)(function(e){var t=e.itemsScopeItemKey,s=e.currentItemKey;return function(e){return Object(a.__awaiter)(n,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(c){switch(c.label){case 0:return e(Object(nt.e)({items:(n={},n[r]=Object(a.__assign)({},m.r.pack({itemKey:i})),n)})),[4,e(o({currentItemKey:s,itemsScopeItemKey:t}))];case 1:return c.sent(),[2]}})})}}):void 0}var Mn=n(267),Pn=n(407),Tn=new _.e("driveItemVirtualizedPage",{endpoint:h.e,setItemKey:h.e,skip:Pn.e,top:Pn.e}),Un=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Tn.deserialize(n),r=i.setItemKey,o=i.top,s=i.skip;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(a.__generator)(this,function(c){switch(c.label){case 0:return[4,n(Sn(Object(a.__assign)(Object(a.__assign)({},e),{itemKey:r,disableRemoteItemInPlace:!1,skip:s,top:o})))];case 1:return(t=c.sent()).resolveItems({items:(i={},i[r]=Object(a.__assign)({},Object(p.e)().forFacet(m.e).thenInvalidate(e.itemKey,m.e).pack()),i)}),n(t.execute()),[2]}})})}}),Fn=n(1501),Hn=n(605);function Rn(e,t){var n=t.handlers,i=t.itemKey,r=e.demandItemFacet(G.e,i),o=e.demandItemFacet(Hn.e,i);if(n&&(r||o)){for(var s=[],c=0,d=n;c<d.length;c++){var l=d[c];if(l.key===It.l.key)s.push("photo");else if(l.key===It.u.key)s.push("video");else if(l.key===It.a.key)s.push("folder");else if(l.key===It.n.key)s.push("file");else if(l.key===It.d.key)s.push("onenote");else if(l.key===It.s.key)s.push("!photo");else if(l.key===It.c.key)s.push("!video");else if(l.key===It.r.key)s.push("!folder");else if(l.key===It.o.key)s.push("!onenote");else{var u=Object(Dt.e)(l);u&&s.push(u)}}if(r)return{itemKey:G.e.serialize(Object(a.__assign)(Object(a.__assign)({},r),{extFilters:s}))}}return{}}var Nn=n(1499),Bn=n(1584),jn=n(1326);function Vn(e,t){return{validator:jn.e}}var zn=n(278);function Gn(e,t){var n,a,i=t.itemKey,r=Object(zn.e)(e,{itemKey:i}),o=e.demandItemFacet(O.e,r),s=e.demandItemFacet(G.e,i),c=e.demandItemFacet(Hn.e,i);if(!o&&!s&&!c)return{};var d=null!==(a=null!==(n=null==c?void 0:c.driveItemKey)&&void 0!==n?n:null==s?void 0:s.driveItemKey)&&void 0!==a?a:o,l=null==d?void 0:d.endpoint,u=null==d?void 0:d.driveId,f=l&&u?e.demandItemFacet(O.e,O.e.serialize({endpoint:l,driveId:u,itemId:"root"})):void 0;return{isAvailable:!0,query:null==c?void 0:c.searchTerm,getSearchItemKey:function(e){var t;if(d)return Hn.e.serialize({driveItemKey:d,searchTerm:e||"",scope:null!==(t=null==c?void 0:c.scope)&&void 0!==t?t:(null==f?void 0:f.itemId)===(null==o?void 0:o.itemId)?"drive":"folder"})}}}var Kn=n(1510),Wn=n(1058),qn=n(1509),Qn=n(1314),Yn=n(706),Jn=n(628),Xn=n(689),Zn=n(426),$n=n(427),ea=n(3012);function ta(e,t){var n=t.itemKey;return e.demandItemFacet(se.e,n)?{isAvailable:!1}:{isAvailable:e.demandItemFacet(ea.e,n)}}var na=n(59);function aa(e,t){var n=t.itemKey,a=Object(na.e)(e);return e.demandItemFacet(ot,a)&&!e.demandItemFacet(se.e,n)?{isAvailable:!1}:{isAvailable:e.demandItemFacet(ea.a,n),validator:jn.e}}var ia=n("react-lib"),ra=n(54),oa=n(4822),sa=n(117);function ca(e,t){var n=t.itemKey,a=e.demandItemFacet(ea.t,n),i=e.demandItemFacet(q.e,n);return{isAvailable:a&&!i,deleteWizard:da}}Object(sa.n)([{rawString:".informationContainer_9d9ce1da{background-color:#f3f2f1;border-radius:8px;box-sizing:border-box;display:flex;gap:8px;padding:8px 12px;width:100%}.informationContainer_9d9ce1da .infoIcon_9d9ce1da{color:#616161;font-family:FabricMDL2Icons;font-size:16px}.informationContainer_9d9ce1da .informationText_9d9ce1da{color:#242424;font-size:12px;line-height:16px;margin:0}"}]);var da=Object(ra.t)(function(e,t){var n,i=t.itemKeys,r=t.defaultRender,o=Object(a.__rest)(t,["itemKeys","defaultRender"]),s=e.demandItemFacet(w.d,i[0]);if(1===i.length){var c=e.demandItemFacet(w.u,i[0]);n=Object(a.__assign)(Object(a.__assign)({},o),{getDeleteWizardStrings:function(e){return Object(a.__assign)(Object(a.__assign)({},o.getDeleteWizardStrings(e)),{confirmTitle:s?oa.o:oa.e,confirmText:s?Qe.format(oa.r,c):oa.t})}})}else i.length>0&&(n=Object(a.__assign)(Object(a.__assign)({},o),{getDeleteWizardStrings:function(e){return Object(a.__assign)(Object(a.__assign)({},o.getDeleteWizardStrings(e)),{confirmTitle:s?oa.o:oa.e,confirmText:s?oa.i:oa.n})}}));var d=!1;ge.e.isActivated("940C7189-6004-4F43-BF51-0CC7401767E7","02/25/2022","Enable Photo story delete prompt when deleting an item used in photo story")||(d=i.some(function(t){return e.demandItemFacet(fe.e,t)}));var l=n||o;return r?ia.createElement(r,Object(a.__assign)({itemKeys:i},l),d&&ia.createElement("div",{className:"informationContainer_9d9ce1da"},ia.createElement("div",{className:"infoIcon_9d9ce1da"},""),ia.createElement("p",{className:"informationText_9d9ce1da"},oa.a))):null});function la(e,t){var n=t.itemKey;return e.demandItemFacet(se.e,n)?{isAvailable:!1}:{isAvailable:e.demandItemFacet(ea.i,n)}}var ua=n(3247),fa=!ge.e.isActivated("13F88196-AC5C-4718-8E30-A5727F39F771","01/20/2023","Enables AV override on file downloads for item owners");function pa(e,t){if(1!==t.itemKeys.length)return{};var n=t.itemKeys[0];if(e.demandItemFacet(w._,n))return{};var i=e.demandItemFacet(O.e,n),r=i?Object(l.t)(i):void 0,o=i?Object(l.n)(i):void 0,s=null==i?void 0:i.driveId,c=i&&i.endpoint||"",d=i&&Object(ua.e)(e,{driveItemKey:i});return{isAvailable:e.demandItemFacet(ea.n,n),getDownloadData:r&&o?function(){return function(e){var t=this,n=e.itemUrl,i=e.driveUrl,r=e.driveId,o=e.endpoint,s=e.isOwner;return function(c){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,d,l,f,p;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,c(Object(u.t)({url:e.itemUrl,driveUrl:i,driveId:r,method:"GET",qosName:"getItemDownloadUrl",endpoint:o}))];case 1:if(t=a.sent(),d=function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}(n)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"],!d)throw new Error("Unable to obtain download URL.");return fa&&s&&((l=new mn.t(d)).setQueryParameter("AVOverride","1"),d=l.toString()),[2,{method:"GET",url:d}];case 2:throw(f=a.sent())instanceof on.e?(p=Object(on.t)(f,function(e,t){switch(e){case"unauthenticated":case 401:return sn.a.pack({});case"itemNotFound":case 404:return sn.c.pack({});case"accessDenied":case 403:return sn.e.pack({});default:return sn.v.pack({})}}),new Ce.e({innerError:f,facets:p})):f;case 3:return[2]}})})}}({itemUrl:r,driveUrl:o,driveId:s,endpoint:c,isOwner:d})}:void 0}}function ma(e,t){var n=t.itemKey,i=e.demandItemFacet(O.e,n);return{isAvailable:!0,getShareLink:function(){return function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return(t=e.driveItem)?(i=Object(l.t)(t)+"/invite",r=Object(l.n)(t),o=t.driveId,[4,n(Object(u.n)({url:i,driveUrl:r,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,driveId:o,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))]):[3,2];case 1:if(!(s=a.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:s.value[0].link.webUrl,scope:s.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}}({driveItem:i})}}}function _a(e,t){var n=t.itemKey,i=t.link,r=t.recipients,o=e.demandItemFacet(O.e,n);return{isAvailable:!0,permissionInvite:function(){return function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s,c,d,l,f,p,m;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(i=e.link,r=e.recipients,!(t=e.driveItem)||!i)throw new Error("Unable to obtain default share URL");return o=t.endpoint,s=t.driveId,d=btoa(i),c="u!"+d.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-"),l=r.map(function(e){return{email:e}}),f={recipients:l,roles:["read"]},p=o.replace("v1.0","beta"),m=p+"/shares/"+c+"/permission/grant",[4,n(Object(u.n)({url:m,driveId:s,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:f}))];case 1:return[2,{recipients:a.sent().value[0].grantedToIdentities.map(function(e){return{email:e.user.email}})}]}})})}}({driveItem:o,link:i,recipients:r})}}}var ha=n(1356),ba=n(1736),ga=n(46),va=n(3765),ya=n(4229),Sa=n(906),Da=n(3017),Ia=!ge.t.isActivated("9E25FA89-BCCC-4B1B-A51A-07D2E059CA43","06/16/2022","Enable shortcut tags in engagement extra data");function xa(e,t){var n=t.itemsScopeItemKey,i=t.engagement,r=t.itemKey,o=i&&i.name,s=e.demandItemFacet(G.e,r),c=(null==s?void 0:s.driveItemKey)||e.demandItemFacet(O.e,r),d=c&&Object(ua.e)(e,{driveItemKey:c}),l=e.demandItemFacet(wn.e,r),u=void 0,f=void 0;if(Ia)if(l)e.demandItemFacet(G.e,l.remoteItemKey)?u=!0:f=!0;else{var p=e.demandItemFacet(Ye.n,n);f=!!e.demandItemFacet(wn.e,p&&p.itemKey)}var m,_=c||{},h=_.driveId,b=void 0===h?"me":h,g=_.itemId,v=void 0===g?"root":g;return"me"===b&&"root"===v?m="MyFiles":(s||"root"===v)&&(m="Folder"),{engagement:Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},(null==i?void 0:i.datasource)?{}:{datasource:"Graph"}),m?{objectType:m}:{}),{extraData:Object(a.__assign)({itemGraphId:v,itemGraphDriveId:b,isOwner:!!d,isShortcut:u,isInsideAShortcut:f},"ItemsView.Load"===o?Object(ft.e)(e,{itemsScopeItemKey:n}):{})})}}function Ca(e,t){var n=t.currentItemKey,a=e.demandItemFacet(G.e,n),i=(null==a?void 0:a.driveItemKey)||e.demandItemFacet(O.e,n)||{},r=i.driveId,o=void 0===r?"me":r,s=i.itemId;return{engagement:{currentPage:"me"===o&&"root"===(void 0===s?"root":s)?"MyFiles":"Folder"}}}var Oa=Object(i.t)(function(){return function(e){e(Object(dt.e)(O.e,lt.e)(xa)),e(Object(dt.e)(G.e,lt.e)(xa)),e(Object(dt.e)(O.e,ut.e)(Ca))}}),wa=Object(i.t)(function(){return function(e){var t=e(Object(f.e)({useBatchedDeleteConfiguration:S.R})).useBatchedDeleteConfiguration;e(Object(nt.t)({keyFacet:O.e,facets:[O.e,w.u,w.m,w._,Q.e,q.e,w.A,w.c,m.t,w.k,w.i,w.f,te.a]})),e(Object(nt.t)({keyFacet:b,facets:[b,m.e,m.a]})),e(xn),e(Object(s.a)(O.e,at.e)(Xt)),e(Object(s.a)(Tn,at.e)(Un)),e(Object(s.a)(b,at.e)(rn)),e(Object(dt.e)(O.e,Mn.e)(Ln)),e(Object(dt.e)(G.e,Mn.e)(Ln)),e(Oa),e(Object(dt.e)(G.e,Da.e)(Gn)),e(Object(dt.e)(G.e,yt.e)(Rn)),e(Object(s.a)(O.e,Kn.t)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(23).then(n.bind(null,5310))];case 1:return[2,e.sent().driveItemCreateFolderOperationHandler]}})})}))),e(t?Object(s.a)(O.e,Wn.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(537).then(n.bind(null,5311))];case 1:return[2,e.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):Object(s.a)(O.e,Wn.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(24).then(n.bind(null,4444))];case 1:return[2,e.sent().driveItemDeleteItemsOperationHandler]}})})}))),e(Object(dt.e)(O.e,va.e)(e(Object(ga.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(20).then(n.bind(null,5312))];case 1:return[2,e.sent().driveItemDeleteProgressControlHandler]}})})})))),e(Object(s.a)(O.e,qn.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(26).then(n.bind(null,5313))];case 1:return[2,e.sent().driveItemRenameItemOperationHandler]}})})}))),e(Object(s.a)(O.e,Qn.t)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(27).then(n.bind(null,5561))];case 1:return[2,e.sent().driveItemUploadItemsOperationHandler]}})})}))),e(Object(s.a)(O.e,Nn.t)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(25).then(n.bind(null,5314))];case 1:return[2,e.sent().driveItemMoveCopyItemsOperationHandler]}})})}))),e(Object(s.a)(O.e,Fn.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(19).then(n.bind(null,5315))];case 1:return[2,e.sent().addToOneDriveOperationHandler]}})})}))),e(Object(dt.e)(O.e,Yn.e)(ta)),e(Object(dt.e)(O.e,Bn.e)(Vn)),e(Object(dt.e)(O.e,Jn.e)(aa)),e(Object(dt.e)(O.e,Xn.t)(ca)),e(Object(dt.e)(O.e,Zn.e)(la)),e(Object(dt.e)(O.e,ha.e)(ma)),e(Object(dt.e)(O.e,ba.e)(_a)),e(Object(dt.e)(O.e,$n.t)(pa)),e(Object(dt.e)(O.e,Sa.e)(ya.e))}}),Ea=n(3312),Aa=n(3311),La=ge.e.isActivated("1097DC43-A3D7-4151-A119-48637C6D4534","04/05/2022","Fixes itemsscope + ko shim logic related to items with view-only permissions"),ka=Object(i.i)()(function e(t){var n=this;return function(i){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,o,s,c,d,u;return Object(a.__generator)(this,function(f){switch(f.label){case 0:return n=t.itemKey,r=Aa.e.deserialize(n),o=r.endpoint,s=Object(l.n)(r),[4,i(Ma({url:Object(l.e)(r),driveUrl:s,qosName:"commands",endpoint:o}))];case 1:return c=f.sent(),(d=new g.e({publisher:e})).resolveItems({items:(u={},u[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},Ea.e.pack(c.addToOneDrive)),Ea.t.pack(c.createFolder)),Ea.n.pack(c.createLink)),Ea.a.pack(c.delete)),Ea.i.pack(c.download)),Ea.r.pack(c.invite)),Ea.o.pack(c.move)),Ea.s.pack(c.officeLens)),Ea.c.pack(c.rename)),Ea.d.pack(c.upload)),u)}),i(d.execute()),[2]}})})}});function Ma(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(a.__generator)(this,function(a){return t=e.endpoint,i=n(Object(u.i)(t)),[2,{addToOneDrive:{roles:La||i?["write"]:["owner","write","read"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}var Pa=Object(i.t)(function(){return function(e){e(Object(nt.t)({keyFacet:Aa.e,facets:[Ea.e,Ea.t,Ea.n,Ea.a,Ea.i,Ea.r,Ea.o,Ea.s,Ea.c,Ea.d]})),e(Object(s.a)(Aa.e,at.e)(ka))}});function Ta(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,r=e.childItemsResponse,o=e.disableRemoteItem,s=e.parentItemResponse,c=e.mapItemSetKey,d=n.deserialize(t),l=i.serialize(d),u=d.driveItemKey.endpoint;return function(n){var i,d;Ie.t(De.e.processData.start);var _=n(Se(Object(a.__assign)(Object(a.__assign)({},e),{response:r,disableRemoteItem:o,parentItemKey:l}))).itemResolver;if(c){var h=c().itemResolver;_.merge(h)}var b=n(Object(f.e)({allowDisableRemoteItemInPlace:S.i})).allowDisableRemoteItemInPlace;if(s){var g=n((b&&o?be:N)({setItemKey:t,driveItemResponse:s,endpoint:u})),v=g.itemResolver,y=g.actualItemKey;_.mapKeys({mappings:(i={},i[y]=l,i)}),_.merge(v)}return _.resolveItems({items:(d={},d[l]=Object(a.__assign)({},Object(p.e)().forFacet(m.t).thenInvalidate(e.itemKey,m.e).pack()),d)}),Ie.t(De.e.processData.end),{itemResolver:_}}}var Ua=ge.t.isActivated("cade488d-480a-444f-a1ea-d3d121529bb7","11/01/2021","Set one minute timeout for API requests");function Fa(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,r=e.getUrl,o=e.sortChildItems,s=e.qosName,c=e.preprocessResponse,d=e.expectedErrors,f=e.disableRemoteItem,p=void 0!==f&&f,m=i.deserialize(n),_=m.driveItemKey,h=_.endpoint,b=_.driveId;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,f,_,g,v;return Object(a.__generator)(this,function(y){switch(y.label){case 0:t=Object(l.n)(m.driveItemKey),y.label=1;case 1:return y.trys.push([1,4,,5]),[4,n(Object(u.n)({url:r(m),driveUrl:t,driveId:b,qosName:"getChildren".concat(s?".".concat(s):""),endpoint:h,headers:e.additionalHeaders,expectedErrors:d,timeout:Ua?void 0:6e4,scenarioInfo:{scenario:et.e.Search,scenarioType:et.t.ActiveUserOperation}}))];case 2:return i=y.sent(),f=Object(a.__spreadArray)([],i.value,!0),_=c&&c(f)||i.value,g=o&&o(_)||_,[4,n(Ta(Object(a.__assign)(Object(a.__assign)({},e),{disableRemoteItem:p,childItemsResponse:Object(a.__assign)(Object(a.__assign)({},i),{value:g})})))];case 3:return[2,{itemResolver:y.sent().itemResolver}];case 4:throw v=y.sent(),new Ce.e(Object(a.__assign)({code:"UnknownError"},v instanceof Error?{innerError:v}:{message:JSON.stringify(v)}));case 5:return[2]}})})}}var Ha=n(926),Ra=Object(i.i)()(function(e){var t=this,n=Hn.e.deserialize(e.itemKey);return function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,r,o,s,c,d,l,p,m,_,h;return Object(a.__generator)(this,function(b){switch(b.label){case 0:return t=i(Object(f.e)({graphSearchEndpoint:S.x,convergenceConfiguration:R.e,consumerDirectEndpoint:S.h})),r=t.graphSearchEndpoint,o=t.convergenceConfiguration,s=t.consumerDirectEndpoint,c=null==o?void 0:o.isUserMigrated,d=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}],l=n,r?(l=Object(a.__assign)(Object(a.__assign)({},l),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},l.driveItemKey),{endpoint:r})}),[3,3]):[3,1];case 1:return l.driveItemKey.driveId&&"me"!==l.driveItemKey.driveId?[3,3]:[4,i($e({endpoint:l.driveItemKey.endpoint}))];case 2:(p=b.sent())!==l.driveItemKey.endpoint&&(l=Object(a.__assign)(Object(a.__assign)({},l),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},l.driveItemKey),{endpoint:p})})),b.label=3;case 3:return m=Hn.e.serialize(l),[4,i(Fa(Object(a.__assign)(Object(a.__assign)({},e),{itemKey:m,qosName:"search".concat(c?".migratedUser":""),itemSetKeyFacet:Hn.e,parentItemKeyFacet:Ha.e,getUrl:function(e){var t=e.driveItemKey,n=i(Object(u.i)(t.endpoint));return function(e,t,n,i){var r,o=e.searchTerm,s=e.extFilters,c=e.dateFilter,d=e.scope,l=e.driveItemKey;o&&(r=encodeURIComponent(o).replace(/'/g,"''"));var u=function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var r=e[i],o=!1,s=r;Object(Pt.e)(r)&&(s=Object(Pt.t)(r),o=!0),"folder"===s?!o&&t.push("folder ne null"):"onenote"===s?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==s[0]?"audio"===s?!o&&t.push("audio ne null"):"document"===s?!o&&t.push("file ne null and video eq null and image eq null and audio eq null and folder eq null"):"media"===s&&!o&&t.push("image ne null or video ne null"):!o&&t.push("(endsWith(name, '".concat(s.toLowerCase(),"') or endsWith(remoteItem/name, '").concat(s.toLowerCase(),"'))"))}return t.length>0||n.length>0?"&$filter=( ".concat(0===n.length?Ht(t):0===t.length?Rt(n):Rt(Object(a.__spreadArray)([Ht(t)],n,!0))," )"):""}(s),f=function(e,t){return""!==e?"".concat(e).concat(t?" and ".concat(t):""):t?"&$filter=".concat(t):""}(u,(null==c?void 0:c.beginDate)?"( createdDateTime ge ".concat(c.beginDate," )"):"");if(t||i){var p=l;return n&&(p=Object(a.__assign)(Object(a.__assign)({},l),{endpoint:t?l.endpoint:n})),"".concat(Na(d,p),"/oneDrive.search(q=@s)?@s='").concat(r,"'").concat(f,"&$expand=thumbnails&select=*,webDavUrl,ocr")}return"".concat(Na(d,l),"/search(q=@s)?@s='").concat(r,"'&$expand=thumbnails&select=*,webDavUrl,ocr")}(l,n,s,c)},expectedErrors:d})))];case 4:return(_=b.sent().itemResolver).mapKeys({mappings:(h={},h[m]=e.itemKey,h)}),i(_.execute()),[2]}})})}});function Na(e,t){return"drive"===e?Object(l.n)(t):Object(l.t)(t)}var Ba=Object(i.i)()(function(e){var t=this,n=Ha.e.deserialize(e.itemKey),i=n.searchTerm,r=n.driveItemKey,o=n.scope;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(a.__generator)(this,function(c){return t=Qe.format(X.i,i),n(Object(nt.e)({items:(s={},s[e.itemKey]=Object(a.__assign)(Object(a.__assign)({},w.u.pack(t)),m.t.pack(Object(a.__assign)(Object(a.__assign)({itemKey:Hn.e.serialize({driveItemKey:r,searchTerm:i,scope:o})},w._.pack({})),w.k.pack(void 0)))),s)})),[2]})})}}),ja=Object(i.t)(function(){return function(e){e(Object(nt.t)({keyFacet:Ha.e,facets:[w.u,m.t]})),e(Object(s.a)(Ha.e,at.e)(Ba)),e(Object(nt.t)({keyFacet:Hn.e,facets:[m.e]})),e(Object(s.a)(Hn.e,at.e)(Ra)),e(Object(dt.e)(Hn.e,Da.e)(Gn))}}),Va=n(4686),za=n(4207),Ga=n(818),Ka=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Y.e.deserialize(n).driveItemKey,r=i.endpoint,o=i.driveId;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s,c,d,p,m,_,h,b=this;return Object(a.__generator)(this,function(g){return t={Caller:"HoverCard"},s=e(Object(f.e)({enableCookiesForAnalyticsRequests:S.c})).enableCookiesForAnalyticsRequests,c=void 0!==s&&s,d="GetItemAnalytics_addon-graph",p=Object(a.__awaiter)(b,void 0,void 0,function(){var s,f,p,m,_,h;return Object(a.__generator)(this,function(b){switch(b.label){case 0:return[4,e(Object(u.n)({url:(g=Object(l.t)(i),v=Wa(g),y="$select=*".concat(",id,reactions").concat(",trending"),S="".concat(y,"&").concat("$expand=analytics($expand=allTime($expand=activities))").concat(",insights($expand=keyPoints)"),D="".concat(v,"?").concat(S),D),qosName:"".concat(d,"_GetAnalyticsSections"),endpoint:r,driveId:o,timeout:6e3,headers:t,driveUrl:Wa(Object(l.n)(i)),allowCookies:c}))];case 1:return s=b.sent(),f=Object(Va.t)(s),(p=f.createdBy)&&(m=P.e.serialize({email:p.email,endpoint:r}),e(Object(nt.e)({items:(_={},_[m]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(p.displayName)),L.e.pack(p.email)),L.a.pack(p.image)),L.i.pack(p.id)),_[n]=Object(a.__assign)({},A.a.pack({itemKey:m,displayValue:p.displayName})),_)}))),e(Object(nt.e)({items:(h={},h[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},A.f.pack(f.viewCount)),A.p.pack(f.viewerCount)),A.o.pack(f.isTrending)),A.e.pack(f.activities)),A.d.pack(f.likeCount)),A.t.pack(f.commentCount)),A.c.pack(f.lifeCycleStatus)),A.s.pack(f.keyPointsData)),A.r.pack(f.incompleteData)),A.i.pack(f.createdDateTime)),h)})),[2]}var g,v,y,S,D})}),m=[p],_=Object(a.__awaiter)(b,void 0,void 0,function(){var o,s,f,p;return Object(a.__generator)(this,function(m){switch(m.label){case 0:return[4,e(Object(u.n)({url:(_=Object(l.t)(i),h=Wa(_),"".concat(h).concat("?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities)),conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))")),qosName:"".concat(d,"_GetRecommendedActionsAndConversations"),endpoint:r,timeout:6e3,headers:t,driveUrl:Wa(Object(l.n)(i)),allowCookies:c}))];case 1:return o=m.sent(),s=function(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;return t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction)),n}(o),f=function(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),a={},i=[];return n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;a.hasOwnProperty(t)||(a[t]=!0,i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:za.e[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,sharedByUserEmail:e.sharedByUser.email,participants:e.participants}))}),i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})}(o),e(Object(nt.e)({items:(p={},p[n]=Object(a.__assign)(Object(a.__assign)({},A.l.pack(s)),A.n.pack(f)),p)})),[2]}var _,h})}),m.push(_),e(Object(nt.e)({items:(h={},h[n]=Object(a.__assign)({},A.u.pack([])),h)})),[2,Object(Ga.e)(m)]})})}});function Wa(e){return e.replace("2.0","2.1")}var qa=Object(i.t)(function(){return function(e){e(Object(nt.t)({keyFacet:Y.e,facets:[A.f]})),e(Object(s.a)(Y.e,at.e)(Ka))}}),Qa=n(3228),Ya=n(1757),Ja=n(270),Xa=Object(i.n)({maxParallelOperationCount:1,maxItemCountPerBatch:20,areSameBatch:function(e,t){var n=E.e.deserialize(e.itemKey).driveItemKey,a=n.endpoint,i=n.driveId,r=E.e.deserialize(t.itemKey).driveItemKey,o=r.endpoint,s=r.driveId;return!!i&&!!s&&i===s&&a===o}})(function e(t){var n=this,i=t.items;return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,o,s,c,d,f,m,_,h,b,v,y,S,D,I,x,C,A,L,k,M,P,T,U,F,H,R,N,B,j;return Object(a.__generator)(this,function(V){switch(V.label){case 0:if(n=Object.keys(i),r=n[0],o=E.e.deserialize(r),s=o.driveItemKey,c=s.endpoint,d=s.driveId,!c)throw new Error("No endpoint to determine activity items.");return f=n.map(function(e){return E.e.deserialize(e).driveItemKey.itemId}),m=Object(l.n)({endpoint:(z=c,z.replace("2.1","2.0")),driveId:d}),_="".concat(m,"/ExtendedActivitiesForItems"),h={driveItems:f,badgeOnly:!0},[4,t(Object(u.t)({url:_,method:"POST",body:h,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:c,driveId:d}))];case 1:if((b=V.sent()).value){for(v=function(e){for(var t={},n=0,a=e;n<a.length;n++){var i=a[n],r=i.driveItemId;r&&(t[r]||(t[r]=[])).push(i)}return t}(b.value),y=0,S=0,D=0,I=0,x=new g.e({publisher:e}),C=0,A=n;C<A.length;C++)L=A[C],y++,k=E.e.deserialize(L),M=k.driveItemKey.itemId,P=M&&v[M],T=O.e.serialize(k.driveItemKey),U=void 0,P&&(F=new Qa.e,H=F.processResponse({item:{name:M||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:_},response:{value:P,"@odata.nextLink":""}}).activities,R=Za(H),(N=$a(H))&&(D++,S++,R||(I++,B=ei(N,L).itemResolver,x.merge(B),U=N))),x.resolveItems({items:(j={},j[L]=Object(a.__assign)({},Ya.e.pack(U)),j[T]=Object(a.__assign)({},Object(p.e)().forFacet(w.e).thenInvalidate(L,Ya.e).pack()),j)});t(x.execute()),t(Object(Ja.e)({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:y,activityFieldEligibleItemCount:S,activityFieldActiveItemCount:D,activityFieldBadgedItemCount:I,activityFieldBadgedPercent:y?Math.round(I/y*100):0},isIntentional:!1}))}return[2]}var z})})}});function Za(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function $a(e){var t=e[0],n={};if(t)for(var i=0,r=t.actors;i<r.length;i++)(l=r[i]).id&&(n[l.id]=!0);for(var o=Object(a.__assign)(Object(a.__assign)({},t),{actors:Object(a.__spreadArray)([],t.actors||[],!0)}),s=1;s<e.length;s++)for(var c=0,d=e[s].actors;c<d.length;c++){var l;"string"!=typeof(l=d[c]).id||n[l.id]||(o.actors.push(l),n[l.id]=!0)}return o||t}function ei(e,t){var n=new g.e({publisher:ei}),i=E.e.deserialize(t).driveItemKey,r=function(e){var t=e.actors,n=e.action.mention&&e.action.mention.mentionees||[],i=e.action.share&&e.action.share.recipients||[],r=e.action.commentResponse&&e.action.commentResponse.commentAuthor,o=Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([],t,!0),n,!0),i,!0);return r&&o.push(r),o}(e);if(r.length>0){var o=ti(r,i).itemResolver;n.merge(o)}return{itemResolver:n}}function ti(e,t){for(var n=new g.e({publisher:ti}),a=0,i=e;a<i.length;a++){var r=ni(i[a],t).itemResolver;n.merge(r)}return{itemResolver:n}}function ni(e,t){var n=new g.e({publisher:ni}),a=U({itemKey:O.e.serialize(t),userKey:P.e.serialize({email:e.email||"",endpoint:t.endpoint}),user:{displayName:e.displayName,email:e.email}}).itemResolver;return n.merge(a),{itemResolver:n}}var ai=Object(i.t)(function(){return function(e){e(Object(s.a)(E.e,at.e)(Xa)),e(Object(s.a)(E.e,at.e)(Xa))}}),ii=n(4699),ri=Object(i.t)(function(){return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return e(wa),e(Pa),e(qa),e(o.e),e(r.e),e(qt),e(rt),e(vt),e(ja),e(ai),e(ii.graphSharesAddon),[2]})})}}),oi=n(945),si=n(92),ci=Object(i.t)(function(){return function(e){e(Object(dt.e)(O.e,oi.e)(e(Object(ga.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(si.c)())];case 1:return t.sent(),[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(14)]).then(n.bind(null,5170))];case 2:return[2,t.sent().driveItemActivityFieldControlHandler]}})})}))))}}),di=n(452),li=n(527),ui=n(887),fi=n(769),pi=n(83),mi=n(240),_i=n(699),hi=n(33),bi=n(208),gi=n(279),vi=n(195),yi=Object(pi.i)({key:new k.e("dateAccessedColumn").id,name:mi.e,fieldName:"",minWidth:pi.e.regularMin,maxWidth:pi.e.regularMax,isCollapsable:!0,data:{facets:Object(a.__assign)({},vi.e.pack("dateAccessed"))}},_i.e)(function(e,t){var n=e.demandItemFacet(w.o,t,{suppressGetItems:!0}),a=n&&new Date(n).getTime();if("number"!=typeof a||isNaN(a))return{text:""};var i=e.demandItemFacet(hi.w,bi.e),r=i&&i.language||window.navigator.language;return r?{text:Object(gi.n)(new Date(a),r)}:{dateValue:a}},function(e,t){return"".concat(e.demandItemFacet(w.o,t))}),Si=n(3236),Di=Object(a.__assign)(Object(a.__assign)({},Si.e),{columnActionsMode:ui.t.disabled}),Ii=Object(a.__assign)(Object(a.__assign)({},yi),{columnActionsMode:ui.t.disabled}),xi=ge.e.isActivated("E4DF8572-56CE-4708-A3CB-DB9720F1B163","09/19/2022","Disable column header action on Recent ItemSet since no action avaible")?[fi.t,Si.e,yi]:[fi.t,Di,Ii];function Ci(e,t){return{columns:xi}}var Oi=n(315),wi=n(360),Ei=n(238),Ai=n(677),Li=n(3270),ki=n(3651),Mi=[wi.e,ki.e,Ei.n,Ei.t,Ai.e];function Pi(e,t){var n=function(e,t){for(var n=[],a=0,i=t.defaultCommands;a<i.length;a++){var r=i[a];r.key===wi.e.key?n.push(Li.e):n.push(r)}return{overrideDefaultCommands:n}}(0,{defaultCommands:Mi}).overrideDefaultCommands;return{commands:n}}var Ti=n(4463),Ui=n(390);function Fi(e,t){return{isAvailable:!1}}var Hi=n(1379),Ri=n(1113);function Ni(e,t){var n=e.demandItemFacet(St.e,t.itemKey),i=!!e.demandItemFacet(j.s,t.itemKey)||(null==n?void 0:n.filters)&&Object(Me.e)({extFilters:Object(Me.t)(n.filters),allowedMediaTypes:[Ae.e.photo,Ae.e.video],fileTypeIconMap:Et.e});return Object(a.__assign)({},i?{defaultLayout:Ri.t.layoutType,isLayoutResolved:!0}:{layouts:[Hi.t,Hi.e]})}var Bi=n(1074),ji=n(3237),Vi=n(4465),zi=n(1321),Gi=n(1551),Ki=Object(pi.i)({key:Fe.t,name:mi.t,fieldName:"",minWidth:pi.e.regularMin,maxWidth:pi.e.regularMax,isCollapsable:!0,sortProps:pi.t,data:{facets:Object(a.__assign)({},vi.e.pack("dateTaken"))}},Gi.t)(function(e,t){return function(){return{itemKey:t}}},function(e,t){return"".concat(e.demandItemFacet(Z.c,t,{suppressGetItems:!0}))}),Wi=n(1152),qi=n(1350),Qi=n(607),Yi=n(4224),Ji=ge.e.isActivated("22B8A337-05E5-4246-A042-4589C0F3DF7A","11/30/2022","add location column"),Xi=Object(a.__assign)(Object(a.__assign)({},Yi.e),{name:Vi.e});Object(a.__spreadArray)(Object(a.__spreadArray)([fi.e,Qi.t,zi.e,qi.e],Ji?[]:[Xi],!0),[Wi.e],!1),Object(a.__spreadArray)(Object(a.__spreadArray)([fi.e,Qi.t,zi.e,Ki,qi.e],Ji?[]:[Xi],!0),[Wi.e],!1);var Zi=ge.e.isActivated("F0E9D1A9-2D93-4FEB-8870-CA6A2A2438B0","08/22/2022","Use the new item path field control handler for fetching paths for files or folders");function $i(e,t){var n,a,i=t.itemKey,r=e.demandItemFacet(w.k,i),o=e.demandItemFacet(w.L,i),s=e.demandItemFacet(w.A,null==r?void 0:r.itemKey);if(o&&!Zi){var c=Qe.format(Vi.n,o);if(r){var d=e.demandItemFacet(te.e,i);if(d)return{displayPathSegments:[c.concat(d)],openUrl:s}}return{displayPathSegments:[c],openUrl:s}}var l=Object(Cn.e)(e),u=e.demandItemFacet(Hn.e,l);if(!Ji&&u)if(Object(ea.o)(e,i)){if(r){var f=e.demandItemFacet(w.u,null==r?void 0:r.itemKey);if(f)return{displayPathSegments:[f],openUrl:"",action:void 0}}}else{var p=e.demandItemFacet(J.e,i),m=null===(a=null===(n=null==p?void 0:p.owner)||void 0===n?void 0:n.user)||void 0===a?void 0:a.displayName;if(m)return{displayPathSegments:[Qe.format(Vi.t,m)],openUrl:"",action:void 0}}return{}}var er=Object(i.t)(function(){return function(e){e(Object(dt.e)(O.e,ji.e)($i))}}),tr=Object(i.t)(function(){return function(e){e(qt),e(er),e(Object(dt.e)(St.e,Bi.e)(Ni)),e(Object(dt.e)(St.e,li.e)(Ni)),e(Object(dt.e)(St.e,di.e)(Ci)),e(Object(dt.e)(wt.e,Oi.e)(Pi)),e(Object(dt.e)(wt.e,Ui.e)(Ti.recentContextMenuControlHandler)),e(Object(dt.e)(Lt,Mn.e)(Fi))}}),nr=n(2109),ar=n(458),ir=n(1330),rr=n(4127),or=n(4042),sr=n(3310),cr=!ge.t.isActivated("A62AD86A-B7EB-4EF6-A7F2-CC139D544AE7","","");function dr(e,t){return{commands:Object(a.__spreadArray)(Object(a.__spreadArray)([sr.e?wi.e:Li.e,Ei.n,Ei.t,ir.e],cr?[ar.e]:[],!0),[or.e,rr.e,Ai.e],!1)}}var lr,ur=n(328),fr=((lr={})[Fe.a]=!0,lr[Fe.n]=!0,lr[Fe.s]=!0,lr[pe.c]=!0,lr[pe.e]=!0,lr[pe.o]=!0,lr);function pr(e,t){return{isAvailable:!0,sortHandler:function(e,t){var n=t.itemSetKey,i=t.handler,r=i.columnKey,o=i.isAscending;if(!fr[r])return{};var s=e.demandItemFacet(d.e,n);if(!s)return{};var c=pe.a[r];if(!c)return{};var l=s.driveItemKey.endpoint,f=s.sortBy;return Object(u.a)(e,l)&&!f&&r===Fe.n&&o?{newItemSetKey:n}:{newItemSetKey:d.e.serialize(Object(a.__assign)(Object(a.__assign)({},s),{sortBy:c,isAscending:o}))}}}}var mr,_r=n(638);function hr(e,t){var n=t.itemKey,i=e.demandItemFacet(d.e,n),r=i&&i.driveItemKey.endpoint,o=r&&i&&kn(0,{itemSetKey:d.e.serialize(i),parentItemKey:Ee.e.serialize({endpoint:r}),stageItem:t.stageItem});return Object(a.__assign)({},o?{stageItem:o}:{})}var br=((mr={})[pe.c]=!0,mr[pe.e]=!0,mr);function gr(e,t){var n=t.itemSetKey,i=t.handler.columnKey;if(!br[i])return{};var r=e.demandItemFacet(d.e,n);if(!r)return{};var o=pe.a[i];return o?{newItemSetKey:d.e.serialize(Object(a.__assign)(Object(a.__assign)({},r),{groupBy:o}))}:{}}function vr(e,t){var n=t.itemSetKey,i=e.demandItemFacet(d.e,n);return i?{newItemSetKey:d.e.serialize(Object(a.__assign)(Object(a.__assign)({},i),{groupBy:void 0}))}:{}}var yr=n(1687),Sr=ge.t.isActivated("d4cb8ed6-56a5-4c23-8c49-2f352054edd9","12/15/2021","Use cultureName instead of cultureUIName to display the date"),Dr=Object(pi.i)({name:yr.t,key:pe.e,fieldName:"",minWidth:pi.e.regularMin,maxWidth:pi.e.regularMax,isCollapsable:!0,sortProps:pi.t},_i.e)(function(e,t){var n=e.demandItemFacet(J.e,t),a=n&&new Date(n.sharedDateTime).getTime();if("number"!=typeof a||isNaN(a))return{text:""};var i=e.demandItemFacet(hi.w,bi.e),r=!Sr&&(null==i?void 0:i.cultureLCID)||(null==i?void 0:i.language)||window.navigator.language;return r?{text:Object(gi.n)(new Date(a),r)}:{dateValue:a}}),Ir=n(932),xr=new _.e("topCollaboratorSetKeyFacet",{endpoint:h.e}),Cr=n(2032),Or=n(514),wr=n(1991),Er=n(4826);Object(sa.n)([{rawString:".topCollaPlaceHolder_f0c2bf25{display:flex;min-width:13px;height:21px}[dir=ltr] .topCollaPlaceHolder_f0c2bf25{padding-right:10px}[dir=rtl] .topCollaPlaceHolder_f0c2bf25{padding-left:10px}.topCollaboratorIcon_f0c2bf25{color:#0078d4;font-size:13px;line-height:21px;text-align:center}.topCollaboratorUserName_f0c2bf25{font-weight:700}.topCollaboratorTooltip_f0c2bf25{padding:0 2px}.userWithTopCollaborator_f0c2bf25{display:flex}.userWithTopCollaborator_f0c2bf25 .topCollaPlaceHolder_f0c2bf25{min-width:13px}[dir=ltr] .userWithTopCollaborator_f0c2bf25 .topCollaPlaceHolder_f0c2bf25{padding-right:7px}[dir=rtl] .userWithTopCollaborator_f0c2bf25 .topCollaPlaceHolder_f0c2bf25{padding-left:7px}[dir=ltr] .columnHeader_f0c2bf25{margin-left:20px}[dir=rtl] .columnHeader_f0c2bf25{margin-right:20px}"}]);var Ar=function(e){function t(t){return e.call(this,t)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,a=ia.createElement(Or.e,{className:"topCollaboratorIcon_f0c2bf25",iconName:"TeamFavorite"}),i=ia.createElement("span",{className:"topCollaboratorUserName_f0c2bf25"},t),r=ia.createElement("div",{className:"topCollaboratorTooltip_f0c2bf25"},Qe.formatToArray(Er.e,i));return ia.createElement("div",{className:"topCollaPlaceHolder_f0c2bf25"},n?null:t?ia.createElement(wr.e,{content:r},a):a)},t}(Cr.e),Lr=Object(pi.i)({name:yr.n,key:pe.c,fieldName:"",minWidth:pi.e.regularMin,maxWidth:pi.e.regularMax,isCollapsable:!0,sortProps:pi.a,headerClassName:"columnHeader_f0c2bf25"},Ir.e)(function(e,t){var n,a=e.demandItem({shareByPerson:M},t).shareByPerson,i=e.demandItem({sharedBy:J.e},t).sharedBy,r=null==a?void 0:a.itemKey,o=i&&(null!==(n=i.sharedBy)&&void 0!==n?n:i.owner),s=(null==a?void 0:a.displayValue)||o&&o.user&&o.user.displayName,c=!1;if(r&&P.e.matches(r)){var d=P.e.deserialize(r).email,l=e.demandItemFacet(m.e,xr.serialize({endpoint:"https://graph.microsoft.com/beta"}));l&&(c=l.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(L.e,t);return!!n&&n===d}))}return r||s?{people:[{itemKey:r||"",displayValue:s}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),a=e.user;return ia.createElement("div",{className:"userWithTopCollaborator_f0c2bf25"},ia.createElement(Ar,{userName:a.title,isPlaceholder:!c}),n)}}:{people:[]}},function(e,t){return"".concat(e.demandItemFacet(L.e,t))}),kr=!ge.e.isActivated("261491DC-B6D7-4FB8-85F3-EBAA7EA472B0","05/31/2022",'Enables the "Shared Date" column in ODC Shared with me');function Mr(e,t){var n=t.itemSetKey,i=!1,r=e.demandItemFacet(d.e,n);if(r){var o=r.driveItemKey.endpoint;i=Object(u.a)(e,o)}return{columns:Object(a.__spreadArray)(Object(a.__spreadArray)([],i?Object(a.__spreadArray)([fi.e,Qi.t],kr?[Dr]:[],!0):[fi.t,Si.e,Dr],!0),[Lr],!1)}}var Pr=new _.e("topCollaboratorItemKeyFacet",{id:h.e}),Tr=Object(i.i)()(function e(t){var n=this,i=t.itemKey;return function(r){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,o,s,c,d,l,p,_,h,b,v,y,D,I,x,C;return Object(a.__generator)(this,function(O){switch(O.label){case 0:return n=new g.e({publisher:e}),o=r(Object(f.e)({graphEndpoint:S.y})).graphEndpoint,s=xr.deserialize(i),c=o||s.endpoint,d="".concat(c,"/me/people/"),[4,r(Object(u.t)({url:d,qosName:"getTopCollaborator",endpoint:c}))];case 1:for(l=O.sent(),p=[],_=0,h=l.value;_<h.length;_++)b=h[_],v=b.id,y=b.displayName,D=b.userPrincipalName,I=Pr.serialize({id:v}),r(Object(nt.e)({items:(x={},x[I]=Object(a.__assign)(Object(a.__assign)({},w.u.pack(y)),L.e.pack(D)),x)})),p.push(I);return n.resolveItems({items:(C={},C[t.itemKey]=Object(a.__assign)({},m.e.pack({itemKeys:p})),C)}),r(n.execute()),[2]}})})}});function Ur(e,t){return{isAvailable:!1}}function Fr(e,t){return{isAvailable:!1}}var Hr=Object(i.t)(function(){return function(e){e(rt),e(Object(dt.e)(Ee.e,Oi.e)(dr)),e(Object(dt.e)(Ee.e,Ui.e)(nr.sharedWithMeContextMenuControlHandler)),e(Object(dt.e)(d.e,ur.t)(pr)),e(Object(dt.e)(d.e,Mn.e)(hr)),e(Object(dt.e)(d.e,_r.e)(gr)),e(Object(dt.e)(d.e,_r.t)(vr)),e(Object(dt.e)(d.e,di.e)(Mr)),e(Object(dt.e)(ze,Mn.e)(Ur)),e(Object(dt.e)(Ke,Mn.e)(Fr)),e(Object(s.a)(xr,at.e)(Tr))}}),Rr=n(1748),Nr=n(789),Br=n(1335);function jr(e,t){var n=t.setItemKey,a=e.demandItemFacet(G.e,n);if(!n||!a)return{};var i=a.driveItemKey.endpoint,r=O.e.serialize(a.driveItemKey),o=e.demandItemFacet($.e,r),s=e.demandItemFacet(S.r,bi.e)||F.t,c=e.demandItemFacet(S.H,bi.e);return c&&c(i,o)?{totalItemCount:e.demandItemFacet(j.e,r),getPageKey:function(e,t){return Tn.serialize({setItemKey:n,endpoint:a.driveItemKey.endpoint,skip:e,top:t-e})},pageSize:s}:{}}var Vr=n(1316),zr=ge.t.isActivated("637A4DC9-1258-4BD2-8166-5F852E5FEBBE","11/09/2021","The switch to add modifiedBy column in default column set."),Gr=ge.t.isActivated("52A76194-DB1E-4300-A64E-FB69963A684C","10/13/2022","Disable column header action since no action avaible"),Kr=Object(a.__assign)(Object(a.__assign)({},qi.e),{columnActionsMode:ui.t.disabled}),Wr=Gr?qi.e:Kr,qr=[fi.e,Qi.e,zi.e,Wi.e,Wr],Qr=[fi.e,Qi.e,zi.e,Vr.e,Wi.e,Wr],Yr=[fi.e,Qi.e,zi.e,Ki,Wi.e,qi.e];function Jr(e,t){var n,a=t.itemSetKey;if(a){var i=Object(zn.e)(e,{itemKey:a}),r=e.demandItemFacet(W.e,i);if("photo"===(null===(n=null==r?void 0:r.folder)||void 0===n?void 0:n.folderType))return{columns:Yr}}return!zr&&e.demandItemFacet(S.a,bi.e)?{columns:qr}:{columns:Qr}}var Xr=n(28);function Zr(e,t){return n=G.e,{isAvailable:!0,sortHandler:function(e,t){var i=t.itemSetKey,r=t.handler,o=r.columnKey,s=r.isAscending,c=e.demandItemFacet(n,i);if(!c)return{};var d=O.e.serialize(Object(a.__assign)({},c.driveItemKey)),l=e.demandItemFacet($.e,d);if(!l||"business"===l||"documentLibrary"===l)return{};var u=Object(Xr.e)(e,{customColumnKeysToFieldNamesConfiguration:S.n,isUnauthenticated:Ve.e}),f=u.customColumnKeysToFieldNamesConfiguration,p=u.isUnauthenticated,_=void 0!==p&&p;if(!c.sortBy){var h=e.demandItemFacet(m.s,d);if(un.e&&h&&!_){if(o===(null==h?void 0:h.columnKey)&&(null==h?void 0:h.isAscending)===s)return{newItemSetKey:i}}else if(o===Qi.e.key&&!0===s)return{newItemSetKey:i}}var b=Object(a.__assign)(Object(a.__assign)({},pe.a),f),g=b?b[o]:void 0;return g?{newItemSetKey:n.serialize(Object(a.__assign)(Object(a.__assign)({},c),{sortBy:g,isAscending:s}))}:{}}};var n}var $r=n(692);function eo(e,t){var n=Object(na.e)(e),a=e.demandItemFacet(wt.e,n),i=e.demandItemFacet(Ee.e,n),r=e.demandItemFacet(ot,n);return t.isMove?{isAvailable:!a&&!i&&!r}:{isAvailable:!a}}var to=n(1826);function no(e,t){var n=t.itemKey;return e.demandItemFacet(q.e,n,{suppressGetItems:!0})?{renameDialogAs:ao}:{}}function ao(e){var t=e.defaultRender,n=Object(a.__rest)(e,["defaultRender"]);return t?ia.createElement(t,Object(a.__assign)({},n),function(e){return ia.createElement(to.e,Object(a.__assign)({},e))}):null}var io=n(682),ro=n(1746),oo=n(22),so=n(613),co=n(3400),lo={key:new k.e("openInOfficeOnlineDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,a=e.demandItem({openUrl:w.A,appMap:ne.e},n),i=a.openUrl,r=a.appMap;return{action:i&&r?ia.createElement(so.e,{itemKey:n,action:Object(oo.i)(e,ia.createElement(co.e,{itemKey:n}))}):void 0}}},uo=n(3511),fo={key:new k.e("openInOfficeClientDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,a=e.demandItem({openUrl:w.A,appMap:ne.e},n),i=a.openUrl,r=a.appMap;return{action:i&&r?ia.createElement(so.e,{itemKey:n,action:Object(oo.i)(e,ia.createElement(uo.e,{itemKey:n}))}):void 0}}};function po(e,t){var n=t.handlers,i=void 0===n?[]:n,r=t.itemKey;return{isAvailable:!e.demandItemFacet(w.d,r),handlers:Object(a.__spreadArray)([ro.e,lo,fo],i,!0)}}var mo=n(837),_o=n(1827),ho=n(831),bo=n(205),go=n(253),vo=n(1010),yo=n(2234),So=Object(On.t)(function(e){e.itemsScopeItemKey;var t=e.localStorageKey,n=Object(a.__rest)(e,["itemsScopeItemKey","localStorageKey"]);return function(e){var i,r=e(Object(B.e)(function(e){return Object(yo.e)(e,{name:t})}))||{},o=r&&function(e,t){var n=t.queryType,i=t.layoutType,r=i&&function(e){return e===bo.e?vo.e:e===go.e?vo.n:vo.t}(i),o=function(e,t){return n=e,Object(a.__assign)(((i={version:2})[0]="",i[1]="",i[3]="",i[6]="",i[16]="",i),n);var n,i}(e);return"number"==typeof n&&r&&(o[n]=r),o}(r,Object(a.__assign)({},n));e(Object(yo.n)({values:(i={},i[t]=o,i)}))}}),Do=new k.e("defaultLayoutTypeMapConfiguration"),Io=new _.e("itemsScopeList",{driveId:h.e,itemsScopeItemKey:h.e});function xo(e,t){var n=Object(Xr.e)(e,{isLayoutResolvedEnabled:hi.C,isLocalStorageForLayoutEnabled:S.A,defaultLayoutTypeMapConfiguration:Do}),i=n.isLayoutResolvedEnabled,r=n.isLocalStorageForLayoutEnabled,o=n.defaultLayoutTypeMapConfiguration;if(!i||!r)return{};var s,c,d,l,u=t.itemsScopeItemKey,f=Object(Cn.e)(e),p=e.demandItemFacet(G.e,f),m=void 0;if(f&&p&&u){var _=p.driveItemKey;if(_){var h=_.endpoint,b=_.driveId;if(!b||!h)return{};var g,v,y=Io.serialize({driveId:b,itemsScopeItemKey:u}),D=e.demandItemFacet(S.S,bi.e),I=D&&D(e,{itemSetKey:f}),x=I&&I.queryType||0;g="ItemsStore".concat((s={endpoint:h,driveId:b,queryType:x},c=s.endpoint,d=s.driveId,l="Graph.Files.FilesQueryType.".concat(c),d?"".concat(l,".").concat(d):l).toLocaleLowerCase());var C=Object(yo.e)(e,{name:g});m=Object(yo.t)(e,{name:g});var O=C&&C[x]||"";v=!O&&m&&o&&o[x]?o[x]:m?function(e){switch(e){case vo.t:return bo.t;case vo.e:return bo.e;default:return go.e}}(O):void 0;var w=e.demandItemFacet(Ye.c,y);return{preferredLayoutType:e.demandItemFacet(Ye.s,y)||v,preferredLayoutVersion:w,setPreferredLayout:function(e){var t=e.layoutType;return function(n){var i,r;g&&b&&h&&n(So({endpoint:h,driveId:b,itemsScopeItemKey:u,queryType:x,localStorageKey:g,layoutType:t})),n(Object(nt.e)({items:(i={},i[y]=Object(a.__assign)({},Ye.s.pack(e.layoutType)),i)})),n(Object(nt.e)({items:(r={},r[y]=Object(a.__assign)({},Ye.c.pack((w||0)+1)),r)}))}}}}}return{}}var Co=n(1358),Oo=n(2233),wo=new k.e("itemRestrictedSignal").id;function Eo(e,t){var n=t.itemKey;if(e.demandItemFacet(me.e,n)&&n){var i=Object(a.__spreadArray)([],t.signals||[],!0);return i.push(Ao),{signals:i}}return{}}var Ao={signal:ia.createElement(Oo.t,null),title:X.e,key:wo},Lo=n(622),ko=n(463),Mo=n(783),Po=n(216),To=n(25);Object(sa.n)([{rawString:".root_f578385e{display:inline-flex;position:relative;vertical-align:bottom;flex-direction:row;align-items:flex-end}.vaultCoverIsSmall_f578385e{width:72px;height:52px}.vaultCoverIsLarge_f578385e{width:112px;height:80px}.cover_f578385e{display:block;position:absolute;padding-bottom:12px;left:-3px;right:-3px;bottom:-4px}"}]);var Uo,Fo=n(277),Ho=Object(Fo.e)("/"),Ro="".concat(Ho,"office-ui-fabric-react-assets/foldericons"),No="".concat(Ho,"/assets/item-types/");!function(e){e.vaultOpen="vaultopen",e.vaultClosed="vaultclosed"}(Uo||(Uo={}));var Bo,jo,Vo={small:{vaultclosed:"vaultCoverSmallVaultClosed",vaultopen:"vaultCoverSmallVaultOpen"},large:{vaultclosed:"VaultCoverLargeVaultClosed",vaultopen:"VaultCoverLargeVaultOpen"}},zo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.vaultCoverSize,i=void 0===n?"large":n,r=t.vaultCoverType,o=void 0===r?"vaultclosed":r,s=(t.ref,t.children,t.isFluent),c=Object(a.__rest)(t,["vaultCoverSize","vaultCoverType","ref","children","isFluent"]),d=Vo[i][o];return"small"===i?e="vaultCoverIsSmall_f578385e":"large"===i&&(e="vaultCoverIsLarge_f578385e"),ia.createElement("div",Object(a.__assign)({},c,{className:"".concat("root_f578385e"," ").concat(e," ").concat(s?"isFluent":""),role:"none"}),ia.createElement(Or.e,{"aria-hidden":!0,className:"ms-VaultCover ".concat("cover_f578385e"),iconName:d,role:"none"}))},t}(ia.Component);function Go(e,t){var n=t.itemKey,i=e.demandItemFacet(ee.e,n),r=e.demandItemFacet(Q.e,n,{suppressGetItems:!0})||e.demandItemFacet(q.e,n,{suppressGetItems:!0});return Object(a.__assign)(Object(a.__assign)({},i&&i.root?{tileAs:Wo}:{}),{folderCoverControlHandler:function(t,n){var i={};r&&(i={folderCoverAs:qo});var o=n.signalData;if(o&&o.signal)return i;var s=e.demandItem({specialFolder:re.e},n.itemKey).specialFolder;if(!s)return i;var c=function(e){var t=null;return"desktop"===e?t=ia.createElement(Oo.n,null):"documents"===e?t=ia.createElement(Oo.a,null):"pictures"===e&&(t=ia.createElement(Oo.l,null)),{signal:t,key:e||""}}(s);return c&&c.signal?Object(a.__assign)(Object(a.__assign)({},i),{signalData:c}):i}})}jo={disableWarnings:!0},void 0===(Bo=ge.e.isActivated("C242A965-ED0B-4653-9CCD-6FA000E87895","11/03/2022","Use getFabricAssetCdnUrl to get the CDN url instead of hardcoding it")?"https://res-1.cdn.office.net/files/fabric-cdn-prod_20211207.001/office-ui-fabric-react-assets/foldericons":Object(Fo.e)("/office-ui-fabric-react-assets/foldericons"))&&(Bo=Ro),Object(To.B)({fontFace:{},style:{width:78,height:58,overflow:"hidden"},icons:{vaultCoverSmallVaultClosed:ia.createElement("img",{src:"".concat(Bo,"/vault-sm.svg")}),vaultCoverSmallVaultOpen:ia.createElement("img",{src:"".concat(Bo,"/vault-sm-open.svg")})}},jo),Object(To.B)({fontFace:{},style:{width:118,height:86,overflow:"hidden"},icons:{VaultCoverLargeVaultClosed:ia.createElement("img",{src:"".concat(Bo,"/vault-lg.svg")}),VaultCoverLargeVaultOpen:ia.createElement("img",{src:"".concat(Bo,"/vault-lg-open.svg")})}},jo);var Ko=Object(ra.t)(function(e,t){var n=t.itemKey,i=Object(a.__rest)(t,["itemKey"]),r=e.demandItemFacet(ee.e,n),o=r&&r.isLocked?Uo.vaultClosed:Uo.vaultOpen;return ia.createElement(zo,Object(a.__assign)({},i,{vaultCoverSize:i.folderCoverSize,vaultCoverType:o}))}),Wo=Object(ra.t)(function(e,t){var n=t.defaultRender,i=t.foreground,r=Object(a.__rest)(t,["defaultRender","foreground"]),o=t.itemKey,s=i,c=e.demandItemFacet(ee.e,o);return c&&c.root&&(s=Object(Po.a)(e,ia.createElement(Ko,Object(a.__assign)({},r,{folderCoverSize:r.tileSize,itemKey:o})))),n?ia.createElement(n,Object(a.__assign)({},r,{foreground:s})):null});function qo(e){var t=e.defaultRender,n=Object(a.__rest)(e,["defaultRender"]);return t?ia.createElement(t,Object(a.__assign)({},n,{folderCoverType:"linked"})):null}var Qo=n(1007),Yo=n(181),Jo=n(354);Object(sa.n)([{rawString:".fileHandlerFileTypeIcon_86ad4959{width:inherit;height:inherit}"}]);var Xo=!ge.e.isActivated("C8C7CD90-A7D5-45A9-9BBC-9041BF1AD06F","07/19/2022","Prevent Shared Folder icon from appearing at SWM/SBY roots");function Zo(e,t){var n=t.itemKey,a=e.demandItemFacet(ee.e,n);return a&&a.root?{iconAs:$o}:{fileTypeIconAs:es}}var $o=Object(ra.t)(function(e,t){var n,i=t.itemKey,r=Object(a.__rest)(t,["itemKey"]),o=e.demandItemFacet(ee.e,i);if(o&&o.root){var s=e.demandItemFacet(w.u,i),c=o.isLocked?Uo.vaultClosed:Uo.vaultOpen,d={iconType:Qo.e.Image,ariaLabel:s,imageProps:{src:(n=c,"".concat(No).concat("20").concat("","/").concat(n,".").concat("png")),imageFit:Yo.t.contain,className:"fileHandlerFileTypeIcon_86ad4959",role:"none"}};return ia.createElement(Or.e,Object(a.__assign)({},r,d))}return null}),es=Object(ra.t)(function(e,t){var n=t.defaultRender,i=Object(a.__rest)(t,["defaultRender"]),r=i.isFolder,o=i.itemKey,s=i.type,c=s;if(r&&void 0===s){var d=e.demandItemFacet(re.e,o);void 0!==d&&("desktop"===d?c=Jo.e.desktopFolder:"documents"===d?c=Jo.e.documentsFolder:"pictures"===d&&(c=Jo.e.picturesFolder))}else if(Xo&&r&&s===Jo.e.sharedFolder){var l=Object(na.e)(e),u=e.demandItemFacet(Ee.e,l),f=e.demandItemFacet(ot,l);(u||f)&&(c=Jo.e.folder)}return n?ia.createElement(n,Object(a.__assign)({},i,{type:c})):null}),ts=n(1585),ns=n(1744),as=n(690),is=n(107),rs=n(3663),os=new k.e("enableSyncConfigurationFacet"),ss=new is.e;function cs(e,t){var n=function(e,t){var n=t.itemKey,a=t.platformDetection;if(!a.isWindows)return{syncState:"noSyncNotAllowedInExperience"};if(a.isMobile)return{syncState:"noSyncMobileDevice"};var i=e.demandItemFacet(O.e,n);return i?e.demandItemFacet(L.e,rs.e.serialize(i))?{syncState:"syncNextGen"}:{syncState:"noSyncNotAllowedInExperience"}:{syncState:"noSyncItemIsNotLoaded"}}(e,{itemKey:t.itemKey,platformDetection:ss}).syncState;if("syncNextGen"!==n)return{syncState:n};var a=Object(Xr.e)(e,{enableSync:os}).enableSync;return{isAvailable:!!a&&a(),syncState:n,protocolCallback:function(e){window.location.href=e}}}var ds=n(1645),ls=Object(i.t)(function(){return function(e){e(Object(dt.e)(O.e,as.e)(cs)),e(Object(dt.e)(O.e,ds.e)(e(Object(ga.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(15).then(n.bind(null,5474))];case 1:return[2,e.sent().driveItemSyncDialogControlHandler]}})})}))))}}),us=n(572),fs=n(158),ps=Object(fs.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(538).then(n.bind(null,5625))];case 1:return[2,e.sent().EmptyFolderTitle]}})})});function ms(e,t){var n=t.itemKey,a=t.emptyFolderTitle,i=(e.demandItemFacet(G.e,n)||{}).driveItemKey,r=i&&O.e.serialize(i),o=e.demandItemFacet(re.e,r);return o&&"documents"===o?{emptyFolderTitle:Object(Po.a)(e,ia.createElement(ps,{titleFallback:a}))}:{}}var _s=Object(i.t)(function(){return function(e){e(wa),e(Object(dt.e)(G.e,di.e)(Jr)),e(Object(dt.e)(G.e,Co.e)(e(Object(ga.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(13).then(n.bind(null,5316))];case 1:return[2,e.sent().driveItemSortActionControlHandler]}})})})))),e(Object(dt.e)(G.e,ur.t)(Zr)),e(Object(dt.e)(O.e,Lo.e)(Eo)),e(Object(dt.e)(O.e,Nr.e)(Rr.e)),e(Object(dt.e)(G.e,Br.e)(jr)),ns.e||e(Object(dt.e)(O.e,ts.e)(no)),e(Object(dt.e)(O.e,$r.e)(eo)),e(Object(dt.e)(O.e,ko.e)(Zo)),e(Object(dt.e)(O.e,Mo.e)(Go)),e(Object(dt.e)(O.e,io.e)(po)),e(Object(dt.e)(O.e,mo.e)(_o.e)),e(Object(dt.e)(G.e,ho.e)(xo)),e(ls),e(Object(dt.e)(G.e,us.e)(ms))}}),hs=new _.e("specialDriveItem",{endpoint:h.e,driveId:h.t,name:h.e}),bs=n(349),gs=Object(i.i)()(function e(t){var n=this,i=t.itemKey,r=hs.deserialize(i),o=r.driveId,s=r.endpoint,c=Object(l.n)(r);return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,d,f,p,_,h,b,v,y;return Object(a.__generator)(this,function(S){switch(S.label){case 0:return[4,t(Object(u.t)({url:Object(l.i)(r),driveUrl:c,driveId:o,qosName:"getItem",endpoint:s}))];case 1:return n=S.sent(),d=new g.e({publisher:e}),f=n&&n.parentReference,p=f&&f.driveId,_={endpoint:s,driveId:p||o,itemId:n.id},h=O.e.serialize(_),b=f&&f.id?O.e.serialize({endpoint:s,driveId:p,itemId:f.id}):void 0,d.merge(t(Object(C.e)({itemKey:h,driveItem:n,endpoint:s,parentFolderItemKey:b})).itemResolver),d.resolveItems({items:(v={},v[h]=Object(a.__assign)(Object(a.__assign)({},bs.n.pack(O.e)),m.t.pack({itemKey:G.e.serialize({driveItemKey:_,sortBy:"",isAscending:!0})})),v)}),d.mapKeys({mappings:(y={},y[h]=i,y)}),t(d.execute()),[2]}})})}});function vs(e,t){var n=t.itemsScopeItemKey,i=t.engagement,r=t.itemKey,o=i&&i.name,s=e.demandItemFacet(hs,r);return{engagement:Object(a.__assign)(Object(a.__assign)({},(null==i?void 0:i.datasource)?{}:{datasource:"Graph"}),{objectType:"Folder",extraData:Object(a.__assign)({itemGraphId:null==s?void 0:s.driveId,specialGraphName:null==s?void 0:s.name},"ItemsView.Load"===o?Object(ft.e)(e,{itemsScopeItemKey:n}):{})})}}var ys=Object(i.t)(function(){return function(e){e(Object(dt.e)(hs,lt.e)(vs))}}),Ss=Object(i.t)(function(){return function(e){e(Object(s.a)(hs,at.e)(gs)),e(ys)}}),Ds=Object(i.t)(function(){return function(e){e(Ss),e(Object(dt.e)(hs,ko.e)(Zo)),e(Object(dt.e)(hs,Mo.e)(Go))}}),Is=n(3565),xs=n(902),Cs=n(3661),Os=Object(i.i)()(function e(t){var n=this,i=t.itemKey,r=Is.e.deserialize(i),o=r.endpoint,s=r.driveId;return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,c,d,u;return Object(a.__generator)(this,function(f){switch(f.label){case 0:return n=Object(l.n)({endpoint:o,driveId:s}),[4,t(Object(xs.getSessionToken)({endpoint:o,driveUrl:n}))];case 1:return r=f.sent(),c=r&&r.accessToken,(d=new g.e({publisher:e})).resolveItems({items:(u={},u[i]=Object(a.__assign)({},Cs.e.pack(c)),u)}),t(d.execute()),[2]}})})}}),ws=n(3794),Es=n(4041),As=Object(i.t)(function(){return function(e){e(Object(s.a)(Is.e,at.e)(Os)),Object(Es.e)()||e(Object(s.a)(ws.e,at.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(22).then(n.bind(null,5317))];case 1:return[2,e.sent().itemThumbnailGetItemsOperationHandler]}})})})))}}),Ls=n(693),ks=n(213),Ms=!ge.e.isActivated("6E019929-F335-47E2-9308-911B40E188A3","06/13/2022","Disable picker move/copy command for vault"),Ps=ks.n.isFeatureEnabled({ODC:"UseItemsScopeVroomMoveCopy"});function Ts(e,t){var n=e.demandItemFacet(R.e,bi.e);if((null==n?void 0:n.isUserMigrated)&&!Ps)return{isAvailable:!1};for(var a=0,i=t.sourceItemKeys;a<i.length;a++){var r=i[a],o=e.demandItemFacet(O.e,r);if(!o)return{};var s=o.itemId;if((void 0===s?F.a:s)===F.a)return{};if(Ms){var c=e.demandItemFacet(ee.e,r);if(null==c?void 0:c.root)return{isAvailable:!1}}if(t.isMove&&!e.demandItemFacet(ea.t,r))return{};if(e.demandItemFacet(q.e,r))return{}}var d=Object(na.e)(e),l=e.demandItemFacet(wt.e,d),u=e.demandItemFacet(Ee.e,d),f=e.demandItemFacet(ot,d);return t.isMove?{isAvailable:!l&&!u&&!f}:{isAvailable:!l}}var Us=n(4230),Fs=Object(i.t)(function(){return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return e(Object(dt.e)(O.e,Us.e)(e(Object(ga.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(28).then(n.bind(null,5481))];case 1:return[2,e.sent().driveItemMoveCopyProgressControlHandler]}})})})))),[2]})})}}),Hs=Object(i.t)(function(){return function(e){e(Fs),e(Object(dt.e)(O.e,Ls.e)(Ts))}}),Rs=Object(i.t)(function(){return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return e(ri),e(_s),e(As),e(ci),e(tr),e(Hr),e(Ds),e(Hs),[2]})})}})}}]);