(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[111],{2354:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.notConfigured=0]="notConfigured",e[e.visible=1]="visible",e[e.notVisible=2]="notVisible"}(a||(a={}))},2408:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(9),i=n(1027),r=n(2354),o=new a.t({name:"".concat("FirstRunExperienceStatus.key",".FirstRunExperienceStatus"),factory:{dependencies:{},create:function(e){return{instance:new i.e(r.e.notConfigured)}}}})},2606:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Owner:0,View:1,Edit:2,Submitter:3,CoOwner:4,None:5,Review:6,Custom:7}},2866:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n(0),i=n(35),r=n(2265),o=n(125),s=n(171),c=n(95),d=n(121),l=n(446),u=n(2408),f=n(2354),p=n(202),m="CoachmarkTearDropSeen",_={campaignGuid:"00000000-0000-0000-0000-000000000000",endDate:new Date(1970,1,1),flag:i.Off,isCoachmark:!0},h=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._dataStore=new s.e("CoachmarkProvider",c.e.session),a._currentCampaign=a.createObservable(_),a._isVisible=a.createObservable(!1),a._navigation=n.navigation,a._firstRunExperienceStatus=n.firstRunExperienceStatus,a._currentTeachingBubble=a.createObservable({campaign:a._currentCampaign,isVisible:a._isVisible}),a._navigation.viewParams.resetAllBubbles&&a._dataStore.remove(m);var i=a.resources.consume(p.e);return a._teachingBubbleProviderPromise=i.waitForPLT().then(function(){return a.resources.consume(l.I)}),a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentCampaign",{get:function(){return this._currentCampaign},enumerable:!1,configurable:!0}),t.prototype.hideCampaign=function(){this._isVisible(!1),this._currentCampaign(_)},t.prototype.setCampaign=function(e){var t=this;if(!e)return this._currentCampaign(_),void this._isVisible(!1);if(this._firstRunExperienceStatus.get()!==f.e.visible){var n="".concat(e.name).concat(m);this._dataStore.getValue(m)||this._teachingBubbleProviderPromise.then(function(a){a&&a.shouldBubbleBeAdded(e,!1).then(function(a){a&&(t._currentCampaign(e),t._isVisible(!0),t._dataStore.setValue(n,!0))})})}},t.prototype.getCurrentTeachingBubble=function(){return this._currentTeachingBubble},t.dependencies=Object(a.__assign)(Object(a.__assign)({},r.n.dependencies),{navigation:d.e,firstRunExperienceStatus:u.e}),t}(r.n),b=Object(o.r)("CoachmarkProvider",h)},3019:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"n",function(){return l});var a=n(0),i=n(41),r={};function o(e){return r[e]}function s(e,t){r[e]=t}function c(e){var t=o(e);if(t&&(t.end({resultType:i.t.Failure}),t=void 0),!t){var n={name:e};s(e,t=new i.e(n))}return t}function d(e){u(e,i.t.Success)}function l(e,t){u(e,i.t.Failure,t)}function u(e,t,n){var i=o(e);if(i){var r={resultType:t};n&&(r=Object(a.__assign)(Object(a.__assign)({},r),{resultCode:n.name||"Unknown",error:n.message||"Unknown",extraData:{errorStackTrace:n.stack}})),i.end(r),s(e,void 0)}}},3050:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"n",function(){return o});var a=function(e,t,n,a){return i(e,t,n)+(a+"\r\n")},i=function(e,t,n){var a="--"+e+"\r\n";return(a+="Content-ID: "+t+"\r\n")+"Content-Type: "+n+"\r\n\r\n"},r=function(e,t,n){var a="--"+e+"\r\n";return(a+="Content-Type: "+t+"\r\n")+"Content-Transfer-Encoding: "+n+"\r\n\r\n"},o=function(e,t,n,a,i){var r=n+" "+a+" HTTP/1.1\r\n";return r+="Content-Type: "+e+"\r\n",r+="Accept: "+t+"\r\n",i&&(r+="Content-Length: "+i+"\r\n\r\n"),r}},3062:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.View=0]="View",e[e.Edit=1]="Edit",e[e.Extract=2]="Extract",e[e.Esign=3]="Esign"}(a||(a={}))},3075:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(125),r=n(37),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.canSaveAsOriginal=function(e){var t=e.item;return!!t&&r.e.hasItemPermission(t,r.e.insertListItems)&&r.e.hasItemPermission(t,r.e.editListItems)},t.dependencies={},t}(function(){function e(){}return e.prototype.canSave=function(e){return this.canSaveAsOriginal(e)},e}()),s=Object(i.r)("PdfDataSource",o)},3099:function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l});var a=n(125),i=n(2265),r=n(355),o=n(3062),s=n(674),c=n(3133),d=function(){function e(e,t){var n=t.observablesFactoryType,a=t.viewParams,i=new n,r=btoa("esignRequest"),c=a()[s.n.viewerNavParamKey]===r?o.e.Esign:o.e.View;this.state={isOpened:i.create(!1),currentMode:i.create(c),shouldFilePickerOpen:i.create(!1),filePickerMode:i.create("merge")},this._corePdfViewerHelper=t.corePdfViewerHelper}return e.isWasmSupported=function(){return c.e.isWasmSupported()},e.prototype.isMsPdfViewerAvailable=function(e){return this._corePdfViewerHelper.isMsPdfViewerAvailable(this._convertItem(e))},e.prototype.isMsPdfViewerSupported=function(e){return this._corePdfViewerHelper.isMsPdfViewerSupported(e)},e.prototype.isNotEmbed=function(){return this._corePdfViewerHelper.isNotEmbed()},e.prototype.isPdfEditAvailable=function(e){return this._corePdfViewerHelper.isPdfEditAvailable(this._convertItem(e))},e.prototype.isPdfEditable=function(e){return this._corePdfViewerHelper.isPdfEditable(this._convertItem(e))},e.prototype.isSupportedFileType=function(e){return this._corePdfViewerHelper.isSupportedFileType(this._convertItem(e))},e.prototype.isPdfExtractAvailable=function(e){return this._corePdfViewerHelper.isPdfExtractAvailable(this._convertItem(e))},e.prototype._convertItem=function(e){return e},e.dependencies={observablesFactoryType:i.i,viewParams:r.P,corePdfViewerHelper:c.t},e}(),l=Object(a.r)("PdfViewerHelper",d)},3100:function(e,t,n){"use strict";n.d(t,"u",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"l",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"n",function(){return u}),n.d(t,"a",function(){return f}),n.d(t,"d",function(){return p}),n.d(t,"o",function(){return m}),n.d(t,"s",function(){return _}),n.d(t,"c",function(){return h});var a=n(213),i=n(8),r=a.n.isFeatureEnabled,o={ODB:1614,ODC:!1,OneDrive:!1,Fallback:!1},s={ODB:1655,ODC:!1,OneDrive:!1,Fallback:!1},c={ODB:17055,ODC:!1,OneDrive:!1,Fallback:!1},d={ODB:817,ODC:!0,OneDrive:!0},l={ODB:60124,ODC:!1,OneDrive:!1,Fallback:!1},u={ODB:1063,ODC:!1,OneDrive:!1,Fallback:!1},f={ODB:1616},p={ODB:1355,ODC:!1,OneDrive:!1,Fallback:!1},m={ECS:1071224},_={ODB:!i.e.isActivated("8a90e09f-a635-4113-897e-402973bce841","10/21/2021","Use pdf viewer to preview tiff files"),ODC:!0},h={ODB:!0,OneDrive:!0}},3133:function(e,t,n){"use strict";n.d(t,"e",function(){return g}),n.d(t,"t",function(){return v});var a,i=n(0),r=n(157),o=n(2606),s=n(125),c=n(218),d=n(285),l=n(757),u=n(1041),f=n(1491),p=n(3100),m=n(121),_=n(3075),h=n(130),b=".pdf",g=function(){function e(e,t){this._enablePdf=Object(p.u)(p.l),this._enableMsPdfviewer=Object(p.u)(p.r),this._enableEmbedMsPdfviewer=Object(p.u)(p.t),this._enableEditPdf=Object(p.u)(p.e),this._enableExtractPdf=Object(p.u)(p.i),this._enablePreviewTif=Object(p.u)(p.s),this._enableHTML=Object(p.u)(p.c)&&("boolean"!=typeof a&&(a="srcdoc"in document.createElement("iframe")),a||t.platformDetection.isEdge),this._urlDataSource=t.urlDataSource,this._pdfDataSource=t.pdfDataSource,this._navigation=t.navigation,this._viewParams=this._navigation.viewParams,this._pageContext=t.pageContext}return e.isWasmSupported=function(){if(void 0===e._isWasmSupported){var t=!1;try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var n=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));n instanceof WebAssembly.Module&&(t=new WebAssembly.Instance(n)instanceof WebAssembly.Instance)}}catch(e){}e._isWasmSupported=t}return e._isWasmSupported},e.prototype.isNotEmbed=function(){return this._urlDataSource.getPageType(this._viewParams)!==f.e.Embed},e.prototype.isSupportedFileType=function(e){var t=this._extension(e);return this._enablePdf&&(t===b||".ai"===t||!!e.pdfConversion)&&(this._enablePreviewTif||".tif"!==t&&".tiff"!==t)},e.prototype.isMsPdfViewerSupported=function(e){return(this._enableMsPdfviewer&&(this.isNotEmbed()||this._enableEmbedMsPdfviewer)||this._isEcsEnabledForEmbedMicroService(p.o.ECS)&&this._isHostAppTeams())&&this._isMsPdfViewerSupported(e)},e.prototype.isMsPdfViewerAvailable=function(e){return this.isSupportedFileType(e)&&this._isEnabledInOneUp(e)&&this.isMsPdfViewerSupported(e.size)},e.prototype.isPdfEditAvailable=function(e){return this.isMsPdfViewerAvailable(e)&&this._enableEditPdf&&this._extension(e)===b},e.prototype.isPdfExtractAvailable=function(e){return this._hasSyntexLicense()&&this.isMsPdfViewerAvailable(e)&&this.isNotEmbed()&&this._enableExtractPdf},e.prototype.isPdfEditable=function(e){var t;return e.sharingRole===o.e.Owner&&e.itemStatus!==r.t.ConditionalAccessViewOnly&&e.itemStatus!==r.t.ConditionalAccessBlocked&&(null===(t=this._pdfDataSource)||void 0===t?void 0:t.canSave({item:e}))},e.prototype._isHostAppTeams=function(){if(this.isNotEmbed())return!1;var e=this._getClientId();return-1!==["MicrosoftTeams","Microsoft Teams","Microsoft Teams Web Client","Teams Service","Teams Client App","Teams Additional Client App","Teams App"].indexOf(e)},e.prototype._isEnabledInOneUp=function(e){return!(e.officeBundle||e.wopiFrameUrl||this._enableHTML&&e.htmlConversion)},e.prototype._isMsPdfViewerSupported=function(t){var n=t<(performance.memory?performance.memory.jsHeapSizeLimit-performance.memory.totalJSHeapSize:268435456)/4;return e.isWasmSupported()&&n},e.prototype._extension=function(e){return e&&e.extension&&e.extension.toLowerCase()||""},e.prototype._hasSyntexLicense=function(){var e;return(null===(e=this._pageContext)||void 0===e?void 0:e.canUserUseSyntex)||!1},e.prototype._getClientId=function(){var e,t=(null===(e=this._pageContext)||void 0===e?void 0:e.authToken)||"",n=Object(l.a)(t);return n&&n.app_displayname||this._getClientIdFromQSP()},e.prototype._getClientIdFromQSP=function(){var e,t=window,n=Object(d.e)((t.location.search||"").slice(1)),a=Object(d.e)((t.location.hash||"").slice(1)),r=(null===(e=t.PageContext)||void 0===e?void 0:e.scenarioContext.embed)||{};return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},n),a),r).client_id},e.prototype._isEcsEnabledForEmbedMicroService=function(e){var t,n,a,i,r=(null===(t=window.Flight)||void 0===t?void 0:t.ecsConfig)&&JSON.parse(null===(n=window.Flight)||void 0===n?void 0:n.ecsConfig),o=null===(i=null===(a=null==r?void 0:r.RolloutContext)||void 0===a?void 0:a.settings)||void 0===i?void 0:i.ODSPMicroservices_ODWeb;return o&&!0===o[e]},e.dependencies={},e}(),v=Object(s.r)("PdfViewerHelper",g,{platformDetection:c.e,urlDataSource:u.e,navigation:m.e,pdfDataSource:_.e,pageContext:h.e.optional})},3183:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return c});var a,i,r=n(0),o=n(112),s=n(41);!function(e){e.AddAnnotation="OneUpUniversalAnnotation.AddAnnotation",e.DeleteAnnotation="OneUpUniversalAnnotation.DeleteAnnotation",e.Enter="OneUpUniversalAnnotation.EnterUniversalAnnotation",e.Exit="OneUpUniversalAnnotation.ExitUniversalAnnotation",e.Undo="OneUpUniversalAnnotation.UndoOperationOnAnnotations",e.Redo="OneUpUniversalAnnotation.RedoOperationOnAnnotations"}(a||(a={})),function(e){e.PullAnnotation="OneUpUniversalAnnotation.PullAnnotation",e.PushAnnotation="OneUpUniversalAnnotation.PushAnnotation",e.PreloadAnnotation="OneUpUniversalAnnotation.PreloadAnnotation"}(i||(i={}));var c=function(){function e(){}return e.logEngagement=function(t){o.e.logData({name:t,scenario:"1up Universal Annotation with msPdf Viewer",docId:e.itemId})},e.initQosEvent=function(t){var n=e._getEventQos(t);if(n&&(n.end({resultType:s.t.Failure,resultCode:e._prevEventNotEndFailure.name,error:e._prevEventNotEndFailure.message}),n=void 0),!n){var a={name:t};n=new s.e(a),e._setEventQos(t,n)}},e.logQosSuccess=function(t){e._internalLogQosEvent(t,s.t.Success)},e.logQosUnexpectedFailure=function(t,n){e._internalLogQosEvent(t,s.t.Failure,n)},e.logQosExpectedFailure=function(t,n){e._internalLogQosEvent(t,s.t.ExpectedFailure,n)},e._getEventQos=function(t){return e._eventQosCollection[t]},e._setEventQos=function(t,n){e._eventQosCollection[t]=n},e._resetEventQos=function(t){e._eventQosCollection[t]=void 0},e._internalLogQosEvent=function(t,n,a){var i=e._getEventQos(t);if(i){var o={resultType:n};a&&(o=Object(r.__assign)(Object(r.__assign)({},o),{resultCode:a.name||"Unknown",error:a.message||"Unknown",extraData:{errorStackTrace:a.stack,itemId:e.itemId}})),i.end(o),e._resetEventQos(t)}},e.itemId=void 0,e._eventQosCollection={},e._prevEventNotEndFailure={name:"previous qos event does not end",message:"previous qos event does not end while the new qos event of the same time is triggered. Now ends the previous event unexpectedly"},e}()},3561:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a,i,r=n(0),o=n(229),s=n(3050),c=n(79),d=n(125),l=n(1478),u=n(130);!function(e){e.Annotation="universalannotations",e.Layer="annotationlayers",e.Batch="$batch"}(a||(a={})),function(e){e.MultipartMixedBoundary="multipart/mixed;boundary=",e.JSON="application/json",e.HTTP="application/http"}(i||(i={}));var f=function(){function e(e,t){this._token=null;var n=t.vroomDataRequestor,a=t.pageContext;this._dataRequestor=n,this._pageContext=a}return e.prototype.update=function(e,t,n){this._getSharePointToken=e,this._basePath="/drives/".concat(n,"/items/").concat(t),this._layerPath="".concat(this._basePath,"/").concat(a.Layer)},e.prototype.createLayer=function(e){var t=e.title,n=e.mainFileVersion,a=void 0===n?"1.0":n,i=e.layerId,r=this._layerPath;return this._sendRequest({path:r,requestType:"POST",data:{title:t,mainFileVersion:a,id:i}})},e.prototype.deleteLayer=function(e){var t=e.layerId,n="".concat(this._layerPath,"/").concat(t);return this._sendRequest({path:n,requestType:"DELETE"})},e.prototype.getLayers=function(){var e=this._layerPath;return this._sendRequest({path:e,requestType:"GET"})},e.prototype.createAnnotation=function(e){var t=e.annotationId,n=e.layerId,a=e.content,i=e.partitionId,r=e.anchor,o=e.contentType,s=this._getAnnotationUrl(n);return this._sendRequest({path:s,requestType:"POST",data:{id:t,content:a,partitionId:i,anchor:r,contentType:o}})},e.prototype.getAnnotations=function(e){var t=e.layerId,n=e.partitionId,a=this._getAnnotationUrl(t);return n&&(a+="?partitionId=".concat(n)),this._sendRequest({path:a,requestType:"GET"})},e.prototype.deleteAnnotation=function(e){var t=e.layerId,n=e.partitionId,a=e.annotationId,i="".concat(this._getAnnotationUrl(t),"/").concat(a,"?partitionId=").concat(n);return this._sendRequest({path:i,requestType:"DELETE"})},e.prototype.batchCreateAnnotations=function(e){var t=e.payload;return Object(r.__awaiter)(this,void 0,void 0,function(){var e,n,o=this;return Object(r.__generator)(this,function(s){return e="batch_"+c.e.generate(),n=this._createBatchBody(e,t.map(function(e){var t=e.id,n=e.layerId,i=e.annotationId,s=Object(r.__rest)(e,["id","layerId","annotationId"]);return{path:"".concat(o._basePath,"/AnnotationLayers('").concat(n,"')/").concat(a.Annotation),requestType:"POST",id:t,data:Object(r.__assign)({id:i},s)}})),[2,this._sendRequest({path:"/".concat(a.Batch),requestType:"POST",headers:{"Content-Type":i.MultipartMixedBoundary+e},data:n})]})})},e.prototype.batchDeleteAnnotations=function(e){var t=e.payload;return Object(r.__awaiter)(this,void 0,void 0,function(){var e,n,o=this;return Object(r.__generator)(this,function(r){return e="batch_"+c.e.generate(),n=this._createBatchBody(e,t.map(function(e){var t=e.id,n=e.annotationId,a=e.layerId,i=e.partitionId;return{path:"".concat(o._getAnnotationUrl(a),"/").concat(n,"?partitionId=").concat(i),requestType:"DELETE",id:t}})),[2,this._sendRequest({path:"/".concat(a.Batch),requestType:"POST",headers:{"Content-Type":i.MultipartMixedBoundary+e},data:n})]})})},Object.defineProperty(e.prototype,"hasLicense",{get:function(){return Boolean(this._pageContext.canUserUseSyntex)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_server",{get:function(){return Object(o.s)(this._pageContext)},enumerable:!1,configurable:!0}),e.prototype._needRefreshToken=function(){return!this._token||Date.now()>=this._token.tokenExpiry},e.prototype._getToken=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return this._needRefreshToken()?[4,this._getSharePointToken(this._server)]:[3,2];case 1:e=t.sent(),this._token=e,t.label=2;case 2:return[2,this._token]}})})},e.prototype._getAnnotationUrl=function(e){return"".concat(this._layerPath,"/").concat(e,"/").concat(a.Annotation)},e.prototype._createBatchBody=function(e,t){var n,a="\r\n",r="changeset_".concat(c.e.generate()),o=Object(s.a)(e,"".concat(i.MultipartMixedBoundary,'"').concat(r,'"'),"binary")+t.map(function(e){return t=e,n="--"+r+a,n+="Content-Type: "+i.HTTP+a,n+="Content-Transfer-Encoding: binary\r\n",n+="Content-ID: "+t.id+a,n+=a,n+=Object(s.n)(i.JSON,"".concat(i.JSON,";odata=verbose"),t.requestType,t.path),n+=a,t.data&&(n+=JSON.stringify(t.data)+a,n+=a),n;var t,n}).join("")+(n="--"+r+"--"+a,n+=a,n+="--"+e+"--"+a);return new Blob([o])},e.prototype._sendRequest=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,o,s;return Object(r.__generator)(this,function(c){switch(c.label){case 0:return[4,this._getToken()];case 1:return t=c.sent(),n=e.data,a=e.path,i=e.requestType,o=e.headers,s=n?n instanceof Blob?n:JSON.stringify(n):void 0,[2,this._dataRequestor.send({path:a,endpoint:"".concat(this._server,"/_api/v2.1"),headers:Object(r.__assign)({Scenario:"Syntex_UniversalAnnotaion"},o),requestType:i,accessToken:t,apiName:"UniversalAnnotationAPI",apiVersion:"v2.1",postData:s,expectedErrorCodes:{resourceModified:!0}})]}})})},e.dependencies={vroomDataRequestor:l.e,pageContext:u.e},e}(),p=Object(d.r)("UniversalAnnotationDataSource",f)},3597:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(2265),i=new(n(9).t)({name:"".concat("UniversalAnnotationStateKey",".universalAnnotationState"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:{isUniversalAnnotationActive:t.create(!1),hasPreloadSucceeded:t.create(!0)},disposable:t}}}})},5270:function(e,t,n){"use strict";n.r(t),n.d(t,"ActivateUniversalAnnotationAction",function(){return b});var a=n(0),i=n(2280),r=n(116),o=n(41),s=n(3019),c=n(3597),d=n(3282),l=n(3183),u=n(355),f=n(3099),p=n(3561),m=n(2866),_=n(1033),h=n(35),b=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="ActivateUniversalAnnotation",a._universalAnnotationState=a.resources.consume(c.e),a._currentSlideItem=a.resources.consume(u.m),a._pdfViewerHelper=a.resources.consume(f.t),a._universalAnnotationDataSource=a.resources.consume(p.e),a._isEsignPanelActivated=a.resources.consume(d.resourceKey),Object(h.isFeatureEnabled)(h.UseMsPdfViewer)&&Object(h.isFeatureEnabled)(h.UseUniversalAnnotation)&&Object(h.isFeatureEnabled)(h.ERBugFixesEnabledForUniversalAnnotation)&&(a._coachmarkProvider=a.resources.consume(m.e.optional)),a}return Object(a.__extends)(t,e),t.prototype.onExecute=function(){var e,t=!this._universalAnnotationState.isUniversalAnnotationActive.peek();return t?(s.e("LaunchUniversalAnnotation"),l.n.logEngagement(l.e.Enter)):l.n.logEngagement(l.e.Exit),this._universalAnnotationState.isUniversalAnnotationActive(t),Object(h.isFeatureEnabled)(h.ERBugFixesEnabledForUniversalAnnotation)&&(null===(e=this._coachmarkProvider)||void 0===e?void 0:e.currentCampaign())===_.USE_UNIVERSAL_ANNOTATION&&this._coachmarkProvider.hideCampaign(),r.n.wrap({resultType:o.t.Success})},t.prototype.onIsAvailable=function(){if(!this._currentSlideItem)return!1;var e=this._currentSlideItem();return!!e&&!this._isEsignPanelActivated()&&this._universalAnnotationState.hasPreloadSucceeded()&&this._universalAnnotationDataSource.hasLicense&&this._pdfViewerHelper.isNotEmbed()&&this._pdfViewerHelper.isMsPdfViewerAvailable(e())},t.prototype.onIsToggled=function(){return this._universalAnnotationState.isUniversalAnnotationActive()},t}(i.e);t.default=b}}]);