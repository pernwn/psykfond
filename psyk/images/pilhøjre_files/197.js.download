(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[197],{2325:function(e,t,n){"use strict";n.d(t,"o",function(){return c}),n.d(t,"s",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"t",function(){return f}),n.d(t,"n",function(){return p}),n.d(t,"r",function(){return m}),n.d(t,"e",function(){return _});var a=n(2492),i=n(2532),r=n(2513),o=n(2442),s=(null===i.e||void 0===i.e?void 0:i.e.mpcDomain)||"https://my.microsoftpersonalcontent.com",c="UnAuth"===(null===i.e||void 0===i.e?void 0:i.e.hcid),d=!c&&(null===i.e||void 0===i.e?void 0:i.e.hcid)||"";function l(e){var t=e.apiVersion,n=e.driveId,i=e.includeViewerId,r=void 0!==i&&i,o=e.migrationState,s=void 0!==o&&o;return n&&"me"!==n||(n=d),Object(a.e)(n)||s?("v1.0"===t&&(t="v2.0"),r?p(t):f(t)):u(t)}function u(e){void 0===e&&(e="v1.0");var t=m(),n=2===Object(r.e)()?"storage.live-int.com":"api.onedrive.com";return"https://".concat(t).concat(n,"/").concat(e)}function f(e){return void 0===e&&(e="v2.0"),"".concat(s,"/_api/").concat(e)}function p(e){return void 0===e&&(e="v2.0"),"".concat(s,"/personal/").concat(d,"/_api/").concat(e)}function m(){switch(Object(r.e)()){case 3:return"soak2.test.";case 4:return"soak3.test.";case 2:return"newapi.dev.";default:return""}}function _(e){var t,n,a;return null!==(a=null!==(n=null!==(t=null==e?void 0:e.driveId)&&void 0!==t?t:Object(o.e)(null==e?void 0:e.cid))&&void 0!==n?n:Object(o.e)(d||void 0))&&void 0!==a?a:"me"}},2354:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.notConfigured=0]="notConfigured",e[e.visible=1]="visible",e[e.notVisible=2]="notVisible"}(a||(a={}))},2401:function(e,t,n){"use strict";var a=n(2606);t.e=a.e},2408:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(9),i=n(1027),r=n(2354),o=new a.t({name:"".concat("FirstRunExperienceStatus.key",".FirstRunExperienceStatus"),factory:{dependencies:{},create:function(e){return{instance:new i.e(r.e.notConfigured)}}}})},2442:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=!n(8).e.isActivated("682BEBB8-F1C8-486D-8B3F-0C75B53F6DC3","12/01/2022","Skip convert if driveId/cid is from sharepoint");function i(e){return a&&new RegExp("^b!").test(e)?e:e?e.replace(/^0+/,"").toLowerCase():void 0}},2466:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(2442),i=n(2573);function r(e){if(!e)return!1;if(e.indexOf("b!")>=0)return!0;e=Object(a.e)(e);var t=i.t.getValue(e);if(t){if(t.version===i.e)return t.isMigrated;i.t.remove(e)}return!1}},2492:function(e,t,n){"use strict";var a=n(2466);n.d(t,"e",function(){return a.e})},2513:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=window.FilesConfig&&window.FilesConfig.env;function i(){switch(a&&a.toLowerCase()){case"soak3":return 4;case"soak2":return 3;case"dev":return 2;case"df":return 1;default:return 0}}},2532:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return c});var a=n(74),i=n(9),r=window&&window.FilesConfig||{};r.skyDrivePickerOAuth||(r.skyDrivePickerOAuth="oauth"),!r.oauthToken&&window&&(r.oauthToken=new a.t(window.location.href).getQueryParameter("access_token"));var o=r,s=window&&window.$Config||{},c=(new i.t({name:"".concat("Config",".files"),factory:new i.e(o)}),new i.t({name:"".concat("Config",".config"),factory:new i.e(s)}))},2573:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(171),i=n(95),r=1,o=new a.e("migrationStore",i.e.local)},2606:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Owner:0,View:1,Edit:2,Submitter:3,CoOwner:4,None:5,Review:6,Custom:7}},2866:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n(0),i=n(35),r=n(2265),o=n(125),s=n(171),c=n(95),d=n(121),l=n(446),u=n(2408),f=n(2354),p=n(202),m="CoachmarkTearDropSeen",_={campaignGuid:"00000000-0000-0000-0000-000000000000",endDate:new Date(1970,1,1),flag:i.Off,isCoachmark:!0},h=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._dataStore=new s.e("CoachmarkProvider",c.e.session),a._currentCampaign=a.createObservable(_),a._isVisible=a.createObservable(!1),a._navigation=n.navigation,a._firstRunExperienceStatus=n.firstRunExperienceStatus,a._currentTeachingBubble=a.createObservable({campaign:a._currentCampaign,isVisible:a._isVisible}),a._navigation.viewParams.resetAllBubbles&&a._dataStore.remove(m);var i=a.resources.consume(p.e);return a._teachingBubbleProviderPromise=i.waitForPLT().then(function(){return a.resources.consume(l.I)}),a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentCampaign",{get:function(){return this._currentCampaign},enumerable:!1,configurable:!0}),t.prototype.hideCampaign=function(){this._isVisible(!1),this._currentCampaign(_)},t.prototype.setCampaign=function(e){var t=this;if(!e)return this._currentCampaign(_),void this._isVisible(!1);if(this._firstRunExperienceStatus.get()!==f.e.visible){var n="".concat(e.name).concat(m);this._dataStore.getValue(m)||this._teachingBubbleProviderPromise.then(function(a){a&&a.shouldBubbleBeAdded(e,!1).then(function(a){a&&(t._currentCampaign(e),t._isVisible(!0),t._dataStore.setValue(n,!0))})})}},t.prototype.getCurrentTeachingBubble=function(){return this._currentTeachingBubble},t.dependencies=Object(a.__assign)(Object(a.__assign)({},r.n.dependencies),{navigation:d.e,firstRunExperienceStatus:u.e}),t}(r.n),b=Object(o.r)("CoachmarkProvider",h)},4032:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(9).t)("imageEditorDataSource")},5303:function(e,t,n){"use strict";n.r(t),n.d(t,"OpenInImageEditorHandler",function(){return E});var a=n(0),i=n(218),r=n(2641),o=n(2265),s=n(116),c=n(124),d=n(2289),l=n(2382),u=n(36),f=n(156),p=n(157),m=n(4032),_=n(2632),h=n(35),b=n(1445),g=n(1033),v=n(2866),y=n(314),S=n(2401),D=n(2492),I=n(2325),x={jpg:"image/jpg",jpeg:"image/jpeg"},C={png:"image/png"},O={heic:"image/heic",heif:"image/heif"},w={bmp:"image/bmp",emf:"image/emf",gif:"image/gif",tiff:"image/tiff",tif:"image/tif",webp:"image/webp",wmf:"image/wmf"},E=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._itemSelectionHelper=new(n.child(d.e))({allowMultiSelect:!1,canFallback:!0}),n._isOneDriveWinApp=Object(f.e)(),n._urlDataSource=n.resources.consume(c.he),n._itemCommandHelper=n.resources.consume(l.t),n._platformDetection=n.resources.consume(i.e),n._identityDataSource=n.resources.consume(c.D),n._coachmarkProvider=n.resources.consume(v.e.optional),n._imageEditorDataSource=n.resources.consume(m.e.optional),n.state=n.createPureComputed(n._computeState),n}return Object(a.__extends)(t,e),t.prototype.getParams=function(){return this._itemSelectionHelper.resolveFirst().then(function(e){return{item:e}})},t.prototype._computeState=function(){return{isAvailable:this._isAvailable()}},t.prototype._isAvailable=function(){if(!Object(h.isFeatureEnabled)(h.HideEditPhoto)&&!0===Object(D.e)(I.s))return!1;if(!this._imageEditorDataSource)return!1;var e=this._itemSelectionHelper.firstItem();if(!e)return!1;if(e.video&&e.video.burstPhotoType)return!1;var t=this._itemCommandHelper.isCommandSupported(e,_.s),n=this._isSupportedFileType(e),a=this._itemSelectionHelper.currentItem(),i=this._urlDataSource.getKeyParams(a.key),r=this._urlDataSource.getQueryType(i),o=this._shouldEnableImageEditor()&&t&&n&&(!this._platformDetection.isIE||Object(h.isFeatureEnabled)(h.EnableEditUtilityControlIE))&&(!this._platformDetection.isSafari||Object(h.isFeatureEnabled)(h.EnableEditUtilityControlSafari))&&(!this._platformDetection.isMobile||Object(h.isFeatureEnabled)(h.EnableEditUtilityControlMobile))&&!!e&&e.sharingRole===S.e.Owner&&r!==u.e.SharedWithMe&&!this._isOneDriveWinApp&&!this._urlDataSource.isRecycleBin(r)&&e.itemStatus!==p.t.ConditionalAccessViewOnly&&e.itemStatus!==p.t.ConditionalAccessBlocked&&this._imageEditorDataSource.canSave({item:e});return o&&Object(h.isFeatureEnabled)(h.EnableEditControlTeachingBubble)&&!Object(h.isFeatureEnabled)(h.MentionTeachingUIAA)&&!Object(h.isFeatureEnabled)(h.EnableExpirationSectionForTMR)&&this._coachmarkProvider.setCampaign(g.PHOTO_EDIT),o},t.prototype._shouldEnableImageEditor=function(){if(Object(h.isFeatureEnabled)(h.EnableEditUtilityControl))return!0;if(Object(h.isFeatureEnabled)(h.EnableEditControlExperimentAA)){if(this._identityDataSource){var e=this._identityDataSource.getIdentity();e&&b.t.init({userLoginName:e.email})}var t={name:"EnableEditControlExperiment",startDate:"2/09/2021",version:b.e.v2};return new b.t(t,h.EnableEditControlExperimentAB).isOn()}return!1},t.prototype._isSupportedFileType=function(e){if(!function(e){return Object(h.isFeatureEnabled)(h.EnableEditAllImageFormats)&&k.forEach(function(e){L.push(e),L.push(e.toUpperCase())}),Object(h.isFeatureEnabled)(h.EnableEditPNG)&&(L.push(".png"),L.push(".PNG")),Object(h.isFeatureEnabled)(h.EnableEditHEIC)&&(L.push(".heic"),L.push(".heif"),L.push(".HEIC"),L.push(".HEIF")),L.some(function(t){return e.toLowerCase()===t})}(e.extension||""))return!1;if(e&&e.extension&&(e.type===y.e.File||e.type===y.e.Media)){var t=e.extension;if(t=((t&&"."===t[0]?t.substring(1):t)||"").toLowerCase(),x.hasOwnProperty(t))return!0;if(Object(h.isFeatureEnabled)(h.EnableEditPNG)&&C.hasOwnProperty(t))return!0;if(Object(h.isFeatureEnabled)(h.EnableEditHEIC)&&O.hasOwnProperty(t))return!0;if(Object(h.isFeatureEnabled)(h.EnableEditAllImageFormats)&&w.hasOwnProperty(t))return!0}return!1},t}(o.n),A=Object(r.e)({name:"OpenInImageEditor",source:{moduleDefinition:{path:"./OpenInImageEditorExecutor",getModule:function(){return s.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e(198)]).then(n.bind(null,5067)))}}},handlerType:E}),L=[".jpg",".jpeg",".JPG",".JPEG"],k=[".bmp",".emf",".gif",".tiff",".tif",".webp",".wmf"];t.default=A}}]);