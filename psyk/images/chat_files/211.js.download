(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[211],{2606:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Owner:0,View:1,Edit:2,Submitter:3,CoOwner:4,None:5,Review:6,Custom:7}},3062:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.View=0]="View",e[e.Edit=1]="Edit",e[e.Extract=2]="Extract",e[e.Esign=3]="Esign"}(a||(a={}))},3075:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(125),r=n(37),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.canSaveAsOriginal=function(e){var t=e.item;return!!t&&r.e.hasItemPermission(t,r.e.insertListItems)&&r.e.hasItemPermission(t,r.e.editListItems)},t.dependencies={},t}(function(){function e(){}return e.prototype.canSave=function(e){return this.canSaveAsOriginal(e)},e}()),s=Object(i.r)("PdfDataSource",o)},3099:function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l});var a=n(125),i=n(2265),r=n(355),o=n(3062),s=n(674),c=n(3133),d=function(){function e(e,t){var n=t.observablesFactoryType,a=t.viewParams,i=new n,r=btoa("esignRequest"),c=a()[s.n.viewerNavParamKey]===r?o.e.Esign:o.e.View;this.state={isOpened:i.create(!1),currentMode:i.create(c),shouldFilePickerOpen:i.create(!1),filePickerMode:i.create("merge")},this._corePdfViewerHelper=t.corePdfViewerHelper}return e.isWasmSupported=function(){return c.e.isWasmSupported()},e.prototype.isMsPdfViewerAvailable=function(e){return this._corePdfViewerHelper.isMsPdfViewerAvailable(this._convertItem(e))},e.prototype.isMsPdfViewerSupported=function(e){return this._corePdfViewerHelper.isMsPdfViewerSupported(e)},e.prototype.isNotEmbed=function(){return this._corePdfViewerHelper.isNotEmbed()},e.prototype.isPdfEditAvailable=function(e){return this._corePdfViewerHelper.isPdfEditAvailable(this._convertItem(e))},e.prototype.isPdfEditable=function(e){return this._corePdfViewerHelper.isPdfEditable(this._convertItem(e))},e.prototype.isSupportedFileType=function(e){return this._corePdfViewerHelper.isSupportedFileType(this._convertItem(e))},e.prototype.isPdfExtractAvailable=function(e){return this._corePdfViewerHelper.isPdfExtractAvailable(this._convertItem(e))},e.prototype._convertItem=function(e){return e},e.dependencies={observablesFactoryType:i.i,viewParams:r.P,corePdfViewerHelper:c.t},e}(),l=Object(a.r)("PdfViewerHelper",d)},3100:function(e,t,n){"use strict";n.d(t,"u",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"l",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"n",function(){return u}),n.d(t,"a",function(){return f}),n.d(t,"d",function(){return p}),n.d(t,"o",function(){return m}),n.d(t,"s",function(){return _}),n.d(t,"c",function(){return h});var a=n(213),i=n(8),r=a.n.isFeatureEnabled,o={ODB:1614,ODC:!1,OneDrive:!1,Fallback:!1},s={ODB:1655,ODC:!1,OneDrive:!1,Fallback:!1},c={ODB:17055,ODC:!1,OneDrive:!1,Fallback:!1},d={ODB:817,ODC:!0,OneDrive:!0},l={ODB:60124,ODC:!1,OneDrive:!1,Fallback:!1},u={ODB:1063,ODC:!1,OneDrive:!1,Fallback:!1},f={ODB:1616},p={ODB:1355,ODC:!1,OneDrive:!1,Fallback:!1},m={ECS:1071224},_={ODB:!i.e.isActivated("8a90e09f-a635-4113-897e-402973bce841","10/21/2021","Use pdf viewer to preview tiff files"),ODC:!0},h={ODB:!0,OneDrive:!0}},3133:function(e,t,n){"use strict";n.d(t,"e",function(){return g}),n.d(t,"t",function(){return v});var a,i=n(0),r=n(157),o=n(2606),s=n(125),c=n(218),d=n(285),l=n(757),u=n(1041),f=n(1491),p=n(3100),m=n(121),_=n(3075),h=n(130),b=".pdf",g=function(){function e(e,t){this._enablePdf=Object(p.u)(p.l),this._enableMsPdfviewer=Object(p.u)(p.r),this._enableEmbedMsPdfviewer=Object(p.u)(p.t),this._enableEditPdf=Object(p.u)(p.e),this._enableExtractPdf=Object(p.u)(p.i),this._enablePreviewTif=Object(p.u)(p.s),this._enableHTML=Object(p.u)(p.c)&&("boolean"!=typeof a&&(a="srcdoc"in document.createElement("iframe")),a||t.platformDetection.isEdge),this._urlDataSource=t.urlDataSource,this._pdfDataSource=t.pdfDataSource,this._navigation=t.navigation,this._viewParams=this._navigation.viewParams,this._pageContext=t.pageContext}return e.isWasmSupported=function(){if(void 0===e._isWasmSupported){var t=!1;try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var n=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));n instanceof WebAssembly.Module&&(t=new WebAssembly.Instance(n)instanceof WebAssembly.Instance)}}catch(e){}e._isWasmSupported=t}return e._isWasmSupported},e.prototype.isNotEmbed=function(){return this._urlDataSource.getPageType(this._viewParams)!==f.e.Embed},e.prototype.isSupportedFileType=function(e){var t=this._extension(e);return this._enablePdf&&(t===b||".ai"===t||!!e.pdfConversion)&&(this._enablePreviewTif||".tif"!==t&&".tiff"!==t)},e.prototype.isMsPdfViewerSupported=function(e){return(this._enableMsPdfviewer&&(this.isNotEmbed()||this._enableEmbedMsPdfviewer)||this._isEcsEnabledForEmbedMicroService(p.o.ECS)&&this._isHostAppTeams())&&this._isMsPdfViewerSupported(e)},e.prototype.isMsPdfViewerAvailable=function(e){return this.isSupportedFileType(e)&&this._isEnabledInOneUp(e)&&this.isMsPdfViewerSupported(e.size)},e.prototype.isPdfEditAvailable=function(e){return this.isMsPdfViewerAvailable(e)&&this._enableEditPdf&&this._extension(e)===b},e.prototype.isPdfExtractAvailable=function(e){return this._hasSyntexLicense()&&this.isMsPdfViewerAvailable(e)&&this.isNotEmbed()&&this._enableExtractPdf},e.prototype.isPdfEditable=function(e){var t;return e.sharingRole===o.e.Owner&&e.itemStatus!==r.t.ConditionalAccessViewOnly&&e.itemStatus!==r.t.ConditionalAccessBlocked&&(null===(t=this._pdfDataSource)||void 0===t?void 0:t.canSave({item:e}))},e.prototype._isHostAppTeams=function(){if(this.isNotEmbed())return!1;var e=this._getClientId();return-1!==["MicrosoftTeams","Microsoft Teams","Microsoft Teams Web Client","Teams Service","Teams Client App","Teams Additional Client App","Teams App"].indexOf(e)},e.prototype._isEnabledInOneUp=function(e){return!(e.officeBundle||e.wopiFrameUrl||this._enableHTML&&e.htmlConversion)},e.prototype._isMsPdfViewerSupported=function(t){var n=t<(performance.memory?performance.memory.jsHeapSizeLimit-performance.memory.totalJSHeapSize:268435456)/4;return e.isWasmSupported()&&n},e.prototype._extension=function(e){return e&&e.extension&&e.extension.toLowerCase()||""},e.prototype._hasSyntexLicense=function(){var e;return(null===(e=this._pageContext)||void 0===e?void 0:e.canUserUseSyntex)||!1},e.prototype._getClientId=function(){var e,t=(null===(e=this._pageContext)||void 0===e?void 0:e.authToken)||"",n=Object(l.a)(t);return n&&n.app_displayname||this._getClientIdFromQSP()},e.prototype._getClientIdFromQSP=function(){var e,t=window,n=Object(d.e)((t.location.search||"").slice(1)),a=Object(d.e)((t.location.hash||"").slice(1)),r=(null===(e=t.PageContext)||void 0===e?void 0:e.scenarioContext.embed)||{};return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},n),a),r).client_id},e.prototype._isEcsEnabledForEmbedMicroService=function(e){var t,n,a,i,r=(null===(t=window.Flight)||void 0===t?void 0:t.ecsConfig)&&JSON.parse(null===(n=window.Flight)||void 0===n?void 0:n.ecsConfig),o=null===(i=null===(a=null==r?void 0:r.RolloutContext)||void 0===a?void 0:a.settings)||void 0===i?void 0:i.ODSPMicroservices_ODWeb;return o&&!0===o[e]},e.dependencies={},e}(),v=Object(s.r)("PdfViewerHelper",g,{platformDetection:c.e,urlDataSource:u.e,navigation:m.e,pdfDataSource:_.e,pageContext:h.e.optional})},3597:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(2265),i=new(n(9).t)({name:"".concat("UniversalAnnotationStateKey",".universalAnnotationState"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:{isUniversalAnnotationActive:t.create(!1),hasPreloadSucceeded:t.create(!0)},disposable:t}}}})},5615:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(2280),r=n(116),o=n(41),s=n(218),c=n(51),d=n(2289),l=n(35),u=n(3282),f=n(228),p=n(660),m=n(3597),_=n(3099),h=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="SendForSignature",a._itemSelectionHelper=new(a.child(d.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});var i=n.isEsignPaneExpanded,r=void 0===i?a.resources.consume(u.resourceKey):i,o=n.engagement,s=void 0===o?a.resources.consume(p.e):o;return a._isEsignPaneExpanded=r,a._engagement=s,a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=this.resources.consume(c.p),n=this.resources.consume(m.e),a=this.resources.consume(_.t),i=this.resources.consume(s.e),r=n.hasPreloadSucceeded()&&n.isUniversalAnnotationActive();return function(e,t,n,a,i){var r;return!n&&Object(l.isFeatureEnabled)(l.SendForSignatureEnabled)&&t.canUserUseSyntex&&".pdf"===(null===(r=null==e?void 0:e.extension)||void 0===r?void 0:r.toLowerCase())&&a()&&!i}(e,t,r,function(){return a.isMsPdfViewerAvailable(e)},i.isMobile)},t.prototype.onExecute=function(e,t){var n=!this._isEsignPaneExpanded.peek();return this._engagement.logData({name:"SendforSignature.Click.".concat(n?"Open":"Close"),isIntentional:!0}),this._isEsignPaneExpanded(n),f.t.raise(document.body,"resize",void 0,!0),r.n.resolve({resultType:o.t.Success})},t}(i.e);t.default=h}}]);