(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[734],{2784:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(2483),i=new a.e("share"),r=(new a.e("addToShared"),new a.e("embed")),o=(new a.e("comment"),new a.e("removeFromShared"),new a.e("addAsMountPoint"),new a.e("removeAsMountPoint"),new a.e("reportAbuse"),new a.e("requestReview"),new a.e("alertItem")),s=new a.e("alertItem")},2888:function(e,t,n){"use strict";var a=n(888),i=function(){function e(e){this._itemUrlHelper=e.itemUrlHelper,this._sharingContextInformation=e.sharingContextInformation}return e.prototype.getApiRoot=function(e,t,n){if(this._sharingContextInformation){var i=this._sharingContextInformation,r=i.isFolder,o=i.isListSharing,s=i.itemUrl,c=i.listId,d=i.listItemId,l=i.listUrl,u=i.resourceId,f=i.serverRelativeItemUrl,p=i.uniqueId,m=i.webAbsoluteUrl;if(o)return e.build().webByUrl({webUrl:m}).method("Lists",c);if(p){if(c)return e.build().webByUrl({webUrl:m}).segment("lists").method("getbyid",c).method("GetItemByUniqueId",p);var _=r?"GetFolderById":"GetFileById",h={guid:p};return e.build().webByUrl({webUrl:m}).method(_,h).segment("ListItemAllFields")}return l?e.build().webByUrl({listUrl:l}).method("GetListItem",f):s?e.build().webByUrl({webUrl:m}).method("GetFileByUrl",a.t(s)).segment("ListItemAllFields"):c&&d?e.build().webByUrl({webUrl:m}).method("Lists",c).method("GetItemById",d):e.build().webByUrl({webUrl:m}).method("GetListItemByResourceId",u)}var b;b=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var g=e.build().webByItemUrl(b).method("Lists",n);return t.isRootFolder||(g=t.properties.ID?g.method("GetItemById",t.properties.ID):g.method("GetItemByUniqueId",t.properties.uniqueId)),g},e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl},e.prototype.canUseSecurable=function(e){var t=e.properties;return!(!t||!(e.isRootFolder?e.list&&e.list.id:t.ID||t.uniqueId))},e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){return!t.has(e.loginName)&&(t.add(e.loginName),!0)})}},e}();t.e=i},3227:function(e,t,n){"use strict";var a=n(0),i=n(2265),r=n(2888),o=n(675),s=n(74),c=n(1497),d=n(758),l=function(e){function t(t){var n=e.call(this,t)||this;return n.resources&&(n._itemUrlHelper=n.resources.consume(d.s),n._sharingContextInformation=n.resources.consume(c.e.optional)),n._sharingDataSourceHelperCommon=new r.e({itemUrlHelper:n._getItemUrlHelper(),sharingContextInformation:n._getSharingContextInformation()}),n}return Object(a.__extends)(t,e),t.prototype.encodeSharingLink=function(e){if(!e)return e;var t=e.split("?");return o.e(t[0],!0)+(t[1]?"?".concat(t[1]):"")},t.prototype.getApiRoot=function(e,t){var n=this.getParentListId(t),a=this._getSharingContextInformation();return a&&t.isRootFolder&&(a.isListSharing=!0),this._sharingDataSourceHelperCommon.getApiRoot(e,this.convertToISPListItem(t),n)},t.prototype.getExpirationFromLink=function(e){if(e&&e.indexOf("expiration=")>-1){var t=new s.t(e).getQueryParameter("expiration");t.indexOf("Z")!==t.length-1&&(t=t.replace(/\+/g," ")+" UTC");var n=Date.parse(t);if(n)return new Date(n).toString()}return null},t.prototype.getExpirationFromSharingLinkInfo=function(e){return""!==e?e:null},t.prototype.getFileUrl=function(e){return this._getItemUrlHelper().getItemUrlParts(e.key).fullItemUrl},t.prototype.canUseSecurable=function(e){var t=e.properties;return!(!t||!(e.isRootFolder?e.list&&e.list.id:t.ID||t.uniqueId))},t.prototype._getItemUrlHelper=function(){return this._itemUrlHelper},t.prototype._getSharingContextInformation=function(){return this._sharingContextInformation},t}(i.n),u=l,f=n(8),p=n(36),m=n(2290),_=n(2584),h=function(e){function t(t){var n=e.call(this,t)||this;return n._itemParentHelper=n.resources.consume(m.e),n}return Object(a.__extends)(t,e),t.prototype.getParentListId=function(e){var t,n,a;if(f.e.isActivated("d559ae5a-9bcc-467b-93a4-3bc2c5a23451","07/14/2022","Share command for search results")||(null==e?void 0:e.queryType)!==p.e.Search){var i=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));a=i?i.list.id:e&&e.properties?e.properties.listId:null}else if(!(a=null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.listId)){var r=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));a=null===(n=null==r?void 0:r.list)||void 0===n?void 0:n.id}return a},t.prototype.convertToISPListItem=function(e){return Object(_.n)(e)},t}(u);t.e=h},3945:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(116),i=n(41),r=n(125),o=n(124),s=function(){function e(e,t){this._ticketRedeemer=t.ticketRedeemer}return e.prototype.redeemItem=function(e,t,n){return this.redeemItems([e],t,n)},e.prototype.redeemItems=function(e,t,n){return e&&e.some(function(e){return e&&e.tokenNeedsRedeeming})||n?a.n.resolve(this._ticketRedeemer()).then(function(n){return n?n.startRedeem(t,e&&e[0]):{resultType:i.t.Success}}):a.n.resolve({resultType:i.t.Success})},e}(),c=Object(r.r)("ItemRedeemer",s,{ticketRedeemer:o.me.async.optional})},5296:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(41),r=n(124),o=n(2280),s=n(2289),c=n(116),d=n(3227),l=n(478),u=n(204),f=n(2382),p=n(2784),m=n(1439),_=n(51),h=n(3945),b=n(753),g=function(e){function t(t){var n=e.call(this,t)||this,a=t.overrideItem,i=t.scenarioId,o=t.defaultRecipients;return n._itemRedeemer=n.resources.consume(h.e),n._itemBeingShared=n.resources.consume(t.focusItemResourceKey),n._selectionHelper=new(n.child(s.e))({overrideItem:a?n.createObservable(t.overrideItem):null,allowMultiSelect:!1,canFallback:!0}),n._sharingDataSourceHelper=new(n.managed(d.e)),n._urlDataSource=n.resources.consume(r.he),n._itemCommandHelper=n.resources.consume(f.t),n._itemUrlHelper=n.resources.consume(l.s),n._pageContext=n.resources.consume(_.p),n._scenarioId=i,n._defaultRecipients=o,n.name="ShowShareAction",n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var t=this._selectionHelper.firstItem();if(!t)return!1;if(!this._itemCommandHelper.isCommandSupported(t,p.a))return!1;var n=this._itemUrlHelper.getItemUrlParts(t.key);if(n&&n.siteRelation===l.t.crossSite&&!this._pageContext.isNoScriptEnabled)return!1;var a=t.mruState,i=!a||a.canBeShared,r=!!this._sharingDataSourceHelper.getParentListId(t),o=t.properties&&(!!t.properties.ID||!!t.properties.uniqueId);return!!this._itemBeingShared()||e.prototype.onIsAvailable.call(this)&&!this._urlDataSource.isRecycleBin(t.queryType)&&!t.isRootFolder&&!t.list&&i&&r&&o&&!(t.lifeCycleStatus&&t.lifeCycleStatus.isExternal)},t.prototype.onExecute=function(e,t){var n=this;this._itemBeingShared.peek()&&this._itemBeingShared(void 0);var a=this._selectionHelper.firstItem.peek();return this._itemRedeemer.redeemItems([a],this).then(function(){return t.data.extraData||(t.data.extraData={}),u.e(t.data.extraData,{uniqueId:a.properties?a.properties.uniqueId:void 0,Host:Object(b.e)()}),n._itemBeingShared({items:[a],scenarioId:n._scenarioId,defaultRecipients:n._defaultRecipients}),c.n.wrap({resultType:i.t.Success})},function(e){return c.n.reject(e)})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(m.e,{item:this._selectionHelper.firstItem})},t}(o.e);t.default=g}}]);