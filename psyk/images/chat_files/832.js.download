(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[832],{5545:function(e,t,n){"use strict";n.r(t),n.d(t,"substrateFavoritesAddon",function(){return C});var a=n(6),i=n(288),r=n(4),o=n(7),s=n(312),c=n(259),d=n(437),l=n(0),u=n(33),f=n(169),p=n(1489),m=n(567),_=n(356),h=n(771),b=n(47),g=n(70),v=n(1665),y=n(1758),S=Object(a.i)()(function e(t){var n=this,a=t.itemKey;return function(t){return Object(l.__awaiter)(n,void 0,void 0,function(){var n,i,c,d,S,D,I,x,C,O,w,E,A,L,k,M,P,T,U,F,H,R,N,B,j;return Object(l.__generator)(this,function(V){switch(V.label){case 0:if(n=t(Object(f.e)({isFavoritesEnabled:u.I,favoritesProvider:y.e})),i=n.isFavoritesEnabled,c=n.favoritesProvider,!(null==i?void 0:i()))return[2];if(!(null==c?void 0:c.getFavoritedItems))throw new g.e({code:"NoEdgeworthProvider"});return[4,c.getFavoritedItems({cachingStrategy:_.e.useCacheIfNotExpired,cacheTimeoutTime:0})];case 1:if(!(d=V.sent()))return[2];for(S=new s.e({publisher:e}),D=0,I=d;D<I.length;D++)x=I[D],C=v.e.serialize({id:x.file.Id}),S.resolveItems({items:(F={},F[C]=Object(l.__assign)({},r.y.pack(!0)),F)}),O=x.file.SharePointItem.SitePath,w=null===(B=x.file.OneDriveInfo)||void 0===B?void 0:B.DriveId,E=null===(j=x.file.OneDriveInfo)||void 0===j?void 0:j.ItemId,O&&w&&E&&(A=new b.e(O).authority,L="".concat(A,"/_api/v2.0"),k={endpoint:L,driveId:w,itemId:E},M=p.e.serialize({driveItem:k}),S.mapKeys({mappings:(H={},H[M]=C,H)})),P=x.file.SharePointItem.FileUrl,(T=P?Object(h.e)(P):void 0)&&(U=m.e.serialize({spItemFullUrl:{itemFullUrl:T}}),S.mapKeys({mappings:(R={},R[U]=C,R)}));return S.resolveItems({items:(N={},N[a]=Object(l.__assign)({},o.e.pack({itemKeys:[]})),N)}),t(S.execute()),[2]}})})}}),D=n(694),I=n(468),x=Object(a.n)()(function(e){var t=this;return function(e){return Object(l.__awaiter)(t,void 0,void 0,function(){var t;return Object(l.__generator)(this,function(n){switch(n.label){case 0:return t=I.e.serialize({}),[4,e(Object(D.e)(function(e){return e.demandItemFacet(o.e,t)}))];case 1:return n.sent(),[2]}})})}}),C=Object(a.t)(function(){return function(e){e(new s.e({publisher:C}).execute()),e(Object(c.t)({keyFacet:v.e,facets:[r.y]})),e(Object(i.a)(v.e,d.e)(x)),e(Object(c.t)({keyFacet:I.e,facets:[o.e]})),e(Object(i.a)(I.e,d.e)(S))}})}}]);