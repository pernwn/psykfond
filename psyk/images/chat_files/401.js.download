(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[401,106],{2427:function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a={Unknown:0,Legacy:1,Classic:2,Modern:3,PowerApp:4,Customized:5},i={ready:0,saving:1,updating:2},r={Dropdown:0,Radio:1}},2448:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i});var a={editItem:1,newItem:2,displayItem:3};function i(e){switch(e){case a.editItem:return"Edit";case a.newItem:return"New";case a.displayItem:return"Display";default:return"Unknown"}}},2498:function(e,t,n){"use strict";var a=n(2539);t.e=a.e},2507:function(e,t,n){"use strict";var a,i=n(345),r={ODB:563,ODC:null,Fallback:!1};!function(e){function t(e){return"url"===e||"website"===e}var n;e.isShortcutItem=function(e){return!(!e||!e.extension)&&t("."!==e.extension[0]?e.extension:e.extension.slice(1))},e.isShortcutFileType=t,e.isShortcutEnabled=function(){return i.e.isFeatureEnabled(r)},(n=e.ShortcutErrors||(e.ShortcutErrors={}))[n.UnknownError=0]="UnknownError",n[n.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError",n[n.InvalidCharacterError=2]="InvalidCharacterError"}(a||(a={})),t.e=a},2539:function(e,t,n){"use strict";var a=n(0),i=n(2265),r=n(204),o=n(594),s=n(130),c=n(1029),d=function(e){function t(t,n){var a=e.call(this,void 0,n)||this;a._pageContext=t||a.resources.consume(s.e);var i=null==n?void 0:n.dataRequestNoRedirect,r=null==n?void 0:n.dataRequestorType;return a._makeDataRequestor=r?function(e){return new r(e)}:function(e){return new o.e(e,{pageContext:a._pageContext,noRedirect:i})},a.dataRequestor=a._makeDataRequestor({qosName:a.getDataSourceName()}),a}return Object(a.__extends)(t,e),t.prototype.getDataSourceName=function(){return"DataSource"},t.prototype.updateContext=function(e){r.e(this._pageContext,e),this.dataRequestor=this._makeDataRequestor({qosName:this.getDataSourceName()})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{dataRequestorType:o.n,dataRequestNoRedirect:c.e.optional}),t}(i.n);t.e=d},2584:function(e,t,n){"use strict";n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(157),i=n(37);function r(e){return e}function o(e){return e}function s(e,t){return e&&e.extension&&!!e.openUrl&&!t.isRecycleBin(e.queryType)&&e.itemStatus!==a.t.ConditionalAccessViewOnly&&e.itemStatus!==a.t.ConditionalAccessBlocked&&i.e.hasItemPermission(e,i.e.openItems)}},2591:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header",e[e.SelectAll=3]="SelectAll"}(a||(a={}))},2607:function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),function(e){e[e.fail=0]="fail",e[e.partialSuccess=1]="partialSuccess",e[e.success=2]="success"}(a||(a={})),function(e){e[e.pending=0]="pending",e[e.success=1]="success"}(i||(i={}))},2622:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"s",function(){return c}),n.d(t,"a",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"o",function(){return f}),n.d(t,"r",function(){return p});var a=n(19),i=n(2807),r="_ComplianceTag",o="_ComplianceFlags",s=200;function c(e){return!!(256&e)}function d(e){if(!e.HasRetentionAction)return" ";if(0===e.TagDuration)return e.BlockDelete?i.RetainForeverText:" ";var t=u(e.TagDuration);return e.BlockDelete?a.format(i.PreserveTagText,t):e.AutoDelete?a.format(i.DeleteTagText,t):" "}function l(e){if(e.Notes)return e.Notes;if(!e.HasRetentionAction)return i.NoRetentionTooltip;if(0===e.TagDuration)return e.BlockDelete?i.PreserveForeverTooltip:i.NoRetentionTooltip;var t=u(e.TagDuration),n="",r="";e.BlockDelete?(n="PreserveTag"+e.TagRetentionBasedOn+"Tooltip",e.BlockEdit&&(r=i.PreserveIsRecordTooltipModifier),e.ReviewerEmail?r+=i.ReviewTooltip:r+=e.AutoDelete?i.PreserveAutoDeleteTooltipModifier:i.PreserveNoDeleteTooltipModifier):e.AutoDelete&&(n="DeleteTag"+e.TagRetentionBasedOn+"Tooltip");var o=i[n];return o?a.format(o,t)+r:null}function u(e){var t="";if(e>0){var n=Math.floor(e/365);if(n>0){var r=n>1?i.RetentionPeriodYears:i.RetentionPeriodYear;t=a.format(r,n)}else{var o=Math.floor(e/30);if(o>0){var s=o>1?i.RetentionPeriodMonths:i.RetentionPeriodMonth;t=a.format(s,o)}else{var c=e>1?i.RetentionPeriodDays:i.RetentionPeriodDay;t=a.format(c,e)}}}return t}function f(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"boolean"===t.toLowerCase()&&n&&n.toLowerCase()==="96BE7325-AFA4-48CF-8503-9258F0A7817D".toLowerCase()));var t,n}function p(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"lookup"===t.toLowerCase()&&n&&n.toLowerCase()==="D4B6480A-4BED-4094-9A52-30181EA38F1D".toLowerCase()));var t,n}},2631:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(285),i=n(269);function r(e,t){var n=Object(a.e)(e).id;return t&&t.urlParts&&(n===t.urlParts.fullListUrl||n===t.urlParts.serverRelativeListUrl)&&(n=void 0),n}function o(e,t){var n=e;return 0!==n.indexOf("id")&&(n=Object(i.e)({id:e,listurl:t})),n}},2758:function(e,t,n){"use strict";n.r(t),n.d(t,"SensitivityLabelsDataSource",function(){return f});var a=n(0),i=n(1288),r=n(8),o=n(755),s=n(356),c=n(214),d=n(116),l=r.e.isActivated("8a599b0b-8859-422a-aa10-ca6a49ce77eb","04/04/2022","Switch to newer sensitivity label api path"),u=r.e.isActivated("3d8830f8-713c-444f-9c9f-1db6c603995a","04/06/2023","Throw an error when no auth is provided and not return an empty array");t.default=f;var f=function(){function e(e,t){var n=t.pageContext,a=t.graphDataRequestor;this._pageContext=n,this._graphDataRequestor=a||new i.e({},{}),this._getOAuthToken=e.getOAuthToken,this._getOAuthToken2=t.getOAuthToken,this._cache=new o.e({id:"SensitivityLabelsDataSource"},{pageContext:n})}return e.prototype.getSensitivityLabels=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(a.__generator)(this,function(t){return[2,this._cache.getDataUtilizingCache({cachingStrategy:s.e.useCacheIfNotExpired,cacheTimeoutTime:c.i,cacheRequestKey:"SensitivityLabelsDataSource",getData:function(){return e._getSensitivityLabels()}}).catch(function(){return null})]})})},e.prototype.getDocLibSensitivityLabelsCached=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(a.__generator)(this,function(t){return[2,this._cache.getDataUtilizingCache({cachingStrategy:s.e.useCacheAndUpdateInTheBackground,cacheRequestKey:"SensitivityLabelsDataSourceDocLib",getData:function(){return e.getDocLibSensitivityLabels()}}).catch(function(){return null})]})})},e.prototype.getDocLibSensitivityLabels=function(){return Object(a.__awaiter)(this,void 0,d.n,function(){var e,t,n,i,r=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return!u||this._getOAuthToken||this._getOAuthToken2?(e="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],e)]:[3,2]):[2,d.n.resolve([])];case 1:return n=a.sent(),[3,4];case 2:return[4,this._getOAuthToken2(e)];case 3:n=a.sent(),a.label=4;case 4:return t=n,this._sensitivityLabels?(i=this._sensitivityLabels,[3,7]):[3,5];case 5:return[4,this._graphDataRequestor.send({endpoint:e,path:"".concat(e,"/beta/me/informationprotection/sensitivityLabels"),apiName:"GraphDataProvider.getSensitivityLabels",accessToken:{accessToken:t},requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{host:"Document libraries"},parseResponse:function(e){var t=JSON.parse(e.responseText).value;return r._sensitivityLabels=t,t}})];case 6:i=a.sent(),a.label=7;case 7:return[2,i]}})})},e.prototype.setSensitivityLabel=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r={id:n,assignmentMethod:"Privileged",justificationText:i||"",actionSource:"Manual"},this._getOAuthToken||this._getOAuthToken2?(o="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],o)]:[3,2]):[2,Promise.resolve("")];case 1:return c=a.sent(),[3,4];case 2:return[4,this._getOAuthToken2(o)];case 3:c=a.sent(),a.label=4;case 4:return s=c,[4,this._graphDataRequestor.send({endpoint:o,path:"".concat(o,"/beta/drives/").concat(e,"/items/").concat(t,"/setSensitivityLabel"),apiName:"GraphDataProvider.setSensitivityLabel",postData:JSON.stringify(r),accessToken:{accessToken:s},requestType:"POST",useAuthorizationHeaders:!0,qosExtraData:{host:"Document libraries"},parseResponse:function(e){return null==e?void 0:e.responseText}})];case 5:return[2,a.sent()]}})})},e.prototype._getSensitivityLabels=function(){return Object(a.__awaiter)(this,void 0,d.n,function(){var e,t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return this._getOAuthToken||this._getOAuthToken2?(e="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],e)]:[3,2]):[2,d.n.resolve([])];case 1:return n=a.sent(),[3,4];case 2:return[4,this._getOAuthToken2(e)];case 3:n=a.sent(),a.label=4;case 4:return(t=n)?[4,this._graphDataRequestor.send({endpoint:e,path:"".concat(e,l?"/beta/me/informationprotection/policy/labels":"/beta/me/security/informationProtection/sensitivityLabels"),apiName:"GraphDataProvider.getSensitivityLabels",accessToken:{accessToken:t},requestType:"GET",useAuthorizationHeaders:!0,parseResponse:function(e){return JSON.parse(e.responseText).value.filter(function(e){return!0===e.isActive}).sort(function(e,t){return e.sensitivity>t.sensitivity?1:-1})}})]:[2,d.n.resolve([])];case 5:return[2,a.sent()]}})})},e}()},2798:function(e,t,n){"use strict";n.d(t,"e",function(){return v});var a,i,r=n(116),o=n(19);!function(e){e[e.remove=0]="remove",e[e.add=1]="add"}(a||(a={})),function(e){e[e.attachment=0]="attachment",e[e.image=1]="image"}(i||(i={}));var s=n(0),c=n(8),d=n(1429),l=n(229),u=function(e){function t(t,n){var a=e.call(this,{},n)||this,i=t.apiUrlHelper,r=t.itemUrlHelper;return a._itemUrlHelper=r,a._apiUrlHelper=i,a}return Object(s.__extends)(t,e),t.prototype.getAttachments=function(e,t){var n=this;return this.getData(function(){return n.buildAttachmentBaseUrl(e,t).toString()},function(e){var t=JSON.parse(e);if(t&&t.d&&t.d.resultes&&0===t.d.results.length)return[];var a=t.d.results;return n.transformAttachmentData(a)},"Attachments")},t.prototype.addAttachment=function(e,t,n){var a=this;return new r.n(function(i,r){var o=new FileReader;o.onload=function(s){var c=o.result;a.doUploadAttachment(e,t,n.name,c).then(i,r)},o.readAsArrayBuffer(n)},function(){})},t.prototype.deleteAttachment=function(e,t,n,a){var i=this;return new r.n(function(r,o){i.doDeleteAttachment(e,t,n,a||!1).then(r,o)},function(){})},t.prototype.getDataSourceName=function(){return"AttachmentDataSource"},t.prototype.addImage=function(e,t,n,a,i,o,s){var c=this;return new r.n(function(r,d){var l=new FileReader;l.onload=function(u){var f=l.result;c.doUploadImage(t,a,i,s.name,f,n,e,o).then(r,d)},l.readAsArrayBuffer(s)},function(){})},t.prototype.attachImage=function(e,t,n){var a=this;return new r.n(function(i,r){var o=new FileReader;o.onload=function(s){var c=o.result;a.doUpdateImage(e,t,n.name,c).then(i,r)},o.readAsArrayBuffer(n)},function(){})},t.prototype.deleteImage=function(e,t,n){var a=this;return new r.n(function(i,r){a.doUpdateImage(e,t,n).then(i,r)},function(){})},t.prototype.doUpdateImage=function(e,t,n,a){var i=this._itemUrlHelper.getUrlParts(),r=this._apiUrlHelper.build().webByItemUrl(i).method("GetList",i.serverRelativeListUrl).method("Items",e).methodWithAliases("AddThumbnailFieldData",{imageName:n,fieldInternalName:t});return this.dataRequestor.getData({url:r.toString(),parseResponse:function(e){var t=JSON.parse(e);return t.d&&void 0!==t.d.AddThumbnailFieldData},qosName:"AddThumbnailFieldData",noRedirect:!0,additionalPostData:a||void 0})},t.prototype.buildAttachmentBaseUrl=function(e,t,n){var a=this._itemUrlHelper.getItemUrlParts(t),i=this._apiUrlHelper.build().webByItemUrl(a).method("GetList",a.serverRelativeListUrl).method("Items",e);return n?i.method("AttachmentFiles",n):i.segment("AttachmentFiles")},t.prototype.transformAttachmentData=function(e){var t=this;return e.map(function(e){return{type:"attachment",fileName:e.FileName,serverRelativeUrl:Object(l.s)(t._pageContext)+e.ServerRelativeUrl,uploaded:!0}})},t.prototype.doUploadAttachment=function(e,t,n,a){var i=this;return this.dataRequestor.getData({url:this.buildAttachmentBaseUrl(e,t).methodWithAliases("addUsingPath",{decodedUrl:n}).toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d)return null;var n=[t.d],a=i.transformAttachmentData(n);return a&&1===a.length?a[0]:null},qosName:"UploadAttachment",additionalPostData:a,noRedirect:!0})},t.prototype.doDeleteAttachment=function(e,t,n,a){var i=this;return this.getData(function(){return i.buildAttachmentBaseUrl(e,t,n).segment(a?"DeleteObject":"RecycleObject").toString()},function(e){try{var t=JSON.parse(e);return a&&void 0!==t.d.DeleteObject||!a&&void 0!==t.d.RecycleObject}catch(e){return!1}},a?"DeleteAttachment":"RecycleAttachment")},t.prototype.doUploadImage=function(e,t,n,a,i,r,o,s){var d=this,l=this._itemUrlHelper.getItemUrlParts(e),u=this._apiUrlHelper.build().webByItemUrl(l).methodWithAliases("UploadImage",{listTitle:t,imageName:a,listId:r,itemId:o,fieldId:s});return c.t.isActivated("dd617e52-55d0-40bc-9e0f-ffd875d6a25c","11/10/2021","pipe through filed id to UploadImage call")&&(u=this._apiUrlHelper.build().webByItemUrl(l).methodWithAliases("UploadImage",{listTitle:t,imageName:a,listId:r,itemId:o})),this.dataRequestor.getData({url:u.toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d||!t.d.UploadImage)return null;var a=t.d.UploadImage;return d.transformImageData(a,n,s)||null},qosName:"UploadImage",additionalPostData:i,noRedirect:!0})},t.prototype.transformImageData=function(e,t,n){return{type:"thumbnail",fileName:e.Name,serverRelativeUrl:e.ServerRelativeUrl,id:e.UniqueId,fieldName:t,serverUrl:Object(l.s)(this._pageContext),fieldId:n}},t}(d.e),f=n(665),p=n(220),m=n(3157),_=n(112),h=n(79),b=n(213),g={ODB:1770},v=function(){function e(e){this.listTitle=e.pageContext.listTitle,this.listId=h.e.normalizeLower(e.pageContext.listId,!1);var t=new p.e({},{pageContext:e.pageContext}),n=new f.e({},{itemUrlHelper:t,pageContext:e.pageContext}),a={pageContext:e.pageContext};this.dataSource=new u({apiUrlHelper:n,itemUrlHelper:t},a),this.isImageColumnUsingAttachmentsInListEnabled=b.n.isFeatureEnabled(g),this.imageOperationsPool=[],this.attachmentOperationsPool=[]}return e.prototype.createAddAttachmentOperation=function(e,t,n){var r={type:a.add,listItemId:e,listItemKey:t,fileType:i.attachment,fileName:n.name,file:n};this.handleNewOperation(r,this.attachmentOperationsPool)},e.prototype.createDeleteAttachmentOperation=function(e,t,n){var r={type:a.remove,listItemId:e,listItemKey:t,fileType:i.attachment,fileName:n};this.handleNewOperation(r,this.attachmentOperationsPool)},e.prototype.createAddImageOperation=function(e,t,n,r,o){var s={type:a.add,listItemId:e,listItemKey:t,fileType:i.image,fileName:n.name,file:n,fieldName:r,fieldId:o};this.handleNewOperation(s,this.imageOperationsPool)},e.prototype.createDeleteImageOperation=function(e,t,n,r){var o={type:a.remove,listItemId:e,listItemKey:t,fileType:i.image,fileName:n,fieldName:r};this.handleNewOperation(o,this.imageOperationsPool)},e.prototype.executeImageOperationsOnSingleItem=function(e,t,n){var a=this.imageOperationsPool.slice();return this.clearImageOperations(e||0,t,n),this.executeAllOperationsCore(a,e,t)},e.prototype.executeImageOperationsOnMultipleItems=function(e){var t=this;if(0===e.length)return r.n.resolve([]);var n=[];return e.forEach(function(e){n.push(t.executeImageOperationsOnSingleItem(e,void 0,!1))}),r.n.all(n).then(function(e){var t=[];return e.forEach(function(e){e.forEach(function(e){t.push(e)})}),t})},e.prototype.executeAttachmentOperations=function(e){return this.executeAllOperationsCore(this.attachmentOperationsPool,e,void 0)},e.prototype.hasPendingImageOperations=function(){return this.imageOperationsPool.length>0},e.prototype.hasPendingAttachmentOperations=function(){return this.attachmentOperationsPool.length>0},e.prototype.clearAttachmentOperations=function(){this.attachmentOperationsPool=[]},e.prototype.executeAllOperationsCore=function(e,t,n){var i=this,o=e;return n&&(o=e.filter(function(e){return e.fieldName===n})),new r.n(function(e,r){if(o.length>0){var s=o[0],c=o.slice(1),d=void 0;s.type===a.add?(void 0===t||s.listItemId||(s.listItemId=t),d=i.processUpload(s.listItemId,s.listItemKey,s.file,s.fileType,s.fieldName,s.fieldId)):d=i.processDelete(s.listItemId,s.listItemKey,s.fileName,s.fileType,s.fieldName);var l=function(a){i.executeAllOperationsCore(c,t,n).done(function(t){return e([a].concat(t))},r)};d.done(l,l),_.e.logData({name:"ClientFormUpdate.attachments"})}else e([])})},e.prototype.processUpload=function(e,t,n,a,r,s){return a===i.image?this.isImageColumnUsingAttachmentsInListEnabled?this.dataSource.attachImage(e,r,n).then(function(e){return{result:e,attachment:null,image:{type:"thumbnail",fieldName:r,fileName:n.name},errorMsg:e?null:o.format(m.n,n.name)+"."}},function(e){var t=o.format(m.n,n.name);throw e&&(e.code&&e.code.indexOf("InvalidDataException")>=0?t=m.a:e.message&&e.message.value&&(t+=" : "+e.message.value)),{result:!1,attachment:null,image:{type:"thumbnail",fieldName:r,fileName:n.name},errorMsg:t}}):this.dataSource.addImage(e,t,this.listId,this.listTitle,r,s,n).then(function(e){return{result:!0,attachment:null,image:e,errorMsg:e?null:o.format(m.n,n.name)+"."}},function(e){var t=o.format(m.n,n.name);throw e&&(e.code&&e.code.indexOf("InvalidDataException")>=0?t=m.a:e.message&&e.message.value&&(t+=" : "+e.message.value)),{result:!1,attachment:null,image:{type:"thumbnail",fieldName:r,fileName:n.name,serverUrl:null,fieldId:s},errorMsg:t}}):this.dataSource.addAttachment(e,t,n).then(function(e){return{result:!0,attachment:e,errorMsg:e?null:o.format(m.t,n.name)+"."}},function(e){throw{result:!1,attachment:{type:"attachment",uploaded:!1,fileName:n.name},errorMsg:o.format(m.t,n.name)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}})},e.prototype.processDelete=function(e,t,n,a,s,c){var d;if(a===i.image){if(!this.isImageColumnUsingAttachmentsInListEnabled)return r.n.wrap({result:!0,image:{type:"thumbnail",fieldName:s,fileName:n,serverRelativeUrl:null,serverUrl:null,fieldId:c},errorMsg:null});d=this.dataSource.deleteImage(e,s,n).then(function(e){return{result:e,errorMsg:e?null:o.format(m.n,n)+"."}},function(e){throw{result:!1,errorMsg:o.format(m.n,n)}})}else d=this.dataSource.deleteAttachment(e,t,n).then(function(e){return{result:e,errorMsg:e?null:o.format(m.e,n)+"."}},function(e){throw{result:!1,errorMsg:o.format(m.e,n)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}});return d},e.prototype.handleNewOperation=function(e,t){var n=e.type,i=this.findDuplicateOperation(e,t);n===a.add?i<0&&t.push(e):i<0?t.push(e):t.splice(i,1)},e.prototype.findDuplicateOperation=function(e,t){var n=e.fileType,r=-1;return t.some(function(t,o){var s=!1;if((isNaN(t.listItemId)&&isNaN(e.listItemId)||t.listItemId===e.listItemId)&&(s=!0),t.type===a.add&&s&&t.fileName===e.fileName&&(n!==i.image||t.fieldName===e.fieldName))return r=o,!0}),r},e.prototype.clearImageOperations=function(e,t,n){if(this.imageOperationsPool.length>0)if(n||!e)this.imageOperationsPool=[];else{var a=this.imageOperationsPool.filter(function(n){return Number(n.listItemId)!==e||!!t&&n.fieldName!==t});this.imageOperationsPool=a}},e}()},2808:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={richClient:0,browser:1}},2817:function(e,t,n){"use strict";n.d(t,"e",function(){return fe});var a=n(116),i=n(155),r=n(213),o=n(330),s=n(2427),c=n(0),d=n(86),l=n(2275),u=n(1386),f=n(1969),p=n(1429),m=n(2607),_=n(2448),h=n(220),b=n(1037),g=n(424),v=n(665),y=n(229),S=n(2825),D=n(1448),I=n(1040),x=n(2824),C=n(1453),O=n(15),w=function(){function e(e){this._listContext=e.listContext,this._pageContext=e.pageContext,this._itemStore=e.itemStore,this._language=e.language}return e.prototype.processData=function(e,t){Object(D.updateListContext)(t,this._listContext),Object(D.updateListContextGroupInfo)(this._listContext);var n=t.ListSchema&&"TRUE"===t.ListSchema.Collapse,a=this._processSchema(t.ListSchema),i=t.ListContenTypes,r=t.ListData||t,o=x.e.buildRootItem(e,t,this._listContext,this._itemStore),s=this._processItems(r,n,o,this._language);return{root:o,items:s.items,groups:s.groups,totalCount:s.totalCount,startIndex:this._getStartIndex(r),columns:a,contentTypes:i,nextRequestToken:this._getNextRequestToken(r),isAllGroupsCollapsed:n}},e.prototype._processSchema=function(e){if(e){var t={},n={hasFixedSchema:this._listContext.listTemplateType===O.n.mySiteDocumentLibrary};this._listContext.listSchema=Object(I.buildSchema)(e,this._listContext,n,t),Object.keys(t).length&&(this._listContext.groupSchema=t)}return this._listContext.listSchema},e.prototype._processItems=function(e,t,n,a){var i;return(i=t?Object(C.e)(e.Row,this._listContext,void 0,a):x.e.buildItems(e,this._listContext,this._pageContext,n,this._itemStore)).groups&&i.groups.length>0&&(this._listContext.lastGroup=i.groups[i.groups.length-1]),{items:i.items?i.items:[],groups:i.groups,totalCount:i.totalCount}},e.prototype._getStartIndex=function(e){var t=0;return this._listContext.group?t=this._listContext.group.startIndex:e.FirstRow&&(t=e.FirstRow-1),t},e.prototype._getNextRequestToken=function(e){var t="";return e.NextHref&&(t=(t=e.NextHref).replace("&View=00000000-0000-0000-0000-000000000000","")),t},e}(),E=n(2798),A=n(2841),L=n(2622),k=n(2808),M=n(112),P=n(74),T=n(97),U="OnChangingTags";function F(e,t){void 0===t&&(t=1);try{for(var n=e.fields.length,a=0;a<n;a++)if("TaxonomyFieldType"===e.fields[a].schema.FieldType||"TaxonomyFieldTypeMulti"===e.fields[a].schema.FieldType){var i=H(e.fields[a].serverData,e.fields[a].data);if(0===i.addedTagsCount&&0===i.deletedTagsCount)continue;var r=e.fields[a].schema.FieldType.toLowerCase();e.isBulkEdit||t>1?r+=".BulkEdit.":r+=".NotBulkEdit.",r+=U;for(var o=0;o<t;o++)M.e.logData({name:r,isIntentional:!0,extraData:{deletedTagsCount:i.deletedTagsCount,addedTagsCount:i.addedTagsCount}})}}catch(e){return void T.e.logError(e,{eventName:U})}}function H(e,t){var n=R(e),a=R(t),i=0,r=Object.keys(n).length,o=Object.keys(a).length;if(r>0&&o>0)for(var s in n)a[s]&&i++;return{deletedTagsCount:r-i,addedTagsCount:o-i}}function R(e){if(!e)return{};for(var t={},n=0,a=e.split(";");n<a.length;n++)t[a[n]]=!0;return delete t[""],t}var N=n(8),B=n(1454),j=n(228),V=n(2826),z=n(1036),G=n(2758),K=n(2823),W=n(186),q="0x0120",Q={ODB:788,OneDrive:!0},Y={ODB:573,OneDrive:!0},J={ODB:1261},X={ODB:1293},Z={ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1},$={ODB:60092,ODC:void 0,Fallback:!1},ee={ODB:1770},te="CreateItem",ne="UpdateItem",ae=N.t.isActivated("DC2F1582-A7C4-4DDA-AB48-39490F5EBB18","04/18/2022","fix event fields on update"),ie={ODB:60925},re=N.t.isActivated("8aa8a122-dec2-44e9-b2a4-cf41f74ca447","06/14/2022","when contentType name and id are returned from the server, use the value directly instead of reading it from the cache"),oe=N.t.isActivated("ffb103bc-ed13-4e14-98a4-b0f6c573c8d6","08/24/2022","ensure update contentTypeInfo"),se=N.t.isActivated("d3ea1d30-dd0c-4885-9a95-d6788e1a67ba","03/20/2023","When thumbnail field does not contain data, do not set nucleusRedirection header in item creation/update request"),ce=N.t.isActivated("3d8830f8-713c-444f-9c9f-1db6c603995a","04/06/2023","Throw an error when no auth is provided and not return an empty array"),de=function(e){function t(t,n){var a=e.call(this,{},n)||this;return a._clientForms=null,a._init=function(e,t){var n=t.pageContext,i=t.apiUrlHelper,o=t.itemUrlHelper;a._itemUrlHelper=o||new h.e({},{pageContext:n}),a._apiUrlHelper=i||new v.e({},{itemUrlHelper:a._itemUrlHelper,pageContext:n}),e.complianceTagProvider?a._complianceTagProvider=e.complianceTagProvider:a._complianceTagProvider=new A.e({pageContext:n}),a._getSharedLockId=e.getSharedLockId,e.fileUploaderProvider?a._fileUploaderProvider=e.fileUploaderProvider:a._fileUploaderProvider=new E.e({pageContext:n}),a.isFeatureEnabled=e.isFeatureEnabled?e.isFeatureEnabled:function(e){return r.n.isFeatureEnabled(e,a._pageContext&&a._pageContext.ExpFeatures)},a.isFeatureEnabled(ie)&&a._pageContext.isLabelIRMEnabled&&(a._sensitivityLabelsDataSource=new G.SensitivityLabelsDataSource({},{pageContext:a._pageContext,getOAuthToken:null==t?void 0:t.getGraphAuthToken}))},a._getAdditionalPostData=function(e){return e.isListDataRenderOptionChangeFeatureEnabled=a.isFeatureEnabled(Q),e.isSpotlightFeatureEnabled=a.isFeatureEnabled(Y),g.e(e)},a._init(t,n),a}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"listContext",{set:function(e){this._listContext=e},enumerable:!1,configurable:!0}),t.prototype.updateContext=function(e,t){this._init(e,t)},t.prototype.getClientFormSchema=function(e,t,n){var i,r=this,o=function(){var a=r._locateClientFormWithContentTypeInfos(e,t);if(n&&a&&a.fields){var i=a.fields.filter(function(e){return!r._isFieldRequireUniqueValue(e)});return Object(c.__assign)(Object(c.__assign)({},a),{fields:i})}return a};return e===_.e.newItem&&t&&this._contentTypeIdToNameMap&&(i=this._contentTypeIdToNameMap[t[0].contentTypeId]),null===this._clientForms||this._listContext.refreshClientForm||!i?(this._listContext.refreshClientForm=void 0,this.fetchAllClientFormSchemas().then(function(){return o()})):a.n.wrap(o())},t.prototype.getClientForm=function(e,t,n,i){var r=this;return new a.n(function(a,o){r.getData(function(){var t=d.e.encodeRestUriStringToken(r._listContext.listUrl),n=new P.t(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0",a=",cutoffVersion=".concat(n);return"".concat(r._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/RenderExtendedListFormData(itemId=".concat(e,",formId='editform',mode='2',options=").concat(30).concat(a,")")+"?@v1='".concat(t,"'")},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData)return t=JSON.parse(t.d.RenderExtendedListFormData),n&&n.length>0&&!n[0].contentType&&t.ListData&&t.ListData.ContentType&&(n[0].contentType=t.ListData.ContentType,oe||n[0].contentTypeId||(n[0].contentTypeId=t.ListData.ContentTypeId)),t.ListDataLite=t.ListData,t.ListData=t.Data,t.Data=void 0,t}return null},"GetItemDataForClientForm",function(){return""},"POST",r._getAdditionalHeaders()).then(function(e){var o;if(!i&&r.isFeatureEnabled(ie)&&r._pageContext.isLabelIRMEnabled)null===(o=r._sensitivityLabelsDataSource)||void 0===o||o.getDocLibSensitivityLabelsCached().then(function(o){r._sensitivityLabelOptions=K.e.processLabelsForItem(o);var s=r._processGetClientFormServerData(e,t,n,i);a(s)}).catch(function(o){ce||(r._sensitivityLabelOptions=[]);var s=r._processGetClientFormServerData(e,t,n,i);a(s)});else{var s=r._processGetClientFormServerData(e,t,n,i);a(s)}},function(e){var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1;o({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})})},t.prototype.updatePanelViewInfo=function(e){var t=this;return new a.n(function(n,a){t.getData(function(){var n=d.e.encodeRestUriStringToken(t._listContext.listUrl);return"".concat(t._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/contentTypes('".concat(e.contentTypeId,"')")+"/ReorderFields()"+"?@v1='".concat(n,"'")},function(){return null},"CustomPanelSaveDataToServer",function(){return JSON.stringify({fieldNames:e.data})}).then(function(){n(e.serverResponse({message:{value:"updated Information"}}))},function(t){a(e.serverResponse(t))})})},t.prototype.saveCustomShowHideRules=function(e,t,n){var a=this,i={__metadata:{type:"SP.Field"},ClientValidationFormula:e.rules,ClientValidationMessage:e.errMsg};return this.getData(function(){return a._getListApiUrl(t).segment("Fields").method("GetByInternalNameOrTitle",n).toString()},function(e){return e},"saveCustomValidationRules",function(){return JSON.stringify(i)},"MERGE")},t.prototype._isFieldRequireUniqueValue=function(e){var t=e.FieldType.toLowerCase(),n=e.Name;return"file"===t||"attachments"===t||"Title"===n||"LinkTitle"===n||"LinkTitleNoMenu"===n||"thumbnail"===t},t.prototype._getListApiUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:e||this._pageContext.listUrl,listUrl:e||this._pageContext.listUrl});return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl)},t.prototype.saveClientFormCustomFormatter=function(e,t){var n=this,a={__metadata:{type:"SP.ContentType"},ClientFormCustomFormatter:JSON.stringify(e.ClientFormCustomFormatterJson)};return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e.ContentTypeId+"')").toString()},function(e){return e},"saveCustomFormFormatterJSON",function(){return JSON.stringify(a)},"MERGE")},t.prototype.getClientFormCustomFormatter=function(e,t){var n=this;return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e+"')").toString()},function(e){return e},"GetCustomFormatter",null,"GET")},t.prototype.getResourceProviders=function(){return{ComplianceTagProvider:this._complianceTagProvider,FileUploaderProvider:this._fileUploaderProvider}},t.prototype._processGetClientFormServerData=function(e,t,n,a){var i=this,r=new w({listContext:this._listContext,pageContext:this._pageContext}).processData("parent",e),o=r&&r.items&&r.items[0];this._clientForms={};var d=e.ListSchema,l=e.ItemContentTypeId,u=oe?e.ItemContentTypeName:e.ItemContentTypeName||e.ItemContentType,f=e.ClientFormCustomFormatter;f&&(this._ctIdToClientFormCustomFormatter=f),d&&(d.New&&this._processClientFormResponse(_.e.newItem,d.New,l,u),d.Edit&&(this._processClientFormResponse(_.e.editItem,d.Edit,l,u),this._processClientFormResponse(_.e.displayItem,d.Edit,l,u)));var p=this._locateClientFormWithContentTypeInfos(t,n);if(a&&p&&p.fields){var m=p.fields.filter(function(e){return!i._isFieldRequireUniqueValue(e)});p=Object(c.__assign)(Object(c.__assign)({},p),{fields:m})}var h={item:o,formType:p.formType,contentType:p.contentType,contentTypeId:p.contentTypeId,fields:[],isBulkEdit:a,clientFormCustomFormatter:p.clientFormCustomFormatter};this._generateFieldsFromSchema(h,p);for(var b=[],g=0,v=h.fields;g<v.length;g++)(D=v[g]).state===s.t.ready&&(D.state=s.t.updating,b.push(D));t!==_.e.newItem&&this._handleServerData(h,e,{},b);for(var y=0,S=b;y<S.length;y++){var D;(D=S[y]).state=s.t.ready}return h},t.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&(this._listContext.enableAttachments||void 0===this._listContext.enableAttachments),a=0,i=t.fields.length;a<i;a++){var r=t.fields[a];("Attachments"!==r.Type||n)&&(!e.isBulkEdit||!r.ReadOnlyField)&&e.fields.push(this._generateField(e,r))}if(!e.isBulkEdit&&this.isFeatureEnabled(ie)&&this._pageContext.isLabelIRMEnabled&&this._sensitivityLabelOptions){var o=this._generateSensitivityLabelField(this._sensitivityLabelOptions);e.fields.push(this._generateField(e,o))}},t.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:s.t.ready}},t.prototype._generateSensitivityLabelField=function(e){return{Id:"sensitivitylabel",Name:"Sensitivity",Type:"SensitivityLabel",Hidden:!1,InternalName:"sensitivitylabel",Title:"Sensitivity",SensitivityLabelOptions:e,FieldType:"sensitivitylabel"}},t.prototype.updateFormValues=function(e,t){var n=this,i=e.item;if(!i||!i.properties||!i.properties.ID)return a.n.wrap();for(var r=[],o=0,c=e.fields;o<c.length;o++){var l=c[o];l.state===s.t.ready&&(l.state=s.t.updating,r.push(l))}return this.getData(function(){var e=i.properties.ID,t=d.e.encodeRestUriStringToken(n._listContext.listUrl),a=new P.t(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0",r=",cutoffVersion=".concat(a);return"".concat(n._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/RenderExtendedListFormData(itemId=".concat(e,",formId='editform',mode='2',options=").concat(15).concat(r,")")+"?@v1='".concat(t,"'")},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData)return JSON.parse(t.d.RenderExtendedListFormData)}return null},"GetItemDataForClientForm",function(){return""},"POST",this._getAdditionalHeaders(),"",0,!0).then(function(a){n._handleServerData(e,a,t,r);for(var i=0,o=r;i<o.length;i++)o[i].state=s.t.ready},function(e){for(var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1,i=0,o=r;i<o.length;i++)o[i].state=s.t.ready;return a.n.wrapError({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})},t.prototype.createItem=function(e){var t=this,n=this._getUrlInfo(),i=n.listUrl,r=n.itemUrlParts,o="AddValidateUpdateItemUsingPath",s=function(){return t._apiUrlHelper.build().webByItemUrl(r).method("GetList",i).method(o).toString()},c=!!e.clientForm.contentTypeId&&0===e.clientForm.contentTypeId.lastIndexOf(q,0),d=function(t){var n=e.rootFolder||i;return JSON.stringify({listItemCreateInfo:{__metadata:{type:"SP.ListItemCreationInformationUsingPath"},FolderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:n},UnderlyingObjectType:c?"1":void 0},formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment})};return this._ensureClientForms().then(function(){return t.isFeatureEnabled(ee)?t._doCreateItem(s,d,e,o):t._fileUploaderProvider&&t._fileUploaderProvider.hasPendingImageOperations()?t._updateImages(!0).then(function(n){var i=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});return t.handleFileUploaderErrors(n,null,i)?(n&&n.length>0&&n.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n){var a=Object(z.e)(n.data);a&&(a.serverRelativeUrl=t.image.serverRelativeUrl,a.id=t.image.id,a.serverUrl=t.image.serverUrl);try{n.data=JSON.stringify(a)}catch(e){n.data=""}}}}),t._doCreateItem(s,d,e,o)):a.n.wrap({status:m.e.fail})}):t._doCreateItem(s,d,e,o)})},t.prototype._doCreateItem=function(e,t,n,a){var i=this;return this._createOrUpdateItem(te,e,t,n,a).then(function(e){return i._postUpdateFields(te,n,[]).then(function(t){return e.status===m.e.success&&t.status===m.e.fail?(t.status=m.e.partialSuccess,t):e})})},t.prototype.updateItem=function(e){var t=this,n=e.clientForm.isBulkEdit&&e.itemdIds&&e.itemdIds.length>1?e.itemdIds:void 0,i=n&&n.length>1,r=function(e){var n=t._getUrlInfo(),a=n.listUrl,r=n.itemUrlParts;return i?t._apiUrlHelper.build().webByItemUrl(r).method("GetList",a).method("BulkValidateUpdateListItems").toString():t._apiUrlHelper.build().webByItemUrl(r).method("GetList",a).method("items",e.properties.ID).method("ValidateUpdateListItem").toString()},o=function(a){var r,o;i&&(o=t._listContext.folderPath);var s=null===(r=t._getSharedLockId)||void 0===r?void 0:r.call(t);return JSON.stringify(Object(c.__assign)({itemIds:n,formValues:a,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment,folderPath:o},s?{sharedLockId:s}:{}))};return this._ensureClientForms().then(function(){return t.isFeatureEnabled(ee)?t._doUpdateItem(r,o,e,i,n):t._fileUploaderProvider&&t._fileUploaderProvider.hasPendingImageOperations()?t._updateImages(!1).then(function(s){var c=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});return t.handleFileUploaderErrors(s,null,c)?(s&&s.length>0&&s.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n&&n.data!==n.serverData){var a=Object(z.e)(n.data);a&&(a.serverRelativeUrl=t.image.serverRelativeUrl,a.id=t.image.id,a.serverUrl=t.image.serverUrl),n.data=a?JSON.stringify(a):""}}}),t._doUpdateItem(r,o,e,i,n)):a.n.wrap({status:m.e.fail})}):t._doUpdateItem(r,o,e,i,n)})},t.prototype._doUpdateItem=function(e,t,n,a,i){var r=this;return this._createOrUpdateItem(ne,e,t,n,a?"BulkValidateUpdateListItems":"ValidateUpdateListItem",i).then(function(e){return r._postUpdateFields(ne,n,i).then(function(t){return e.status===m.e.success&&t.status===m.e.fail?(t.status=m.e.partialSuccess,t):e})})},t.prototype.fetchAllClientFormSchemas=function(){var e=this;return this._clientFormsDebouncer||(this._clientFormsDebouncer=new l.e),this._clientFormsDebouncer.isExecuting()||(this._clientFormsPromise=this._clientFormsDebouncer.debounce(this.getData(function(){return e._getServerConnectionUrl().toString()},function(t){e._clientForms={};var n=JSON.parse(t);n.ContentTypeIdToNameMap&&(e._contentTypeIdToNameMap=n.ContentTypeIdToNameMap),n.ClientFormCustomFormatter&&(e._ctIdToClientFormCustomFormatter=n.ClientFormCustomFormatter);var a=n.ClientForms;a&&(a.New&&e._processClientFormResponse(_.e.newItem,a.New),a.Edit&&(e._processClientFormResponse(_.e.editItem,a.Edit),e._processClientFormResponse(_.e.displayItem,a.Edit))),n.Navigation&&(e._listContext.leftNavigationData={quickLaunchNodes:n.Navigation.Nodes}),e._listContext.enableAttachments="true"===n.EnableAttachments,n.FormRenderModes&&e._processFormRenderMode(n.FormRenderModes),(n.PowerAppFormId||n.AppId)&&(e._powerAppFormId=n.PowerAppFormId||n.AppId),n.AppRenderInfo&&(e._powerAppFormInfo=n.AppRenderInfo||{}),n.AppAdditionalData&&(e._powerAppAdditionalData=n.AppAdditionalData),n.CachedFileUrlTemplate&&n.CacheAppFiles&&(e._powerAppFormCacheInfo=JSON.stringify({appFiles:n.CacheAppFiles,cachedFileUrlTemplate:n.CachedFileUrlTemplate}))},"GetClientForms",function(){return e._getAdditionalPostData({needsSchema:!1,viewXml:'<View><ViewFields><FieldRef Name="ID"/></ViewFields></View>',needsForms:!0,needsQuickLaunch:!1})},"POST",this._getAdditionalHeaders()))),this._clientFormsPromise},t.prototype.getFieldFilterData=function(e,t,n){return new S.e({parentKey:void 0,listContext:this._listContext,pageContext:this._pageContext,folderPath:n,itemUrlHelper:this._itemUrlHelper,apiUrlHelper:this._apiUrlHelper}).getFilterData(e,"",t,void 0)},t.prototype.getContentTypes=function(e){var t=[];if(this._clientForms&&this._clientForms[e])for(var n in this._clientForms[e])this._clientForms[e].hasOwnProperty(n)&&t.push({displayName:n,description:n,templateUrl:null});return t},t.prototype.hasFormRenderMode=function(e){var t=this;return this._ensureClientForms(function(){return t._checkRenderModes(e)})},t.prototype.getFormRenderMode=function(e,t){var n=this;return this._ensureClientForms(function(){return n._getFormRenderMode(e,t)})},t.prototype.getPowerAppFormId=function(){return this._powerAppFormId},t.prototype.getPowerAppRenderInfo=function(){return this._powerAppFormInfo},t.prototype.getPowerAppAdditionalData=function(){return this._powerAppAdditionalData},t.prototype.getPowerAppFormCacheInfo=function(){return this._powerAppFormCacheInfo},t.prototype.getPowerAppFormDesignUrl=function(e){var t=this;return this.getData(function(){return"".concat(t._pageContext.webAbsoluteUrl,"/_api/SP.Internal.FormsCustomization.GetPowerAppsFormDesignUrl?listName='")+e+"'&visualizationTarget="+k.e.browser},function(e){var t=JSON.parse(e),n="";return t.d&&t.d.Value&&(n=JSON.parse(t.d.Value)),n},"GetPowerAppFormDesignUrl",null,"GET")},t.prototype._getServerConnectionUrl=function(e){var t=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return b.t({webUrl:this._pageContext.webAbsoluteUrl,listId:this._listContext.listId,urlParts:t,rootFolder:this._listContext.folderPath,requestToken:"?"})},t.prototype._processClientFormResponse=function(e,t,n,a){this._clientForms[e]||(this._clientForms[e]={});var i=this._clientForms[e];for(var r in t)if(t.hasOwnProperty(r)&&!i[r]){var o;o=re||r!==a?this._reverseLookupContentTypeIdByName(r):n;var c=this._ctIdToClientFormCustomFormatter?this._ctIdToClientFormCustomFormatter[o]:void 0;i[r]={contentType:r,contentTypeId:o,formType:e,fields:[],clientFormCustomFormatter:c?JSON.parse(c):void 0,mode:s.n.Unknown};for(var d=i[r],l=t[r],u=0,f=l.length;u<f;u++)d.fields.push(l[u])}this._clientForms[e]=i},t.prototype._reverseLookupContentTypeIdByName=function(e){for(var t in this._contentTypeIdToNameMap)if(e===this._contentTypeIdToNameMap[t])return t;return null},t.prototype._processFormRenderMode=function(e){if(e)for(var t in e)for(var n in e[t]){var a=_.e.newItem;switch(n){case"Edit":a=_.e.editItem;break;case"Display":a=_.e.displayItem}var i=s.n.Unknown;switch(e[t][n].RenderType){case 1:i=s.n.Classic;break;case 2:i=s.n.Modern;break;case 3:i=s.n.PowerApp;break;case 4:i=s.n.Customized;break;default:u.e.logData({name:"ClientFormDataSource.InvalidFormRenderMode",message:"Server returned RenderType="+e[t][n].RenderType})}this._clientForms[a][t].mode=i}},t.prototype._locateClientFormWithContentTypeInfos=function(e,t){if(!t||!t.length)return this._locateClientForm(e,void 0,void 0);var n=t[0],a=this._locateClientForm(e,n.contentType,n.contentTypeId);if(1===t.length||!a||!a.fields)return a;for(var i=a.fields.slice(),r=function(n){if(0===i.length)return"break";var a=t[n],r=o._locateClientForm(e,a.contentType,a.contentTypeId);i=i.filter(function(e){for(var t=0,n=r.fields;t<n.length;t++)if(n[t].Name===e.Name)return!0;return!1})},o=this,s=1;s<t.length&&"break"!==r(s);s++);return Object(c.__assign)(Object(c.__assign)({},a),{fields:i})},t.prototype._locateClientForm=function(e,t,n){if(!t&&n&&this._contentTypeIdToNameMap&&(t=this._contentTypeIdToNameMap[n]),!t&&this._clientForms[e])for(var a in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(a)){t=a;break}if(n&&0===n.lastIndexOf(q,0)&&this._clientForms[e]&&!this._clientForms[e][t]){var i={FileLeafRef:1,Title:1,URL:1};for(var a in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(a)){var r=this._clientForms[e][a].fields.filter(function(e){return!!i[e.Name]})[0];if(r)return this._clientForms[e].Folder={contentType:"Folder",contentTypeId:n,formType:e,fields:[r],mode:s.n.Unknown},this._clientForms[e].Folder}}if(!this._clientForms[e]||!this._clientForms[e][t]){if("folder"===t.toLowerCase()&&!n)for(var a in this._clientForms[e])if(this._clientForms[e][a]&&!this._clientForms[e][a].contentTypeId)return this._clientForms[e][a];return null}return this._clientForms[e][t]},t.prototype._getAdditionalHeaders=function(e,t){var n=b.a(this._listContext);return this.isFeatureEnabled($)&&n&&e&&(e===_.e.newItem?(n.Scenario="CreateListItem",n.ScenarioType="AUO"):e===_.e.editItem&&(n.Scenario="EditListItem",n.ScenarioType="AUO")),t&&(n.nucleusRedirection="false"),n},t.prototype._handleServerData=function(e,t,n,a){var i=t.ListDataLite?t.ListDataLite:t.ListData,r=t.ListDataLite?t.ListData.Row[0]:t.Data.Row[0],o=e.item;this._ctIdToClientFormCustomFormatter=t.ClientFormCustomFormatter,this.isFeatureEnabled(ie)&&this._pageContext.isLabelIRMEnabled&&(e.sensitivityLabel=t.ListData.Row&&t.ListData.Row[0]&&t.ListData.Row[0]._DisplayName);for(var s=0,c=a.length;s<c;s++){var d=a[s],l=d.schema;if(!n||!n.hasOwnProperty(l.Name)){if(void 0===d.data&&(d.data=null),void 0===d.serverData&&(d.serverData=null),i.hasOwnProperty(l.Name)){if(l.FieldType&&"boolean"===l.FieldType.toLowerCase()&&""===r[l.Name]&&"0"===i[l.Name]?d.serverData="":l.FieldType&&"thumbnail"===l.FieldType.toLowerCase()&&r[l.Name]?d.serverData=r[l.Name]:d.serverData=i[l.Name],o.hasOwnProperty(l.Name)||o.properties.hasOwnProperty(l.Name)||(o.properties[l.Name]=r[l.Name]),this.isFeatureEnabled(Z)&&(o.properties.hasOwnProperty("ItemExpirationDate")||(o.properties.ItemExpirationDate=r._ExpirationDate),!o.properties.hasOwnProperty("IsItemExpirationModifiable"))){var u=r.MetaInfo,f=u&&u[0]&&u[0].lookupValue||"",p=new RegExp(/vti_stream_isexpirationmodifiable:([a-zA-Z]{2})\|false/gi).test(f);o.properties.IsItemExpirationModifiable=!p}}else L.r(d)?(d.serverData=r[L.t],o.hasOwnProperty(l.Name)||o.properties.hasOwnProperty(l.Name)||(o.properties[l.Name]=r[l.Name])):o.folder&&d.schema.FieldType&&"file"===d.schema.FieldType.toLowerCase()&&d.schema.Title&&"name"===d.schema.Title.toLowerCase()&&i.Title?d.serverData=i.Title:l.FieldType&&"sensitivitylabel"===l.FieldType?d.serverData=e.sensitivityLabel:d.serverData=null;e.isBulkEdit&&(d.serverData=null),d.schema.AppendOnly?(d.appendOnlyData=t[d.schema.Name],d.data=""):d.schema.SensitivityLabelOptions?d.data="":d.data=d.serverData}}o.hasClientFormData=!0},t.prototype._createOrUpdateItem=function(e,t,n,i,r,o){var c=this,d=i.clientForm.fields,l=[],u=[],f={},p=[],h=!1,b=!1;i.clientForm.formType===_.e.editItem&&i.clientForm.item&&!i.clientForm.isBulkEdit&&this._listContext&&!this._listContext.isDocLib&&i.clientForm.item.properties&&"1"===i.clientForm.item.properties.FSObjType&&(b=!0),this.isFeatureEnabled(X)&&(o?F(i.clientForm,o.length):F(i.clientForm));for(var g=void 0,v=!1,S=!1,D=0,I=d;D<I.length;D++){var x=I[D];if(this.isFeatureEnabled(ee)&&"thumbnail"===x.schema.FieldType.toLowerCase()&&(se||this._fileUploaderProvider&&this._fileUploaderProvider.hasPendingAttachmentOperations())&&(S=!0),null!==x.data&&void 0!==x.data){var C=x.data;if("thumbnail"===x.schema.FieldType.toLowerCase()){if(this.isFeatureEnabled(ee))continue;if("string"!=typeof C)try{C=JSON.stringify(C)}catch(e){}}if(!this._isClientFormFieldUpdated(i,C,x.serverData,x)||"attachments"===x.schema.FieldType.toLowerCase()||"sensitivitylabel"===x.schema.FieldType||L.r(x)||L.o(x))f[x.schema.Name]=!0,ae||g||!this._isEventField(x)||(g=x);else{l.push(x);var O=x.schema.Name;"ContentType"===O&&(C=this._reverseLookupContentTypeIdByName(C.displayName),O="ContentTypeId",h=!0),u.push({FieldName:O,FieldValue:C,HasException:!1,ErrorMessage:null}),ae||v||!this._isEventField(x)||(v=!0),"Title"===O&&b&&u.push({FieldName:"FileLeafRef",FieldValue:C,HasException:!1,ErrorMessage:null});var w=x.schema.FieldType.toLowerCase();M.e.logData({name:"ClientFormUpdate",extraData:{FieldType:w,Host:Object(B.e)()}})}}}if(!ae&&v&&g&&u.push({FieldName:g.schema.Name,FieldValue:g.data,HasException:!1,ErrorMessage:null}),h?4096==(4096&this._listContext.flags2)&&u.push({FieldName:"PrimeCorrectedByUser",FieldValue:"true",HasException:!1,ErrorMessage:null}):i.clientForm.formType===_.e.newItem?u.push({FieldName:"ContentType",FieldValue:i.clientForm.contentType,HasException:!1,ErrorMessage:null}):i.clientForm.formType===_.e.editItem&&i.clientForm.item&&i.clientForm.item.properties&&!i.clientForm.isBulkEdit&&u.push({FieldName:"ContentTypeId",FieldValue:i.clientForm.item.properties.ContentTypeId,HasException:!1,ErrorMessage:null}),0===l.length&&0===p.length)return a.n.wrap({status:m.e.success});var E=!1;return this.isFeatureEnabled(ee)&&i.clientForm.formType===_.e.newItem&&S&&(E=!0),p.push(this._getUpdateItemPromise(e,t,n,i,r,l,u,i.clientForm.item,o,E)),a.n.all(p).then(function(e){for(var t={status:m.e.success},n=0,a=e;n<a.length;n++){var i=a[n];i&&i.hasOwnProperty("status")&&(t.status=i.status,i.failedItemIds&&(t.failedItemIds=i.failedItemIds));break}return t},function(e){var t,n;if((e=Array.isArray(e)?e:[e])&&e[0]&&e[0].code){var a=e[0].code.split(", ");a&&2===a.length&&(t=a[0],n=a[1])}for(var r="-2146232832"===t&&"Microsoft.SharePoint.SPFieldValidationException"===n,o=0;o<l.length;o++){var d=l[o];d.hasException=0===o||r,d.state=s.t.ready}var u=Object(y.s)(c._pageContext)+i.clientForm.item.properties.FileRef;throw e.filter(function(e){return e&&e.message&&e.message.value}).map(function(e){return e.message.value=e.message.value.replace('"'.concat(u,'" '),""),e})})},t.prototype._isEventField=function(e){var t,n,a=null===(n=null===(t=e.schema)||void 0===t?void 0:t.Id)||void 0===n?void 0:n.toLowerCase();return"64cd368d-2f95-4bfc-a1f9-8d4324ecb007"===a||"2684f9f2-54be-429f-ba06-76754fc056bf"===a},t.prototype._getUpdateItemPromise=function(e,t,n,i,r,o,c,d,l,u){var f=this;return c&&0!==c.length&&o&&0!==o.length?this.getData(t.bind(null,d),function(e){var t=JSON.parse(e);if(!t.d||!t.d[r]||!t.d[r].results){for(var n=0,c=o;n<c.length;n++)(L=c[n]).state=s.t.ready;return a.n.wrapError("The server response couldn't be processed")}for(var u=null,p={},h="",b=0,g=t.d[r].results;b<g.length;b++){var v=g[b];if(i.clientForm.formType===_.e.newItem&&"Id"===v.FieldName){var y=d;y.properties||(y.properties={}),y.properties.ID=v.FieldValue}if(!0===v.HasException||null!==v.ErrorMessage){var S=v.FieldName;if(p[S]||(p[S]=[]),void 0!==v.ItemId&&p[S].indexOf(v.ItemId)<0&&p[S].push(v.ItemId),!u){u={};for(var D=0,I=i.clientForm.fields;D<I.length;D++){var x=I[D];u[x.schema.Name]=x}}if(u[S]){u[S].errorMessage=v.ErrorMessage,u[S].hasException=!0;var C=u[S].schema.Title;h=h?h+", "+C:C}}}var O={status:h?m.e.fail:m.e.success};if(l&&l.length&&p.null){var w=p.null;w.length<l.length?O.status=m.e.partialSuccess:O.status=m.e.fail,O.failedItemIds=w}for(var E=0,A=o;E<A.length;E++){var L=A[E];h?!p[L.schema.Name]&&i.isInteractiveSave&&(L.errorMessage="Cannot save due to errors in other fields: "+h,L.hasException=!0):(L.errorMessage="",L.hasException=!1),L.state=s.t.ready}return f._raiseCreateOrUpdateEvents(i,O),O},e,function(){return n(c)},"POST",this._getAdditionalHeaders(i.clientForm.formType,u),void 0,5):a.n.wrap()},t.prototype._getUrlInfo=function(){var e=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return{listUrl:e&&e.serverRelativeListUrl?e.serverRelativeListUrl:this._listContext.listUrl,itemUrlParts:e}},t.prototype._isClientFormFieldUpdated=function(e,t,n,a){return!(e.clientForm.isBulkEdit&&""===t&&null===n||a.schema.AppendOnly&&!t&&!Object(O.i)(this._pageContext.listBaseTemplate)||("thumbnail"===a.schema.FieldType.toLowerCase()?a.data.fileName&&n.fileName&&a.data.serverRelativeUrl===n.serverRelativeUrl:f.e(t,n)))},t.prototype._postUpdateFields=function(e,t,n){var i=this,r=t.clientForm,o=r.item;if(!this.isValidItem(o))return a.n.wrap({status:m.e.fail});for(var s=this._itemUrlHelper.getItemUrlParts(o.key).serverRelativeListUrl,c=n&&n.length>1,d=[],l=null,u=null,f=[],p=0;p<r.fields.length;p++){var _=r.fields[p];if(L.r(_)){if(!c&&_.data===_.serverData)continue;if(c){var h=this._updateMultipleComplianceTagsPromises(n,_,s);if(h)for(var b=0,g=h;b<g.length;b++){var v=g[b];d.push(v)}}else d.push(this._updateComplianceTagField(_,o));M.e.logData({name:"ClientFormUpdate."+_.schema.FieldType.toLowerCase()})}else if(L.o(_)){if(!this.isFeatureEnabled(J)||_.data===_.serverData)continue;var y=L.s(o.properties[L.e]);if(y===("1"===_.data)||c)continue;d.push(this._updateUnlockRecordField(o,_,s,y)),M.e.logData({name:"ClientFormUpdate."+_.schema.FieldType.toLowerCase()})}else if("attachments"===_.schema.FieldType.toLowerCase())l=_;else if("sensitivitylabel"===_.schema.InternalName)u=_;else if("thumbnail"===_.schema.FieldType.toLowerCase()){if(!_.data&&!_.serverData)continue;if(_.data&&_.serverData&&_.data.serverRelativeUrl===_.serverData.serverRelativeUrl)continue;f.push(_)}}if(this.isFeatureEnabled(ie)&&this._pageContext.isLabelIRMEnabled&&u){var S=t.graph,D=null==S?void 0:S.driveId,I=null==S?void 0:S.itemId,x=this._getCurrentSensitivityLabelTitle(this._sensitivityLabelOptions,u.data);u.data!==x&&D&&I&&(M.e.logData({name:"ClientFormSensitivityLabelUpdate",extraData:{Host:Object(B.e)()}}),d.push(a.n.resolve(this._sensitivityLabelsDataSource.setSensitivityLabel(D,I,u.data,u.justificationText).then(function(e){return r.sensitivityLabel=x,{status:m.e.success}},function(e){var t=e.message;return e.innerError&&(t=t+"."+e.innerError.message),u.errorMessage=t,{status:m.e.fail}}))))}return n&&0!==n.length||(d.push(this._updateAttachmentsField(l,o,e)),this.isFeatureEnabled(ee)&&d.push(this._updateThumbnailFields(f,o,e===te))),a.n.all(d).then(function(e){var t;f.length>0&&i._pageContext.dataSyncClient&&i._pageContext.listId&&i._pageContext.siteId&&i._pageContext.dataSyncClient.then(function(e){e&&e.triggerListSyncNowForCurrentUser({listId:Object(W.normalizeLower)(i._pageContext.listId,!1),siteId:Object(W.normalizeLower)(i._pageContext.siteId,!1)})});for(var n={status:m.e.success},a=0,r=e;a<r.length;a++){var o=r[a];o&&o.status===m.e.fail&&(n.status=o.status),o&&o.failedItemIds&&o.failedItemIds.length>0&&(t=n.failedItemIds).push.apply(t,o.failedItemIds)}return n})},t.prototype._getCurrentSensitivityLabelTitle=function(e,t){for(var n=0;n<e.length;n++)if(e[n].id===t)return e[n].text;return""},t.prototype._updateComplianceTagField=function(e,t){var n,i=e.schema;return i.ComplianceTags&&(n=i.ComplianceTags.filter(function(t){return t&&t.tagValue===e.data})[0]),n?(e.state=s.t.saving,this._complianceTagProvider.updateComplianceTag(t,n).then(function(){return e.state=s.t.ready,{status:m.e.success}},function(t){return t&&e&&(e.errorMessage=t.message&&t.message.value?t.message.value:t,e.hasException=!0),e.state=s.t.ready,{status:m.e.fail}})):a.n.wrap(null)},t.prototype._updateMultipleComplianceTagsPromises=function(e,t,n){var a,i=t.schema,r=[];if(i.ComplianceTags&&(a=i.ComplianceTags.filter(function(e){return e&&e.tagValue===t.data})[0]),!a)return r;t.state=s.t.saving;for(var o=[],c=0,d=0,l=e.length;d<l;d++)o.push(e[d]),++c!==L.n&&d!==e.length-1||(r.push(this._complianceTagProvider.updateComplianceTagInBatch(o,a,n).then(function(e){return t.state=s.t.ready,e&&e.length>0?{status:m.e.fail,failedItemIds:e}:{status:m.e.success}},function(e){return e&&t&&(t.errorMessage=e.message&&e.message.value?e.message.value:e,t.hasException=!0),t.state=s.t.ready,{status:m.e.fail,failedItemIds:o}})),o=[],c=0);return r},t.prototype._updateUnlockRecordField=function(e,t,n,a){var i="1"===t.data;return t.state=s.t.saving,i?this._complianceTagProvider.unlockRecord(e,n).then(function(e){return t.serverData=e?"1":"0",t.state=s.t.ready,{status:m.e.success}},function(e){return e&&t&&(t.serverData=a?"1":"0",t.data="0",t.errorMessage=e.message&&e.message.value?e.message.value:e,t.hasException=!0),t.state=s.t.ready,{status:m.e.fail}}):this._complianceTagProvider.lockRecord(e,n).then(function(e){return t.serverData=e?"1":"0",t.state=s.t.ready,{status:m.e.success}},function(e){return e&&t&&(t.serverData=a?"1":"0",t.data="1",t.errorMessage=e.message&&e.message.value?e.message.value:e,t.hasException=!0),t.state=s.t.ready,{status:m.e.fail}})},t.prototype._updateAttachmentsField=function(e,t,n){var i=this;return this._fileUploaderProvider&&this._fileUploaderProvider.hasPendingAttachmentOperations()?(e.state=s.t.saving,this._fileUploaderProvider.executeAttachmentOperations(n===te&&t&&t.properties?Number(t.properties.ID):void 0).then(function(t){return i._fileUploaderProvider.clearAttachmentOperations(),{status:i.handleFileUploaderErrors(t,e,[])?m.e.success:m.e.fail}},function(t){return i._fileUploaderProvider.clearAttachmentOperations(),{status:i.handleFileUploaderErrors(t,e,[])?m.e.success:m.e.fail}})):a.n.wrap(null)},t.prototype.isValidItem=function(e){return e&&e.properties&&e.properties.ID&&"0"!==e.properties.ID},t.prototype.handleFileUploaderErrors=function(e,t,n){var a={attachments:[]},i=!0;if(e.forEach(function(e){e.result||(e.attachment&&a.attachments.push(e.errorMsg),e.image&&(a[e.image.fieldName]=e.errorMsg),i=!1)}),t){if(a.attachments.length>0){var r=a.attachments.reduce(function(e,t){return e+(e?"\r\n":"")+t+"\r\n"},"");t.errorMessage=r,t.hasException=!0}t.state=s.t.ready,M.e.logData({name:"ClientFormUpdate."+t.schema.FieldType.toLowerCase()})}return n.forEach(function(e){a[e.schema.Name]&&(e.errorMessage=a[e.schema.Name],e.hasException=!0),e.state=s.t.ready,M.e.logData({name:"ClientFormUpdate."+e.schema.FieldType.toLowerCase()})}),i},t.prototype._ensureClientForms=function(e){return this._clientForms&&this._contentTypeIdToNameMap&&!this._listContext.refreshClientForm?e?a.n.wrap(e()):a.n.wrap():(this._listContext.refreshClientForm=void 0,e?this.fetchAllClientFormSchemas().then(e):this.fetchAllClientFormSchemas().then(function(){return a.n.wrap()}))},t.prototype._checkRenderModes=function(e){for(var t in this._clientForms)for(var n in this._clientForms[t])if(this._clientForms[t][n].mode===e)return!0;return!1},t.prototype._getFormRenderMode=function(e,t){var n=this._contentTypeIdToNameMap[t],a=this._clientForms[e][n];return a?a.mode:this._checkRenderModes(s.n.PowerApp)?s.n.PowerApp:s.n.Unknown},t.prototype._raiseCreateOrUpdateEvents=function(e,t){var n=e.clientForm;if(t&&t.status===m.e.success&&n){var a=n.item&&n.item.properties&&n.item.properties.ID?n.item.properties.ID:void 0,i=e.itemdIds&&e.itemdIds.length?e.itemdIds.map(String):a?[a]:void 0;i&&j.t.raise(window,n.formType===_.e.newItem?V.e.newItemCreated:V.e.itemUpdated,{itemIds:i})}},t.prototype._updateImages=function(e){return this._fileUploaderProvider&&this._fileUploaderProvider.hasPendingImageOperations()?this._fileUploaderProvider.executeImageOperationsOnSingleItem(e?0:void 0,void 0,e):a.n.wrap([])},t.prototype._updateThumbnailFields=function(e,t,n){var i=this;return this._fileUploaderProvider&&this._fileUploaderProvider.hasPendingImageOperations()?this._fileUploaderProvider.executeImageOperationsOnSingleItem(Number(t.properties.ID),void 0,n).then(function(t){return{status:i.handleFileUploaderErrors(t,null,e)?m.e.success:m.e.fail}},function(t){return{status:i.handleFileUploaderErrors(t,null,e)?m.e.success:m.e.fail}}):a.n.resolve()},t}(p.t),le="Folder",ue={ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1},fe=function(){function e(e,t){var n=this;this._buffer=[],this._bufferSize=5,this._init=function(e,t){var a,i;t&&t.pageContext?(n._pageContext=t.pageContext,n._listContext=t.listContext,a=t.apiUrlHelper,i=t.itemUrlHelper):(n._pageContext=e.pageContext,n._listContext=e.listContext,a=e.apiUrlHelper,i=e.itemUrlHelper,n._defaultValueOverride=e.defaultValueOverride||{});var o={isFeatureEnabled:e.isFeatureEnabled,fileUploaderProvider:e.fileUploaderProvider,complianceTagProvider:e.complianceTagProvider,getSharedLockId:e.getSharedLockId},s={pageContext:n._pageContext,apiUrlHelper:a,itemUrlHelper:i,getGraphAuthToken:null==e?void 0:e.getGraphAuthToken};n._clientFormDataSource?n._clientFormDataSource.updateContext(o,s):n._clientFormDataSource=new de(o,s),n._clientFormDataSource.listContext=n._listContext,n.isFeatureEnabled=e.isFeatureEnabled?e.isFeatureEnabled:function(e){return r.n.isFeatureEnabled(e,n._pageContext&&n._pageContext.ExpFeatures)}},this._getStoredClientFormId=function(e,t,n){return e+"|"+t+"|"+n},this._getClientFormData=function(e){if(e.status===m.t.pending){var t=new o.e;return e.onFinish=function(n){n=e.status||n,t.complete(e.clientForm)},t.getPromise()}return a.n.resolve(e.clientForm)},this._init(e,t)}return e.prototype.updateContext=function(e,t){this._init(e,t)},e.prototype.getClientForm=function(e,t,n){var r,o,s=this;void 0===t&&(t=!1),void 0===n&&(n=!1),t&&(this._listContext.refreshClientForm=!0);var c,d,l=e.itemId,u=e.item;if(!l&&u){var f=this._getBufferKeyFromItem(u,e.contentType);if(c=e.isBulkEdit?void 0:this._getClientFormFromBuffer(f),u.type!==i.t.Folder||e.contentType||(e.contentType=le),c){if(u.hasClientFormData)return c.item=e.item,a.n.wrap(c);this._deleteClientFormFromBuffer(f)}}var p=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var h={},b=0,g=e.selection;b<g.length;b++){var v=g[b];if(v){var y=v.properties;if(y){var S=(x=v.type!==i.t.Folder||y.ContentType?y.ContentType:le)+(D=y.ContentTypeId);h[S]||(p.push({contentType:x,contentTypeId:D}),h[S]=!0)}}}else p.push({contentType:e.contentType,contentTypeId:e.contentTypeId});if(l){var D,I=e.isBulkEdit,x=e.contentType,C=e.clientFormType,O=(D=e.contentTypeId)&&0===D.lastIndexOf(q,0),w="Media.Meeting"===(null===(o=null===(r=null==e?void 0:e.item)||void 0===r?void 0:r.properties)||void 0===o?void 0:o.ProgId)&&n&&!I&&!O;if(this.isFeatureEnabled(ue)&&w){var E=this._getStoredClientFormId(l,x,I),A=this._getStoredClientForm(E);return A&&void 0!==A.status?this._getClientFormData(A).then(function(e){return s._deleteClientFormFromStoredClientForm(E),e}):(this._completeStoredClientForm(A,m.t.pending),this._clientFormDataSource.getClientForm(l,C,p,I).then(function(e){return s._completeStoredClientForm(A,m.t.success,e),e}))}return this._clientFormDataSource.getClientForm(l,e.clientFormType,p,e.isBulkEdit)}return this._clientFormDataSource.getClientFormSchema(e.clientFormType,p).then(function(t){if(e.item&&!e.item.properties.ContentTypeId&&(e.item.properties.ContentTypeId=t.contentTypeId,e.item.properties.ContentType=t.contentType),d={item:e.item,formType:t.formType,contentType:t.contentType,contentTypeId:t.contentTypeId,fields:[],clientFormCustomFormatter:t.clientFormCustomFormatter,isBulkEdit:e.isBulkEdit},s._generateFieldsFromSchema(d,t),e.clientFormType!==_.e.newItem)return s.updateFormValues(d)}).then(function(){return s._addClientFormToBuffer(d),a.n.wrap(d)})},e.prototype.updateFormValues=function(e,t){return this._clientFormDataSource.updateFormValues(e,t)},e.prototype.updateItem=function(t){return t.clientForm.isBulkEdit&&t.itemdIds&&(this._buffer=[],e._clientFormStore=[]),this._clientFormDataSource.updateItem(t)},e.prototype.saveCustomShowHideRules=function(e,t,n){return this._clientFormDataSource.saveCustomShowHideRules(e,t,n)},e.prototype.saveClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.saveClientFormCustomFormatter(e,t)},e.prototype.getClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.getClientFormCustomFormatter(e,t)},e.prototype.createItem=function(e){return this._clientFormDataSource.createItem(e)},e.prototype.getFieldFilterData=function(e,t,n){return this._clientFormDataSource.getFieldFilterData(e,t,n)},e.prototype.getClientFormSchema=function(e,t,n){return this._clientFormDataSource.getClientFormSchema(e,[{contentType:t,contentTypeId:n}])},e.prototype.updatePanelViewInfo=function(e){return this._clientFormDataSource.updatePanelViewInfo(e)},e.prototype.getContentTypes=function(e){return this._clientFormDataSource.getContentTypes(e)},e.prototype.getContentInfoTypes=function(e){var t=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var n={},a=0,r=e.selection;a<r.length;a++){var o=r[a];if(o){var s=o.properties;if(s){var c=o.type!==i.t.Folder||s.ContentType?s.ContentType:le,d=s.ContentTypeId,l=c+d;n[l]||(t.push({contentType:c,contentTypeId:d}),n[l]=!0)}}}else t.push({contentType:e.contentType,contentTypeId:e.contentTypeId});return t},e.prototype.hasFormRenderMode=function(e){return this._clientFormDataSource.hasFormRenderMode(e)},e.prototype.getFormRenderMode=function(e,t){return this._clientFormDataSource.getFormRenderMode(e,t)},e.prototype.getPowerAppFormId=function(){return this._clientFormDataSource.getPowerAppFormId()},e.prototype.getPowerAppRenderInfo=function(){return this._clientFormDataSource.getPowerAppRenderInfo()},e.prototype.getPowerAppAdditionalData=function(){return this._clientFormDataSource.getPowerAppAdditionalData()},e.prototype.getPowerAppFormCacheInfo=function(){return this._clientFormDataSource.getPowerAppFormCacheInfo()},e.prototype.getPowerAppFormDesignUrl=function(e){return this._clientFormDataSource.getPowerAppFormDesignUrl(e)},e.prototype.fetchAllClientFormSchemas=function(){return this._clientFormDataSource.fetchAllClientFormSchemas()},e.prototype.clearBuffer=function(){this._buffer=[]},e.prototype.updateListContext=function(e){this._listContext=e,this._clientFormDataSource.listContext=e},e.prototype.getResourceProviders=function(){return this._clientFormDataSource.getResourceProviders()},e.prototype.updateDefaultValueOverride=function(e){this._defaultValueOverride=e},e.prototype.clearStoreClientForm=function(){e._clientFormStore=[]},e.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&this._listContext.enableAttachments,a=0,i=t.fields.length;a<i;a++){var r=t.fields[a];void 0!==this._defaultValueOverride[r.InternalName]&&(r.DefaultValue=this._defaultValueOverride[r.InternalName],r.DefaultValueFormatted="",r.DefaultValueTyped=""),("Attachments"!==r.Type||n)&&(!e.isBulkEdit||!r.ReadOnlyField)&&e.fields.push(this._generateField(e,r))}},e.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:s.t.ready}},e.prototype._getBufferKeyFromItem=function(e,t){return e.properties.ID+e.name+"|"+t},e.prototype._getClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){var a=this._buffer[t].key;if(a===e){if(0===t)return this._buffer[t].form;var i=this._buffer[t].form;return this._buffer.splice(t,1),this._buffer.unshift({key:a,form:i}),i}}return null},e.prototype._addClientFormToBuffer=function(e){if(!e.isBulkEdit){var t=e.item;t&&void 0!==t.properties.ID&&this._buffer.unshift({key:this._getBufferKeyFromItem(t,e.contentType),form:e})>this._bufferSize&&this._buffer.pop()}},e.prototype._deleteClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++)if(this._buffer[t].key===e){this._buffer.splice(t,1);break}},e.prototype._getStoredClientForm=function(t){for(var n=0;n<e._clientFormStore.length;n++)if(e._clientFormStore[n].clientFormId===t)return e._clientFormStore[n];var a={onFinish:void 0,clientFormId:t,clientForm:void 0,status:void 0};return e._clientFormStore.push(a),a},e.prototype._deleteClientFormFromStoredClientForm=function(t){for(var n=0;n<e._clientFormStore.length;n++)if(e._clientFormStore[n].clientFormId===t){e._clientFormStore.splice(n,1);break}},e.prototype._completeStoredClientForm=function(t,n,a){for(var i=0;i<e._clientFormStore.length;i++)e._clientFormStore[i].clientFormId===t.clientFormId&&(e._clientFormStore[i].status=n,a&&(e._clientFormStore[i].clientForm=a),t.onFinish&&t.onFinish(n))},e._clientFormStore=[],e}()},2823:function(e,t,n){"use strict";var a=n(2591),i=n(3158),r={id:"none",key:"none",text:i.e,title:i.e},o=function(){function e(){}return e.processSensitivityLabelsForDropdownOption=function(e){var t={};e.forEach(function(e){var n,a,i=e.name,r=null===(n=null==e?void 0:e.parent)||void 0===n?void 0:n.name;r?t[r]?null===(a=t[r])||void 0===a||a.push({name:i,id:e.id,isParent:!1,tooltip:e.tooltip}):(t[r]=[{name:r,id:"".concat(e.id,"isParent"),isParent:!0,tooltip:e.tooltip}],t[r].push({name:i,id:e.id,isParent:!1,tooltip:e.tooltip})):t[i]=[{name:i,id:e.id,isParent:!1,tooltip:e.tooltip}]});var n=[];return t&&Object.keys(t).length>0&&Object.keys(t).forEach(function(e){var i=t[e];if((null==i?void 0:i.length)>1){var r=i[0];i.forEach(function(e){var t=e.isParent?a.e.Header:a.e.Normal,i=e.isParent?e.name:"".concat(r.name," \\ ").concat(e.name);n.push({id:e.id,key:e.id,text:i,title:e.tooltip,data:{text:e.name,isParent:e.isParent},itemType:t})}),n.push({key:"divider_2",text:"-",itemType:a.e.Divider})}else n.push({id:i[0].id,key:i[0].id,text:i[0].name,title:i[0].tooltip,data:{text:i[0].name}})}),n},e.processSensLabelsForDropdownOptionDocLib=function(e){var t=[];return t.push(r),e.forEach(function(e){var n,a=e.displayName;if(0===e.sublabels.length){if(c(e.labelActions)){var i=s(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),a,e.toolTip);t.push(i)}}else e.sublabels.forEach(function(e){var n;if(c(e.labelActions)){var i="".concat(a," \\ ").concat(e.displayName),r=s(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),i,e.toolTip);t.push(r)}})}),t},e.processLabelsForItem=function(e){var t=[];return t.push(r),e.forEach(function(e){var n,a=e.displayName;if(0===e.sublabels.length){var i=c(e.labelActions),r=e.tooltip||e.toolTip;if(i){var o=s(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),a,r);t.push(o)}}else e.sublabels.forEach(function(e){var n,i=c(e.labelActions),r=e.tooltip||e.toolTip;if(i){var o="".concat(a," \\ ").concat(e.displayName),d=s(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),o,r);t.push(d)}})}),t},e}();function s(e,t,n,a){return{id:e,key:t,text:n,title:a}}function c(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if("userDefinedRights"===e[t].encryptWith)return!1;return!0}t.e=o},2824:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a,i=n(91),r=n(157),o=n(1448),s=n(1453),c=n(1048),d=n(1393),l=n(79),u=n(2507),f=n(448),p=n(155),m=n(521),_=n(285),h=n(2631),b=n(1430),g=n(15);!function(e){function t(e,t,n,a){if(e){var _=Object(h.e)(function(e){return e.id||e.FileRef||e.ServerRelativeUrl}(e),n.listUrl),b={key:_};b.id=e.id||e.FileRef,b.itemId=e["name.FileSystemItemId"];var v=e.File_x0020_Type;b.extension=v?"."+v:void 0,b.policyTip=e._ip_UnifiedCompliancePolicyUIAction?Number(e._ip_UnifiedCompliancePolicyUIAction):i.a.none,b.type=function(e,t,n){var a=p.t.File,i=e.File_x0020_Type;if("1"===e.FSObjType){var r=e["File_x0020_Type.mapapp"],o=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];a=r&&"onenote"===r.substring(0,7)||o&&-1!==o.indexOf("onenote")?p.t.OneNote:p.t.Folder}else u.e.isShortcutEnabled()&&u.e.isShortcutFileType(i)?a=p.t.Shortcut:"pdf"===i?a=p.t.Media:(a=f.i(i))===p.t.Unknown&&Object(g.o)(n.listTemplateType)&&(a=p.t.File);return".ai"!==t.extension&&".eps"!==t.extension&&".psd"!==t.extension||(a=p.t.Media),a===p.t.Folder?t.isDocSet="Sharepoint.DocumentSet"===e.ProgId:a===p.t.File&&n&&!n.isDocLib&&(t.listItem={}),a}(e,b,n),b.extension&&(b.iconName=f.a(b)),b.isRootFolder=e.isRootFolder;var y=Object(o.getItemName)(e,b.type,n);y&&(b.displayName=b.name=y),b.dateModifiedValue=e.Modified,b.dateModified=e["Modified.FriendlyDisplay"]?Object(d.e)(e["Modified.FriendlyDisplay"]):String(e.Modified),b.permissions=e.PermMask?c.e(e.PermMask):void 0,b.isPlaceholder=!e.PermMask,b.hasMissingMetadata=function(e,t){if(!t.listSchema)return!1;var n=t.listSchema.filter(function(e){return e.isRequired&&Boolean(e.name)}),a=!1;if(n&&n.length>0)for(var i in n)if(i&&!e[n[i].internalName]){a=!0;break}return a}(e,n);var S=e["serverurl.progid"];if(b.openUrl=S?S.substring(1):e.FileRef,-1!==b.openUrl.toLowerCase().indexOf("/wopiframe?")&&(b.openUrl=b.openUrl.replace(/\/_layouts\/WopiFrame.aspx\?/,"/_layouts/15/WopiFrame.aspx?")),b.previewIFrameUrl=e.ServerRedirectedEmbedUrl,b.appMap=e["File_x0020_Type.mapapp"]||e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],b.size=e.File_x0020_Size?Number(e.File_x0020_Size):void 0,b.totalSize=e.SMTotalSize?Number(e.SMTotalSize):void 0,a.blockDownloadsExperienceEnabled&&(b.type===p.t.Media||b.openUrl&&b.appMap)?b.itemStatus=r.t.ConditionalAccessViewOnly:a.blockDownloadsExperienceEnabled?b.itemStatus=r.t.ConditionalAccessBlocked:a.viewOnlyExperienceEnabled&&(b.itemStatus=r.t.ConditionalAccessViewOnly),b.type===p.t.Folder){b.folder={},b.childCount=Number(e.ItemChildCount)+Number(e.FolderChildCount);var D=Number(e.SMTotalFileCount);b.folder.totalCount=D>0?D:b.childCount,b.folder.childCount=b.childCount}for(var I in b.isDraggable=!0,b.isDropEnabled=b.type===p.t.Folder,b.properties={},e)e.hasOwnProperty(I)&&(b.properties[I]=e[I]);var x=e.UniqueId&&l.e.normalizeLower(e.UniqueId);x&&(b.properties.uniqueId=x);var C=b.name;return b.extension&&(C=b.name.substring(0,b.name.toLowerCase().lastIndexOf(b.extension.toLowerCase()))),b.properties.FileName=C,Number(e.PrincipalCount)>0?b.sharingType=m.e.Shared:void 0===e.PrincipalCount?b.sharingType=m.e.Unknown:b.sharingType=m.e.Private,Object(s.n)(e,t,n),b}}e.buildItems=function(e,n,a,i,r){for(var o=[],s=[],c=e.Row,d=c.length,l=0;l<d;l++){var u=t(c[l],s,n,a);u.parent=i,u.parentKey=i.key,r&&r.setItem(u.key,u),o.push(u)}var f=0;if(s.length>0){var p=s[s.length-1];f=p.startIndex+p.count}else s=void 0,f=d>0?e.LastRow:0;return{items:o,groups:s,totalCount:f}},e.buildRootItem=function(e,t,n,a){var i=function(e){var t=e;return 0===e.indexOf("id")&&(t=Object(_.e)(e).id),t}(e),r=Object(h.e)(i,n.listUrl),o={key:r},s=t.ListTitle,d=t.AllowCreateFolder,l=t.EnableMinorVersions,u=t.verEnabled,f=t.AllowGridMode,m=t.DisableGridEditing,v=t.ListTemplateType,y=t.BasePermissions,S=void 0===y?{}:y,D=S.ManageLists,I=void 0===D?void 0:D,x=S.ManagePersonalViews,C=void 0===x?void 0:x,O=S.OpenItems,w=void 0===O?void 0:O,E=t.ListSchema,A=(void 0===E?{}:E).DefaultItemOpen,L=void 0===A?void 0:A,k=t.ExcludeFromOfflineClient,M=t.WebExcludeFromOfflineClient,P=t.ListData,T="string"==typeof L?"0"===L:void 0;if(a){var U=a.getItem(r);U&&(o=U)}return o.type=p.t.Folder,o.isRootFolder=i===n.listUrl,Object(b.default)(o,{permissions:b.optional(P?c.e(P.FolderPermissions):void 0)}),void 0===o.list&&(o.list={}),Object(b.default)(o.list,{id:b.optional(t.listName),title:b.optional(s),allowGridMode:"boolean"==typeof f?f:b.backup(!0),allowCreateFolder:b.optional(d),disableCommenting:"boolean"==typeof t.DisableCommenting&&t.DisableCommenting,disableGridEditing:"boolean"==typeof m?m:b.backup(!1),enableMinorVersions:b.optional(l),enableVersions:b.optional(u),templateType:b.optional("string"==typeof v?Number(v):void 0),isDocumentLibrary:b.optional("string"==typeof v?Object(g.i)(v):void 0),isPromotedLinks:b.optional("string"==typeof v?Object(g.s)(v):void 0),isForceCheckout:b.optional(t.isForceCheckout),isModerated:b.optional(t.isModerated),enableRequestSignOff:b.optional(t.EnableRequestSignOff),newWOPIDocumentEnabled:b.optional(t.NewWOPIDocumentEnabled),newWOPIDocumentTypes:b.optional(t.NewWOPIDocumentTypes),permissions:{manageLists:b.optional(I),managePersonalViews:b.optional(C),openItems:b.optional(w)},openInClient:b.optional(T),excludeFromOfflineClient:b.optional("boolean"==typeof k||"boolean"==typeof M?k||M:void 0),contentTypesEnabled:b.optional(t.ContentTypesEnabled),metadataNavFeatureEnabled:b.optional(t.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:b.optional(t.canUserCreateMicrosoftForm),itemCount:b.optional(t.ListSchema&&t.ListSchema.ItemCount),rowLimit:b.optional(P&&P.RowLimit)}),o.isRootFolder&&(o.name=o.displayName=s),a&&a.setItem(r,o),o},e.buildItem=t}(a||(a={}))},2825:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(0),i=n(1429),r=n(86),o=n(52),s=n(220),c=n(665),d=n(154),l=n(2631),u=n(1860),f=n(8).t.isActivated("29873e89-d94c-4bb0-8f5b-dfd437f6422c","6/19/2021","Look for filters within the folder structure for doclib by using GetListUsingPath API"),p=function(e){function t(t){var n=e.call(this,{},{pageContext:t.pageContext})||this;return n._listContext=t.listContext,n._itemUrlHelper=t.itemUrlHelper||new s.e({},{pageContext:t.pageContext}),n._apiUrlHelper=t.apiUrlHelper||new c.e({},{pageContext:t.pageContext,itemUrlHelper:n._itemUrlHelper}),n._folderPath=t.folderPath,void 0===n._folderPath&&(n._folderPath=Object(l.t)(t.parentKey,n._listContext)),n}return Object(a.__extends)(t,e),t.prototype.getFilterData=function(e,t,n,a){var i=this;return this.getData(function(){return i._getFilterDataUrl(e,t,n,a)},function(e){return e},"GetFilterData")},t.prototype._getFilterDataUrl=function(e,t,n,a){var i,s,c=this._itemUrlHelper.getUrlParts({path:this._listContext.listUrl,listUrl:this._listContext.listUrl});s=f?this._apiUrlHelper.build().webByItemUrl(c).method("GetList",c.serverRelativeListUrl).segment("RenderListFilterData").parameter("FieldInternalName",e):this._apiUrlHelper.build().webByItemUrl(c).methodWithAliases("GetListUsingPath",{DecodedUrl:c.serverRelativeListUrl}).segment("RenderListFilterData").parameter("FieldInternalName",e),n&&n!==u.e&&(s=s.parameter("ViewId",n)),this._folderPath&&(s=s.parameter("RootFolder",{raw:r.e.encodeURIComponent(this._folderPath)})),a&&a===o.e.Taxonomy&&(s=s.parameter("ExcludeFieldFilteringHtml",!0));var l=Object(d.getFilterParams)(t,!0,{replaceMeFormatFilterWithCurrentUser:!0,currentUserDisplayName:null===(i=this._pageContext)||void 0===i?void 0:i.userDisplayName});return(s=s.rawParameter(l)).toString()},t}(i.t)},2826:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(){}return e.newItemCreated="clientFormNewItemCreated",e.itemUpdated="clientFormItemUpdated",e}()},2841:function(e,t,n){"use strict";var a=n(0),i=n(116),r=n(1386),o=n(1429),s=n(2622),c=n(2807),d=function(e){function t(t,n){var a=e.call(this,{},n)||this,i=t.apiUrlHelper,r=t.itemUrlHelper;return a._apiUrlHelper=i,a._itemUrlHelper=r,a}return Object(a.__extends)(t,e),t.prototype.isAdvancedRecordVersioningDisabled=function(){return this.dataRequestor.getData({url:this._buildRecordVersioningUrl(),qosName:"GetAdvancedRecordVersioningDisabled",method:"GET"}).then(function(e){return!!(e&&e.d&&e.d.GetAdvancedRecordVersioningDisabled)&&e.d.GetAdvancedRecordVersioningDisabled},function(e){return i.n.wrapError(e)})},t.prototype.getAvailableTagsForSite=function(){var e=this;return this.dataRequestor.getData({url:this._buildComplianceTagsListUrl(),qosName:"GetAvailableTagsForSite",method:"GET",noRedirect:!0}).then(function(t){return e._transformToComplianceTags(t.d.GetAvailableTagsForSite.results)},function(e){return i.n.wrapError(c.GetAvailableTagsForSiteFailed)})},t.prototype.updateComplianceTagInBatch=function(e,t,n){if(!e||0===e.length)return r.e.logData({name:"ComplianceTagDataSource.EmptyItemIds",message:"Empty item IDs selected for list: "+n}),i.n.wrap([]);var a=JSON.stringify({itemIds:e,listUrl:n,complianceTagValue:t.tagValue,blockDelete:t.blockDelete,blockEdit:t.blockEdit});return this.dataRequestor.getData({url:this._buildApplyLabelOnBulkItemsUrl(),qosName:"ApplyLabelOnBulkItems",additionalPostData:a,method:"POST"}).then(function(e){return e&&e.d&&e.d.ApplyLabelOnBulkItems&&e.d.ApplyLabelOnBulkItems.results?e.d.ApplyLabelOnBulkItems.results:[]},function(e){return i.n.wrapError(e)})},t.prototype.updateComplianceTag=function(e,t){var n="SetComplianceTag",a=t.blockEdit||t.blockDelete,r=t.blockEdit,o=t.isEventTag,s=JSON.stringify({complianceTag:t.tagValue,isTagPolicyHold:a,isTagPolicyRecord:r,isEventBasedTag:o,isTagSuperLock:t.superLock,isUnlockedAsDefault:t.unlockedAsDefault});return this.dataRequestor.getData({url:this._buildUpdateHashtagsUrl(e,n),qosName:n,additionalPostData:s,method:"POST",noRedirect:!0}).then(function(){return t.tagName},function(e){return i.n.wrapError(e)})},t.prototype.unlockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildUnlockRecordUrl(),qosName:"UnlockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.UnlockRecordItem&&e.d.UnlockRecordItem.results){var t=e.d.UnlockRecordItem.results;return s.s(t)}return!1},function(e){return i.n.wrapError(e)})},t.prototype.lockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildLockRecordUrl(),qosName:"LockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.LockRecordItem&&e.d.LockRecordItem.results){var t=e.d.LockRecordItem.results;return s.s(t)}return!1},function(e){return i.n.wrapError(e)})},t.prototype._buildRecordVersioningUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAdvancedRecordVersioningDisabled",{}).toString()},t.prototype._buildComplianceTagsListUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAvailableTagsForSite",{siteUrl:this._pageContext.webAbsoluteUrl}).toString()},t.prototype._buildUpdateHashtagsUrl=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(n).method("GetList",n.serverRelativeListUrl).method("items",e.properties.ID).method(t).toString()},t.prototype._transformToComplianceTags=function(e){var t=[],n={tagName:c.NoneComplianceTagName,tagValue:"",blockDelete:!1,blockEdit:!1,tagDescription:c.NoneComplianceTagDescription,tagTooltip:c.NoneComplianceTagDescription,hasRetentionAction:!1,autoDelete:!1,isEventTag:!1,reviewerEmail:"",notes:"",displayName:"",superLock:!1,tagId:"",unlockedAsDefault:!1};t.push(n);for(var a=0,i=e;a<i.length;a++){var r=i[a],o=s.a(r),d=s.i(r),l={tagName:r.TagName,tagValue:r.TagName,blockDelete:r.BlockDelete,blockEdit:!!r.BlockEdit,tagDescription:o,tagTooltip:d,hasRetentionAction:r.HasRetentionAction,autoDelete:r.AutoDelete,isEventTag:r.IsEventTag,reviewerEmail:r.ReviewerEmail,notes:r.Notes,displayName:r.DisplayName,superLock:r.SuperLock,tagId:r.TagId,unlockedAsDefault:r.UnlockedAsDefault};t.push(l)}return t},t.prototype._buildApplyLabelOnBulkItemsUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.ApplyLabelOnBulkItems").toString()},t.prototype._buildUnlockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.UnlockRecordItem").toString()},t.prototype._buildLockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.LockRecordItem").toString()},t}(o.e),l=n(665),u=n(220),f=function(){function e(e){var t=new u.e({},{pageContext:e.pageContext}),n=new l.e({},{itemUrlHelper:t,pageContext:e.pageContext}),a={pageContext:e.pageContext};this._dataSource=new d({apiUrlHelper:n,itemUrlHelper:t},a)}return e.prototype.isAdvancedRecordVersioningDisabled=function(){return this._dataSource.isAdvancedRecordVersioningDisabled()},e.prototype.getAvailableTagsForSite=function(){return this._cachedTagsPromise||(this._cachedTagsPromise=this._dataSource.getAvailableTagsForSite()),this._cachedTagsPromise},e.prototype.updateComplianceTag=function(e,t){return this._dataSource.updateComplianceTag(e,t)},e.prototype.updateComplianceTagInBatch=function(e,t,n){return this._dataSource.updateComplianceTagInBatch(e,t,n)},e.prototype.unlockRecord=function(e,t){return this._dataSource.unlockRecord(e,t)},e.prototype.lockRecord=function(e,t){return this._dataSource.lockRecord(e,t)},e.prototype.hasComplianceTags=function(){return this.getAvailableTagsForSite().then(function(e){return!!(e&&e.length>1)})},e}();t.e=f},2988:function(e,t,n){"use strict";n.d(t,"t",function(){return s}),n.d(t,"e",function(){return c});var a=n(9),i=n(51),r=n(2817),o={listContext:i.s,pageContext:i.p},s=new a.t({name:"ClientFormProviderV2",factory:{dependencies:o,create:function(e){var t=e.listContext,n=e.pageContext,a=new r.e({listContext:c(t),pageContext:n});return{instance:a,disposable:a}}}});function c(e){return{listUrl:e.listUrl,listId:e.listId,urlParts:e.urlParts,listTitle:e.listTitle,listTemplateType:e.listTemplateType,isDocLib:e.isDocLib,folderPath:e.folderPath,enableAttachments:!!e.enableAttachments,leftNavigationData:e.leftNavigationData,refreshClientForm:e.refreshClientForm,contentTypesEnabled:e.contentTypesEnabled,tenantTagPolicyEnabled:e.tenantTagPolicyEnabled,allowCreateFolder:e.allowCreateFolder,flags2:e.flags2}}},4151:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return h});var a=n(125),i=n(0),r=n(116),o=n(229),s=n(41),c=n(199),d=n(2448),l=n(8),u=n(2498),f=n(2988),p=n(2584),m=function(e){function t(t,n){var a=e.call(this,n.pageContext)||this;return a._pageContext=n.pageContext,a}return Object(i.__extends)(t,e),t.prototype.getClientForm=function(e){var t=e.resources,n=e.item,a=e.isBulkEdit,i=e.forceToFetch,r=this._getClientFormParmsV2(n,a),o=new s.e({name:"TMR.getClientForm"});return t.consume(f.t).getClientForm(r,i,!0).then(function(e){return e},function(e){throw o.end(Object(c.e)(e)),e})},t.prototype.setItemExpirationDate=function(e,t){var n,a=Object(o.o)(this._pageContext),i=encodeURI(null===(n=null==e?void 0:e.id)||void 0===n?void 0:n.replace(/'/g,"%27")),r=a+"/_api/web/GetFileByServerRelativeUrl('".concat(i,"')/SetExpirationDate"),s={},c=null;return t&&(c=t.toISOString()),s.expirationDate=c,this.dataRequestor.getData({url:r,parseResponse:function(e){},qosName:"TMR.setItemExpirationDate",additionalPostData:JSON.stringify(s),method:"POST",noRedirect:!0})},t.prototype.clearStoreClientForm=function(e){return r.n.resolve(e.consumeAsync(f.t)).then(function(e){return e.clearStoreClientForm()})},t.prototype.getItemExpirationDate=function(e){var t,n=Object(o.o)(this._pageContext),a=!l.e.isActivated("F60F8874-E998-4128-94B1-00F6CBD5713B","02/14/2023","Replace single quote with %27 to fix the invalid query exception."),i=null==e?void 0:e.id;a&&(i=encodeURI(null===(t=null==e?void 0:e.id)||void 0===t?void 0:t.replace(/'/g,"%27")));var r=n+"/_api/web/GetFileByServerRelativeUrl('".concat(i,"')/ExpirationDate");return this.dataRequestor.getData({url:r,parseResponse:function(e){var t,n=JSON.parse(e);return!!(null===(t=null==n?void 0:n.d)||void 0===t?void 0:t.ExpirationDate)},qosName:"TMR.getItemExpirationDate",method:"GET",noRedirect:!0})},t.prototype._getClientFormParmsV2=function(e,t){var n=e.peek(),a=Object(p.n)(n),i=n.properties||{};return{clientFormType:d.e.editItem,item:a,itemId:i.ID,contentType:i.ContentType,contentTypeId:i.ContentTypeId,isBulkEdit:t,selection:[a]}},t}(u.e),_=n(51),h=Object(a.r)("ExpirationStore",m,{pageContext:_.p})}}]);