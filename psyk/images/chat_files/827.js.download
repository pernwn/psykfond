(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[827],{2097:function(e,t,n){"use strict";n.r(t),n.d(t,"EngagementHelper",function(){return s}),n.d(t,"mergeEngagementData",function(){return c}),n.d(t,"EngagementPartType",function(){return i.a}),n.d(t,"EngagementPart",function(){return i.n}),n.d(t,"EngagementBuilder",function(){return i.t}),n.d(t,"ENGAGEMENT_ROOT",function(){return i.e}),n.d(t,"clickEngagementPart",function(){return l.e}),n.d(t,"keyPressEngagementPart",function(){return l.n}),n.d(t,"dropEngagementPart",function(){return l.t}),n.d(t,"getMostSpecificMatchingContext",function(){return u});var a=n(0),i=n(678),r=n(112),o=n(204),s=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.handlers,o=void 0===i?[]:i,s=n.logData,c=void 0===s?function(e){return r.e.logData(e)}:s;return a._handlers=o,a._logData=c,a}return Object(a.__extends)(t,e),t.prototype.logData=function(e){if(void 0===e&&(e={}),this.contexts.length||e.name){for(var t=this.contexts.map(function(e,t){return{context:e,order:t}}).sort(function(e,t){return e.context.part.type-t.context.part.type||e.order-t.order}).map(function(e){return e.context}),n=e.name,i=void 0===n?t.map(function(e){return e.part.name}).join("."):n,r=e.isIntentional,o=void 0!==r&&r,s=e.extraData,d=void 0===s?{}:s,l=Object(a.__rest)(d,[]),u=Object(a.__rest)(e,["name","isIntentional","extraData"]),f=Object(a.__assign)({name:i,isIntentional:o,extraData:l},u),p=0,m=t;p<m.length;p++){var _=m[p],h=_.part,b=_.extraData,g=void 0===b?{}:b,v={};for(var y in g)v["".concat(h.name,"_").concat(y)]=g[y];c(f,{extraData:v}),c(f,_.part.getEngagementData(_)||{})}for(var S=0,D=this._handlers;S<D.length;S++){var I=D[S],x=I.getEngagementData.apply(I,t);x&&c(f,x)}this._logData(f)}},t.prototype.clone=function(e){return new t({},{engagementSource:{contexts:e},handlers:this._handlers,logData:this._logData})},t}(i.t);function c(e,t){var n=t.extraData,i=void 0===n?{}:n,r=t.experiment;d(e,Object(a.__rest)(t,["extraData","experiment"])),Object(o.e)(e.extraData,i),void 0!==r&&(e.experiment=r)}function d(e,t){for(var n in t){var a=t[n];if("object"==typeof a&&a){var i="object"==typeof e[n]&&e[n]||{};e[n]=i,d(i,a)}else void 0!==a&&(e[n]=a)}}var l=n(3167);function u(e,t){for(var n=t.length-1;n>=0;n--){var a=t[n];if(e.matches(a))return a}}},2290:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(2291),i=n(125),r=function(){function e(e,t){this._itemsStore=t.itemsStore}return e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),a=n&&(n.parentKey||n.UNSAFE_parent&&n.UNSAFE_parent.key);return a?this._itemsStore.getItem(a):void 0}},e.prototype.getFacetedAncestorOrSelf=function(e,t,n){return void 0===n&&(n=""),this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})},e.prototype.getAncestorOrSelf=function(e,t){for(var n,a=e&&e.key;a;){var i=this._itemsStore.getItem(a),r=i&&i.peek();if(!r)break;if(t(r)){n=i;break}a=r&&(r.parentKey||r.UNSAFE_parent&&r.UNSAFE_parent.key)}return n},e.dependencies={itemsStore:a.t},e}(),o=Object(i.r)("ItemParentHelper",r)},2291:function(e,t,n){"use strict";n.d(t,"t",function(){return I});var a=n(0),i=n(2312),r=n(171),o=n(1426),s=n(9),c=n(125),d=n(662),l=n(1428),u=n(314),f=n(2460),p=n(1430),m=n(35),_=Object(m.isFeatureEnabled)(m.ReadOnlyItemsStore),h="token=",b="result=",g="item_write=",v="item=";function y(e){return e&&e.item&&e.item.peek().key}function S(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null,n.items=[],t.valueHasMutated()}var D=function(e){function t(){var t=e.call(this,"ItemsStore")||this;return t._itemSetsKeys={},t._observables=new o.e({owner:t}),t._vaultItemsToPurge=[],window.odstore=t,t}return Object(a.__extends)(t,e),t.prototype.dispose=function(){this._observables.dispose()},t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(a.__spreadArray)([e],t,!1))},t.prototype.getItem=function(e){return this.getValue(v+e)},t.prototype.setItemSet=function(e,t){var n=b+e;this.setValue(n,t),this._itemSetsKeys[n]=1},t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var a=(t=this.getValue(n)).content&&t.content.peek(),i=a&&a.items;if(i)for(var r=0,o=i;r<o.length;r++){var s=o[r];if(s&&s.peek().parentKey===e)return t}}},t.prototype.getItemSet=function(e){return this.getValue(b+e)},t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice(b.length));return e},t.prototype.setNextRequestToken=function(e,t,n){var a=h+t;n?this.setValue(a,n):this.remove(a)},t.prototype.getNextRequestToken=function(e){return this.getValue(h+e)},t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,a=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),a)},t.prototype.invalidateItemSet=function(e){var t=this.getValue(b+e);t&&S(t)},t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&S(t)},t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a),r=i&&i.locationFilter;r&&r.indexOf(e)>=0&&(t.isExpired=!0)}}},t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a);i&&i.tagFilter===e&&(t.isExpired=!0)}}},t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();n&&n.key&&n.key.indexOf("allmyphotos")>=0&&(e.isExpired=!0,this._invalidateItem(n))}},t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(a.__spreadArray)([],this._vaultItemsToPurge,!0);e<t.length;e++){var n=t[e],r=void 0;n.vault&&n.vault.root&&((r=new i.e(n.key)).name=n.name,r.displayName=n.displayName,r.dateModified=" ",r.folder={},r.vault={isLocked:!0,root:{}}),this._purgeItem(n,r)}this._vaultItemsToPurge=[]},t.prototype._handleItemInvalidation=function(e,t,n){var a=this;if(t){var i=t.peek(),r=!1,o=[];if(i)switch(o.push(i),i.type){case u.e.Folder:case u.e.Media:r=!0}for(var s in this._itemSetsKeys){var c=this.getValue(s),d=c.item&&c.item.peek(),l=d&&d.key;l&&(l===e||r&&l.indexOf("allmyphotos")>-1)&&(l===e?this.setNextRequestToken(e,c.key,""):o.push(d),c.isExpired=!0)}o.forEach(n?function(e){return a._purgeItem(e)}:function(e){return a._invalidateItem(e)})}},t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)},t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e),Object(p.default)(t,{revision:e.revision+1}),this.setItem(t)},t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];_&&!Object.isFrozen(e)&&Object.freeze(e),e.vault&&this._vaultItemsToPurge.push(e);for(var r=function(t){var n="".concat(v).concat(t),a=_?"".concat(g).concat(t):n,r=o.getValue(n),s=o.getValue(a);s?s(e):((s=o._observables.create(e)).equalityComparer=l.n,o.setValue(a,s),r=_?o._observables.pureCompute(function(){return s()}):s,o.setValue(n,r)),i.push(r)},o=this,s=0,c=Object(f.e)(Object(a.__spreadArray)([e.key],t,!0));s<c.length;s++){var d=c[s];r(d)}return i[0]},t}(r.e),I=new s.t({name:"ItemsStore",factory:new c.i(D)});t.e=D},2312:function(e,t,n){"use strict";var a=n(36);t.e=function(e){void 0===e&&(e=""),this.isDropEnabled=!1,this.permissions={High:0,Low:0},this.key=e,this.revision=0,this.queryType=a.e.Files,this.displayType=a.e.Files,this.isPlaceholder=!0,this.properties={},this.recycleBinProperties={},this.reputationProperties={},this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0},this.urls={},this.state={upload:{status:5},removing:!1}}},2426:function(e,t,n){"use strict";var a;!function(e){e[e.Public=0]="Public",e[e.PublicUnlisted=2]="PublicUnlisted",e[e.Shared=3]="Shared",e[e.Private=4]="Private",e[e.Unknown=5]="Unknown"}(a||(a={})),t.e=a},2460:function(e,t,n){"use strict";function a(e){var t;t={};for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o="".concat(r);t[o]||(t[o]=!0,n.push(r))}return n}n.d(t,"e",function(){return a})},3167:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o});var a=n(678),i=new a.n("Click",a.a.event),r=new a.n("KeyPress",a.a.event),o=new a.n("Drop",a.a.event)},3572:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(9).t)({name:"".concat("IsOneUpResourceKey",".isOneUp"),factory:{dependencies:{},create:function(e){return{instance:{isOneUp:!1}}}}})},4212:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(1635),i=n(125),r=n(51),o=Object(i.r)("PageContextEngagementHandler",a.e,{pageContext:r.p})},5498:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return L});var a=n(9),i=n(4212),r=n(446),o=n(125),s=n(688),c=function(){function e(e,t){this._instrumentationProvider=t.instrumentationProvider,this._darkModeHelper=t.darkModeHelper}return e.prototype.getEngagementData=function(){var e,t=this._instrumentationProvider,n=null===(e=this._darkModeHelper)||void 0===e?void 0:e.isODBDarkMode;return{currentPage:t.currentPageName()||"NA",previousPage:t.previousPageName()||"NA",extraData:{isDarkMode:void 0!==n?n:"NA"}}},e.dependencies={instrumentationProvider:r.o,darkModeHelper:s.e},e}(),d=Object(o.r)("PageEngagementHandler",c),l=n(909),u=function(){function e(e,t){this._searchSession=t.searchSession}return e.prototype.getEngagementData=function(){return{extraData:{olsSearchSessionId:this._searchSession}}},e.dependencies={searchSession:l.e},e}(),f=Object(o.r)("SearchEngagementHandler",u),p=n(2097),m=n(355),_=n(1439),h=n(515),b=n(1426),g=n(1483),v=!n(8).e.isActivated("D76F6EE1-ABD2-4CE0-9CEB-87FFB7715239","08/25/2022","Perform extra sanitization prior to logging extension"),y=function(){function e(e,t){this._currentItem=t.currentItem}return e.prototype.getEngagementData=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var a=this._currentItem,i=Object(p.getMostSpecificMatchingContext)(_.e,t),r=null!==(e=Object(b.a)(null==i?void 0:i.item))&&void 0!==e?e:Object(b.a)(a);if(r){var o=r.list,s=v?Object(g.e)(r.extension):r.extension,c={extension:s,createdFromExcel:o&&o.createdFromExcel,createdFromExisting:o&&o.createdFromExisting},d=r.graph&&r.graph.itemId||r.itemId;d&&(c.itemGraphId=d);var l=r.graph&&r.graph.driveId;l&&(c.itemGraphDriveId=l);var u=r.tsTraceId;u&&(c.tsTraceId=u);var f,m=r.queryType;return m&&(c.queryType=m),Object(h.e)(r.queryType)&&(f=r.searchProperties.isMetadataSearch?"MetadataSearch":"DoclibSearch"),{scenario:f,extraData:c}}},e.dependencies={currentItem:m.r.optional},e}(),S=Object(o.r)("ItemEngagementHandler",y),D=n(2290),I=n(51),x=n(204),C=n(2426),O=n(3572),w=function(){function e(e,t){this._currentItem=t.currentItem,this._itemParentHelper=t.itemParentHelper,this._pageContext=t.pageContext,this._resources=t.resources,this._focusItem=t.focusItem}return e.prototype.getEngagementData=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var a=this._currentItem,i=Object(p.getMostSpecificMatchingContext)(_.e,t),r=null!==(e=Object(b.a)(null==i?void 0:i.item))&&void 0!==e?e:Object(b.a)(a);if(r){var o=this._itemParentHelper,s=o.getFacetedAncestorOrSelf(r,"list"),c=s&&s.peek(),d=o.getFacetedAncestorOrSelf(r,"subsite"),l=d&&d.peek(),u={docId:r.properties.uniqueId};if(c){var f=c.list,m=f.id,h=f.templateType;u.listId=m,u.listTemplateId="".concat(h)}if(l&&l.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl){var g=l.subsite,v=(m=g.id,g.siteCollectionId),y=g.webTemplateId;u.webId=m,u.webTemplateId="".concat(y),u.siteId=v}var S=this._pageContext.userDisplayName,D=this._pageContext.userLoginName,I=D&&-1!==D.lastIndexOf("@")?D.substring(0,D.lastIndexOf("@")):void 0;u.extraData||(u.extraData={});var w=void 0;if(r&&r.sharingType){var E=r&&r.sharingType;w=E===C.e.Shared||E===C.e.Public||E===C.e.PublicUnlisted}var A=this._resources.consume(O.e.optional).isOneUp;return x.e(u.extraData,{isInODB:r.itemFromServer&&r.itemFromServer.SiteTitle&&S?-1!==r.itemFromServer.SiteTitle.indexOf(S):void 0,isInODBv2:r.openUrl&&I?-1!==r.openUrl.toLowerCase().indexOf(I.toLowerCase()):void 0,isItemShared:w,isOneUp:A||this._focusItem&&!!Object(b.a)(this._focusItem)}),u}},e.dependencies={currentItem:m.r.optional,itemParentHelper:D.e,pageContext:I.p,resources:a.r,focusItem:m.m.optional},e}(),E=Object(o.r)("ItemEngagementHandler",w),A={pageContext:i.e.optional,page:d.optional,search:f.optional,item:S.optional,sharePointItem:E.optional},L=new a.t({name:"LegacyKnockoutEngagementHandlers",factory:{dependencies:A,create:function(e){var t=[],n=e.pageContext,a=e.page,i=e.search,r=e.item,o=e.sharePointItem;return n&&t.push(n),a&&t.push(a),i&&t.push(i),r&&t.push(r),o&&t.push(o),{instance:t}}}})}}]);